---
title: "Figure 4"
author: "Brendan Haile"
date: '2025-03-27'
output:
  pdf_document: default
---

```{r Packages}
library(deSolve)
library(tidyverse)
library(cowplot)
library(ggplot2)
library(AICcmodavg)
```

```{r Function - Logistic Growth}
#Recreating the macroparasite function but with logistic growth

# list of parameters for quick reference
# b = per capita host birth rate
# d = per capita host mortality
# alpha = additional per capita host mortality due to parasite burden (P/H)*H
# beta = transmission (ingestion) rate of parasites by host
# lambda = external parasite production rate (per parasite)
# gamma = per capita loss rate of entl parasite stages
# mu = parasite mortality within hosts
# k = overdispersion parameter; measures parasite Dispersion (low k = highly aggregated in few hosts, high k = equally distributed among hosts)

macroParasiteLogistic <- function(t, x, parameters){
  H <- x[1]
  P <- x[2]
  with(                                   
       as.list(params),                   
       {                                  
         dH <- (b-d)*H*(1-(H/KcarryCap))-(alpha*P)
         dP <- (beta*H*lambda*P)/(gamma+beta*H) - P*(d+mu+alpha) - (P*P*alpha*(k+1))/(k*H)
         dXlist <- c(dH,dP)                
         list(dXlist)                         
       }
       )
}
```

```{r - DETER + Berding MONTHLY - Starting Information - xstart, seasons, time, and resource}
#Setting resource availability
foragingResource <- seq(1, 3, by=0.0125) #original step size = 0.1
resource <- seq(min(foragingResource), 5, by=0.0125) #original step size = 0.1

xstart <- c(H=69, P=1)
monthsBreeding <- (12*5) #One year is 12 months
time <- seq(1,monthsBreeding,by=1)

#Parameter Values 
b0 <- 0.5980              #monthly rate = 0.5980 
d0 <- 1/5                 #monthly rate = 1/5
alpha0 <- 7.94*10^(-3)    #monthly rate = 7.94*10^(-3) calculated from avg_daily_rate*365/12 [FROM BERDING]
beta0 <- 5.2*10^(-8)      #monthly rate = 5.2*10^(-8)
KcarryCap0 <- 70          #value = 70 per Hectare (100x100m grid)
lambda0 <- 90000          #monthly rate = 90000
gamma0 <- 1/3             #monthly rate = 1/3
mu0 <- 0.375              #monthly rate = 0.375
k0 <- 1                   #value = 1

#Varying the parameters
br = b0*resource
dr = d0/resource
alphar = alpha0/resource
KcarryCapr = KcarryCap0*resource
lambdar = lambda0*resource
gammar = gamma0 #not effected
murPositive = mu0*resource
murNegative = mu0/resource

betarPositive = beta0*foragingResource
betarNegative = beta0/foragingResource
betarNull = beta0+(foragingResource*0)
krPositive = k0*foragingResource
krNegative = k0/foragingResource
krNull = k0+(foragingResource*0)
```

```{r Model -  DETER + Berding MONTHLY - Logistic Growth - Finding resource breakpoints for when each NON-FORAGING parameter undoes the effects of FORAGING parameters on Hosts/Parasites per Host BUT we are varying BOTH resource effects}
#b, d, beta, lambda, mu, gamma, KcarryCap and k from Deter 2008
#Alpha from Berding 1987

#Creating empty vectors
equilibriumH_Baseline <- c()
equilibriumP_Baseline <- c()
tmpBaseline <- c()

#Creating Breakpoint Vectors
hostResourceBreakPointForB <- c()
pphResourceBreakPointForB <- c()
hostResourceBreakPointForD <- c()
pphResourceBreakPointForD <- c()
hostResourceBreakPointForKcarryCap <- c()
pphResourceBreakPointForKcarryCap <- c()
hostResourceBreakPointForAlpha <- c()           #Alpha (virulence) is incapable of overcoming resource effect
pphResourceBreakPointForAlpha <- c()
hostResourceBreakPointForMuPositive <- c()
pphResourceBreakPointForMuPositive <- c()
hostResourceBreakPointForLambda <- c()
pphResourceBreakPointForLambda <- c()
hostResourceBreakPointForMuNegative <- c()
pphResourceBreakPointForMuNegative <- c()

#Creating ForagingResource Vectors (mostly just for organization)
hostForagingResourceForB <- c()
pphForagingResourceForB <- c()
hostForagingResourceForD <- c()
pphForagingResourceForD <- c()
hostForagingResourceForKcarryCap <- c()
pphForagingResourceForKcarryCap <- c()
hostForagingResourceForAlpha <- c()
pphForagingResourceForAlpha <- c()
hostForagingResourceForMuPositive <- c()
pphForagingResourceForMuPositive <- c()
hostForagingResourceForLambda <- c()
pphForagingResourceForLambda <- c()
hostForagingResourceForMuNegative <- c()
pphForagingResourceForMuNegative <- c()

#Baseline Scenario for Comparisons
b=b0
d=d0
alpha=alpha0
beta=beta0
lambda=lambda0
gamma=gamma0
mu=mu0
k=k0
KcarryCap = KcarryCap0
#Creating parameters & running model
params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
tmpBaseline <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
equilibriumH_Baseline[length(equilibriumH_Baseline)+1] <- tmpBaseline$H[length(tmpBaseline$H)]
equilibriumP_Baseline[length(equilibriumP_Baseline)+1] <- tmpBaseline$P[length(tmpBaseline$P)]


for (j in 1:length(foragingResource)){
  #Creating empty vectors (must be reset each time we select a new foragingResource level)
  equilibriumH_PositiveB <- c()
  equilibriumP_PositiveB <- c()
  tmpPositiveB <- c()
  equilibriumNonForagingResource_PositiveB <- c()
  equilibriumForagingResource_PositiveB <- c()
  equilibriumH_NegativeB <- c()
  equilibriumP_NegativeB <- c()
  tmpNegativeB <- c()
  equilibriumNonForagingResource_NegativeB <- c()
  equilibriumForagingResource_NegativeB <- c()
  
  equilibriumH_NegativeD <- c()
  equilibriumP_NegativeD <- c()
  tmpNegativeD <- c()
  equilibriumNonForagingResource_NegativeD <- c()
  equilibriumForagingResource_NegativeD <- c()
  
  equilibriumH_PositiveKcarryCap <- c()
  equilibriumP_PositiveKcarryCap <- c()
  tmpPositiveKcarryCap <- c()
  equilibriumNonForagingResource_PositiveKcarryCap <- c()
  equilibriumForagingResource_PositiveKcarryCap <- c()
  equilibriumH_NegativeKcarryCap <- c()
  equilibriumP_NegativeKcarryCap <- c()
  tmpNegativeKcarryCap <- c()
  equilibriumNonForagingResource_NegativeKcarryCap <- c()
  equilibriumForagingResource_NegativeKcarryCap <- c()
  
  equilibriumH_NegativeAlpha <- c()
  equilibriumP_NegativeAlpha <- c()
  tmpNegativeAlpha <- c()
  equilibriumNonForagingResource_NegativeAlpha <- c()
  equilibriumForagingResource_NegativeAlpha <- c()
  
  equilibriumH_PositiveMuPositive <- c()
  equilibriumP_PositiveMuPositive <- c()
  tmpPositiveMuPositive <- c()
  equilibriumNonForagingResource_PositiveMuPositive <- c()
  equilibriumForagingResource_PositiveMuPositive <- c()
  
  equilibriumH_NegativeLambda <- c()
  equilibriumP_NegativeLambda <- c()
  tmpNegativeLambda <- c()
  equilibriumNonForagingResource_NegativeLambda <- c()
  equilibriumForagingResource_NegativeLambda <- c()
  
  equilibriumH_NegativeMuNegative <- c()
  equilibriumP_NegativeMuNegative <- c()
  tmpNegativeMuNegative <- c()
  equilibriumNonForagingResource_NegativeMuNegative <- c()
  equilibriumForagingResource_NegativeMuNegative <- c()
  
  #Creating "finder" variables (must be reset each time we select a new foragingResource level)
  hostFirstB <- TRUE
  pphFirstB <- TRUE
  hostFirstD <- TRUE
  pphFirstD <- TRUE
  hostFirstKcarryCap <- TRUE
  pphFirstKcarryCap <- TRUE
  hostFirstAlpha <- TRUE
  pphFirstAlpha <- TRUE
  hostFirstMuPositive <- TRUE
  pphFirstMuPositive <- TRUE
  hostFirstLambda <- TRUE
  pphFirstLambda <- TRUE
  hostFirstMuNegative <- TRUE
  pphFirstMuNegative <- TRUE

  
  for (i in 1:length(resource)){ #This will go through the loop for the length of the resource variable
    xstart <- c(H=69, P=1) #Resets the initial parameter values

#[NOTE: This only works when the DIRECTIONALITY of FORAGING and NON-FORAGING PARAMETERS are OPPOSITE]
#Allowing resources to effect non-foraging paramaters (b, d, and KcarryCap) improves the host population [Look at the % Change Effect of baseline]
#Therefore we must select the Resource Effect on Foraging parameters that has the OPPOSITE EFFECT
#There is a POSITIVE effect of resources on Foraging Parameters (beta & k) which is WORSE FOR HOSTS

    #Negative effect of Resources (beta & k) with Positive effect (b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as dataframe
    tmpNegativeB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params)) 
    #Save equilibrium values from temporary dataframe into vectors
    equilibriumH_NegativeB[length(equilibriumH_NegativeB)+1] <- tmpNegativeB$H[length(tmpNegativeB$H)]
    equilibriumP_NegativeB[length(equilibriumP_NegativeB)+1] <- tmpNegativeB$P[length(tmpNegativeB$P)]
    equilibriumForagingResource_NegativeB[length(equilibriumForagingResource_NegativeB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeB[length(equilibriumNonForagingResource_NegativeB)+1] <- resource[i]
    
    #Positive effect of Resources (beta & k & b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as datframe
    tmpPositiveB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_PositiveB[length(equilibriumH_PositiveB)+1] <- tmpPositiveB$H[length(tmpPositiveB$H)]
    equilibriumP_PositiveB[length(equilibriumP_PositiveB)+1] <- tmpPositiveB$P[length(tmpPositiveB$P)]
    equilibriumForagingResource_PositiveB[length(equilibriumForagingResource_PositiveB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_PositiveB[length(equilibriumNonForagingResource_PositiveB)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForB <- (equilibriumH_PositiveB[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForB <- (equilibriumH_PositiveB[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
      
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeB[1]/equilibriumH_NegativeB[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeB[i]/equilibriumH_NegativeB[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForB <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForB <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstB==TRUE & (sign(hostOriginalPctChangeForB)==-1 & hostCurrentPctChangeForB>0)){
      hostFirstB <- FALSE
      hostResourceBreakPointForB <- append(hostResourceBreakPointForB, resource[i])
      hostForagingResourceForB <- append(hostForagingResourceForB, foragingResource[j])
    } else if (hostFirstB==TRUE & (sign(hostOriginalPctChangeForB)==1 & hostCurrentPctChangeForB<0)){
      hostFirstB <- FALSE
      hostResourceBreakPointForB <- append(hostResourceBreakPointForB, resource[i])      
      hostForagingResourceForB <- append(hostForagingResourceForB, foragingResource[j])
    } else {
      hostResourceBreakPointForB <- hostResourceBreakPointForB
      hostForagingResourceForB <- hostForagingResourceForB
    }
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstB==TRUE & (sign(pphOriginalPctChangeForB)==-1 & pphCurrentPctChangeForB>0)){
      pphFirstB <- FALSE
      pphResourceBreakPointForB <- append(pphResourceBreakPointForB, resource[i])
      pphForagingResourceForB <- append(pphForagingResourceForB, foragingResource[j])
    } else if (pphFirstB==TRUE & (sign(pphOriginalPctChangeForB)==1 & pphCurrentPctChangeForB<0)){
      pphFirstB <- FALSE
      pphResourceBreakPointForB <- append(pphResourceBreakPointForB, resource[i])
      pphForagingResourceForB <- append(pphForagingResourceForB, foragingResource[j])
      } else {
      pphResourceBreakPointForB <- pphResourceBreakPointForB
      pphForagingResourceForB <- pphForagingResourceForB

    }
        
    #########################################################################################################################################
    
    #Negative effect of Resources (beta & k & d) 
    b=b0
    d=dr[i]
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeD <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeD[length(equilibriumH_NegativeD)+1] <- tmpNegativeD$H[length(tmpNegativeD$H)]
    equilibriumP_NegativeD[length(equilibriumP_NegativeD)+1] <- tmpNegativeD$P[length(tmpNegativeD$P)]
    equilibriumForagingResource_NegativeD[length(equilibriumForagingResource_NegativeD)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeD[length(equilibriumNonForagingResource_NegativeD)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForD <- (equilibriumH_NegativeD[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForD <- (equilibriumH_NegativeD[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeD[1]/equilibriumH_NegativeD[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeD[i]/equilibriumH_NegativeD[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForD <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForD <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstD==TRUE & (sign(hostOriginalPctChangeForD)==-1 & hostCurrentPctChangeForD>0)){
      hostFirstD <- FALSE
      hostResourceBreakPointForD <- append(hostResourceBreakPointForD, resource[i])
      hostForagingResourceForD <- append(hostForagingResourceForD, foragingResource[j])
      } else if (hostFirstD==TRUE & (sign(hostOriginalPctChangeForD)==1 & hostCurrentPctChangeForD<0)){
      hostFirstD <- FALSE
      hostResourceBreakPointForD <- append(hostResourceBreakPointForD, resource[i])
      hostForagingResourceForD <- append(hostForagingResourceForD, foragingResource[j])
      } else {
      hostResourceBreakPointForD <- hostResourceBreakPointForD
      hostForagingResourceForD <- hostForagingResourceForD
    }
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstD==TRUE & (sign(pphOriginalPctChangeForD)==-1 & pphCurrentPctChangeForD>0)){
      pphFirstD <- FALSE
      pphResourceBreakPointForD <- append(pphResourceBreakPointForD, resource[i])
      pphForagingResourceForD <- append(pphForagingResourceForD, foragingResource[j])
      } else if (pphFirstD==TRUE & (sign(pphOriginalPctChangeForD)==1 & pphCurrentPctChangeForD<0)){
      pphFirstD <- FALSE
      pphResourceBreakPointForD <- append(pphResourceBreakPointForD, resource[i])
      pphForagingResourceForD <- append(pphForagingResourceForD, foragingResource[j])
      } else {
      pphResourceBreakPointForD <- pphResourceBreakPointForD
      pphForagingResourceForD <- pphForagingResourceForD

    }
    
  #########################################################################################################################################
    
    #Positive effect of Resources (beta & k & KcarryCap)
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpPositiveKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_PositiveKcarryCap[length(equilibriumH_PositiveKcarryCap)+1] <- tmpPositiveKcarryCap$H[length(tmpPositiveKcarryCap$H)]
    equilibriumP_PositiveKcarryCap[length(equilibriumP_PositiveKcarryCap)+1] <- tmpPositiveKcarryCap$P[length(tmpPositiveKcarryCap$P)]
    equilibriumForagingResource_PositiveKcarryCap[length(equilibriumForagingResource_PositiveKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_PositiveKcarryCap[length(equilibriumNonForagingResource_PositiveKcarryCap)+1] <- resource[i]
    
    #Negative effect of Resources (beta & k) with Positive effect (KcarryCap) 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeKcarryCap[length(equilibriumH_NegativeKcarryCap)+1] <- tmpNegativeKcarryCap$H[length(tmpNegativeKcarryCap$H)]
    equilibriumP_NegativeKcarryCap[length(equilibriumP_NegativeKcarryCap)+1] <- tmpNegativeKcarryCap$P[length(tmpNegativeKcarryCap$P)]
    equilibriumForagingResource_NegativeKcarryCap[length(equilibriumForagingResource_NegativeKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeKcarryCap[length(equilibriumNonForagingResource_NegativeKcarryCap)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForKcarryCap <- (equilibriumH_PositiveKcarryCap[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForKcarryCap <- (equilibriumH_PositiveKcarryCap[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeKcarryCap[1]/equilibriumH_NegativeKcarryCap[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeKcarryCap[i]/equilibriumH_NegativeKcarryCap[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForKcarryCap <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForKcarryCap <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstKcarryCap==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==-1 & hostCurrentPctChangeForKcarryCap>0)){
      hostFirstKcarryCap <- FALSE
      hostResourceBreakPointForKcarryCap <- append(hostResourceBreakPointForKcarryCap, resource[i])
      hostForagingResourceForKcarryCap <- append(hostForagingResourceForKcarryCap, foragingResource[j])
      } else if (hostFirstKcarryCap==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==1 & hostCurrentPctChangeForKcarryCap<0)){
      hostFirstKcarryCap <- FALSE
      hostResourceBreakPointForKcarryCap <- append(hostResourceBreakPointForKcarryCap, resource[i])
      hostForagingResourceForKcarryCap <- append(hostForagingResourceForKcarryCap, foragingResource[j])
      } else {
      hostResourceBreakPointForKcarryCap <- hostResourceBreakPointForKcarryCap
      hostForagingResourceForKcarryCap <- hostForagingResourceForKcarryCap
      }
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstKcarryCap==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==-1 & pphCurrentPctChangeForKcarryCap>0)){
      pphFirstKcarryCap <- FALSE
      pphResourceBreakPointForKcarryCap <- append(pphResourceBreakPointForKcarryCap, resource[i])
      pphForagingResourceForKcarryCap <- append(pphForagingResourceForKcarryCap, foragingResource[j])
      } else if (pphFirstKcarryCap==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==1 & pphCurrentPctChangeForKcarryCap<0)){
      pphFirstKcarryCap <- FALSE
      pphResourceBreakPointForKcarryCap <- append(pphResourceBreakPointForKcarryCap, resource[i])
      pphForagingResourceForKcarryCap <- append(pphForagingResourceForKcarryCap, foragingResource[j])
      } else {
      pphResourceBreakPointForKcarryCap <- pphResourceBreakPointForKcarryCap
      pphForagingResourceForKcarryCap <- pphForagingResourceForKcarryCap
      }
  
  ########################################################################################################################################
    
    #Negative effect of Resources (beta, k, & alpha)
    b=b0
    d=d0
    alpha=alphar[i]
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeAlpha <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeAlpha[length(equilibriumH_NegativeAlpha)+1] <- tmpNegativeAlpha$H[length(tmpNegativeAlpha$H)]
    equilibriumP_NegativeAlpha[length(equilibriumP_NegativeAlpha)+1] <- tmpNegativeAlpha$P[length(tmpNegativeAlpha$P)]
    equilibriumForagingResource_NegativeAlpha[length(equilibriumForagingResource_NegativeAlpha)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeAlpha[length(equilibriumNonForagingResource_NegativeAlpha)+1] <- resource[i]
      
    #Checking percentage change
    hostOriginalPctChangeForAlpha <- (equilibriumH_NegativeAlpha[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForAlpha <- (equilibriumH_NegativeAlpha[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeAlpha[1]/equilibriumH_NegativeAlpha[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeAlpha[i]/equilibriumH_NegativeAlpha[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForAlpha <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForAlpha <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstAlpha==TRUE & (sign(hostOriginalPctChangeForAlpha)==-1 & hostCurrentPctChangeForAlpha>0)){
      hostFirstAlpha <- FALSE
      hostResourceBreakPointForAlpha <- append(hostResourceBreakPointForAlpha, resource[i])
      hostForagingResourceForAlpha <- append(hostForagingResourceForAlpha, foragingResource[j])
      } else if (hostFirstAlpha==TRUE & (sign(hostOriginalPctChangeForAlpha)==1 & hostCurrentPctChangeForAlpha<0)){
      hostFirstAlpha <- FALSE
      hostResourceBreakPointForAlpha <- append(hostResourceBreakPointForAlpha, resource[i])
      hostForagingResourceForAlpha <- append(hostForagingResourceForAlpha, foragingResource[j])
      } else {
      hostResourceBreakPointForAlpha <- hostResourceBreakPointForAlpha
      hostForagingResourceForAlpha <- hostForagingResourceForAlpha
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstAlpha==TRUE & (sign(pphOriginalPctChangeForAlpha)==-1 & pphCurrentPctChangeForAlpha>0)){
      pphFirstAlpha <- FALSE
      pphResourceBreakPointForAlpha <- append(pphResourceBreakPointForAlpha, resource[i])
      pphForagingResourceForAlpha <- append(pphForagingResourceForAlpha, foragingResource[j])
      } else if (pphFirstAlpha==TRUE & (sign(pphOriginalPctChangeForAlpha)==1 & pphCurrentPctChangeForAlpha<0)){
      pphFirstAlpha <- FALSE
      pphResourceBreakPointForAlpha <- append(pphResourceBreakPointForAlpha, resource[i])
      pphForagingResourceForAlpha <- append(pphForagingResourceForAlpha, foragingResource[j])
      } else {
      pphResourceBreakPointForAlpha <- pphResourceBreakPointForAlpha
      pphForagingResourceForAlpha <- pphForagingResourceForAlpha
    }
    
  ########################################################################################################################################
  
    #Positive effect of Resources (beta, k, & muPositive)
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=murPositive[i]
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpPositiveMuPositive <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_PositiveMuPositive[length(equilibriumH_PositiveMuPositive)+1] <- tmpPositiveMuPositive$H[length(tmpPositiveMuPositive$H)]
    equilibriumP_PositiveMuPositive[length(equilibriumP_PositiveMuPositive)+1] <- tmpPositiveMuPositive$P[length(tmpPositiveMuPositive$P)]
    equilibriumForagingResource_PositiveMuPositive[length(equilibriumForagingResource_PositiveMuPositive)+1] <- foragingResource[j]
    equilibriumNonForagingResource_PositiveMuPositive[length(equilibriumNonForagingResource_PositiveMuPositive)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForMuPositive <- (equilibriumH_PositiveMuPositive[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuPositive <- (equilibriumH_PositiveMuPositive[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_PositiveMuPositive[1]/equilibriumH_PositiveMuPositive[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_PositiveMuPositive[i]/equilibriumH_PositiveMuPositive[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuPositive <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuPositive <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuPositive==TRUE & (sign(hostOriginalPctChangeForMuPositive)==-1 & hostCurrentPctChangeForMuPositive>0)){
      hostFirstMuPositive <- FALSE
      hostResourceBreakPointForMuPositive <- append(hostResourceBreakPointForMuPositive, resource[i])
      hostForagingResourceForMuPositive <- append(hostForagingResourceForMuPositive, foragingResource[j])
      } else if (hostFirstMuPositive==TRUE & (sign(hostOriginalPctChangeForMuPositive)==1 & hostCurrentPctChangeForMuPositive<0)){
      hostFirstMuPositive <- FALSE
      hostResourceBreakPointForMuPositive <- append(hostResourceBreakPointForMuPositive, resource[i])
      hostForagingResourceForMuPositive <- append(hostForagingResourceForMuPositive, foragingResource[j])
      } else {
      hostResourceBreakPointForMuPositive <- hostResourceBreakPointForMuPositive      
      hostForagingResourceForMuPositive <- hostForagingResourceForMuPositive
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuPositive==TRUE & (sign(pphOriginalPctChangeForMuPositive)==-1 & pphCurrentPctChangeForMuPositive>0)){
      pphFirstMuPositive <- FALSE
      pphResourceBreakPointForMuPositive <- append(pphResourceBreakPointForMuPositive, resource[i])
      pphForagingResourceForMuPositive <- append(pphForagingResourceForMuPositive, foragingResource[j])
      } else if (pphFirstMuPositive==TRUE & (sign(pphOriginalPctChangeForMuPositive)==1 & pphCurrentPctChangeForMuPositive<0)){
      pphFirstMuPositive <- FALSE
      pphResourceBreakPointForMuPositive <- append(pphResourceBreakPointForMuPositive, resource[i])
      pphForagingResourceForMuPositive <- append(pphForagingResourceForMuPositive, foragingResource[j])
      } else {
      pphResourceBreakPointForMuPositive <- pphResourceBreakPointForMuPositive      
      pphForagingResourceForMuPositive <- pphForagingResourceForMuPositive
    }
    
  ########################################################################################################################################
    
    #Negative effect of Resources (beta & k & lambda) 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambdar[i]
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeLambda <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeLambda[length(equilibriumH_NegativeLambda)+1] <- tmpNegativeLambda$H[length(tmpNegativeLambda$H)]
    equilibriumP_NegativeLambda[length(equilibriumP_NegativeLambda)+1] <- tmpNegativeLambda$P[length(tmpNegativeLambda$P)]
    equilibriumForagingResource_NegativeLambda[length(equilibriumForagingResource_NegativeLambda)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeLambda[length(equilibriumNonForagingResource_NegativeLambda)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForLambda <- (equilibriumH_NegativeLambda[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForLambda <- (equilibriumH_NegativeLambda[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeLambda[1]/equilibriumH_NegativeLambda[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeLambda[i]/equilibriumH_NegativeLambda[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForLambda <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForLambda <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstLambda==TRUE & (sign(hostOriginalPctChangeForLambda)==-1 & hostCurrentPctChangeForLambda>0)){
      hostFirstLambda <- FALSE
      hostResourceBreakPointForLambda <- append(hostResourceBreakPointForLambda, resource[i])
      hostForagingResourceForLambda <- append(hostForagingResourceForLambda, foragingResource[j])
      } else if (hostFirstLambda==TRUE & (sign(hostOriginalPctChangeForLambda)==1 & hostCurrentPctChangeForLambda<0)){
      hostFirstLambda <- FALSE
      hostResourceBreakPointForLambda <- append(hostResourceBreakPointForLambda, resource[i])
      hostForagingResourceForLambda <- append(hostForagingResourceForLambda, foragingResource[j])
      } else {
      hostResourceBreakPointForLambda <- hostResourceBreakPointForLambda      
      hostForagingResourceForLambda <- hostForagingResourceForLambda
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstLambda==TRUE & (sign(pphOriginalPctChangeForLambda)==-1 & pphCurrentPctChangeForLambda>0)){
      pphFirstLambda <- FALSE
      pphResourceBreakPointForLambda <- append(pphResourceBreakPointForLambda, resource[i])
      pphForagingResourceForLambda <- append(pphForagingResourceForLambda, foragingResource[j])
      } else if (pphFirstLambda==TRUE & (sign(pphOriginalPctChangeForLambda)==1 & pphCurrentPctChangeForLambda<0)){
      pphFirstLambda <- FALSE
      pphResourceBreakPointForLambda <- append(pphResourceBreakPointForLambda, resource[i])
      pphForagingResourceForLambda <- append(pphForagingResourceForLambda, foragingResource[j])
      } else {
      pphResourceBreakPointForLambda<- pphResourceBreakPointForLambda     
      pphForagingResourceForLambda <- pphForagingResourceForLambda
    }
    
  ########################################################################################################################################
    
    #Negative effect of Resources (beta & k & muNegative) 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=murNegative[i]
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeMuNegative <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeMuNegative[length(equilibriumH_NegativeMuNegative)+1] <- tmpNegativeMuNegative$H[length(tmpNegativeMuNegative$H)]
    equilibriumP_NegativeMuNegative[length(equilibriumP_NegativeMuNegative)+1] <- tmpNegativeMuNegative$P[length(tmpNegativeMuNegative$P)]
    equilibriumForagingResource_NegativeMuNegative[length(equilibriumForagingResource_NegativeMuNegative)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeMuNegative[length(equilibriumNonForagingResource_NegativeMuNegative)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForMuNegative <- (equilibriumH_NegativeMuNegative[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuNegative <- (equilibriumH_NegativeMuNegative[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeMuNegative[1]/equilibriumH_NegativeMuNegative[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeMuNegative[i]/equilibriumH_NegativeMuNegative[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuNegative <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuNegative <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuNegative==TRUE & (sign(hostOriginalPctChangeForMuNegative)== -1 & hostCurrentPctChangeForMuNegative>0)){
      hostFirstMuNegative <- FALSE
      hostResourceBreakPointForMuNegative <- append(hostResourceBreakPointForMuNegative, resource[i])
      hostForagingResourceForMuNegative <- append(hostForagingResourceForMuNegative, foragingResource[j])
      } else if (hostFirstMuNegative==TRUE & (sign(hostOriginalPctChangeForMuNegative)== 1 & hostCurrentPctChangeForMuNegative<0)){
      hostFirstMuNegative <- FALSE
      hostResourceBreakPointForMuNegative <- append(hostResourceBreakPointForMuNegative, resource[i])
      hostForagingResourceForMuNegative <- append(hostForagingResourceForMuNegative, foragingResource[j])
      } else {
      hostResourceBreakPointForMuNegative <- hostResourceBreakPointForMuNegative      
      hostForagingResourceForMuNegative <- hostForagingResourceForMuNegative
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuNegative==TRUE & (sign(pphOriginalPctChangeForMuNegative)== -1 & pphCurrentPctChangeForMuNegative>0)){
      pphFirstMuNegative <- FALSE
      pphResourceBreakPointForMuNegative  <- append(pphResourceBreakPointForMuNegative , resource[i])
      pphForagingResourceForMuNegative  <- append(pphForagingResourceForMuNegative , foragingResource[j])
      } else if (pphFirstMuNegative==TRUE & (sign(pphOriginalPctChangeForMuNegative)== 1 & pphCurrentPctChangeForMuNegative<0)){
      pphFirstMuNegative <- FALSE
      pphResourceBreakPointForMuNegative  <- append(pphResourceBreakPointForMuNegative , resource[i])
      pphForagingResourceForMuNegative  <- append(pphForagingResourceForMuNegative , foragingResource[j])
      } else {
      pphResourceBreakPointForMuNegative <- pphResourceBreakPointForMuNegative      
      pphForagingResourceForMuNegative  <- pphForagingResourceForMuNegative 
    }
  
  }
  
}

```

```{r - Linear Regression to find equation for resourceBreakpoints}
#We can use slope of these regressions as the "sensitivity" of a nonForagingParameter to resource subsidy

hostBirthLM <- lm(hostResourceBreakPointForB ~ hostForagingResourceForB)
summary(hostBirthLM)
  #breakPoint = -3.83 + hostForaging*4.49 
  #F(1, 78) = 34500, p < 2.2*10^(-6), R^2 = 0.9977

hostDeathLM <- lm(hostResourceBreakPointForD ~ hostForagingResourceForD)
summary(hostDeathLM)
  #breakPoint = -33.76 + hostForaging*33.9
  #F(1, 2) = 19.86, p = 0.04685, R^2 = 0.8628

hostCarryingCapacityLM <- lm(hostResourceBreakPointForKcarryCap ~ hostForagingResourceForKcarryCap)
summary(hostCarryingCapacityLM)
  #breakPoint = -10.45 + hostForaging*10.11
  #F(1, 20) = 42.92, p = 2.2*10^(-6), R^2 = 0.6663

#hostParasiteVirulenceLM <- lm(hostResourceBreakPointForAlpha ~ hostForagingResourceForAlpha)
#summary(hostParasiteVirulenceLM)
  #Only version that doesn't work. Null points for both. It fails to reach a breakpoint.

hostMuPositiveLM <- lm(hostResourceBreakPointForMuPositive ~ hostForagingResourceForMuPositive)
summary(hostMuPositiveLM)
  #breakPoint = -1.05 + hostForaging*2.10
  #F(1, 78) = 5.855*10^(5), p < 2.2*10^(-16), R^2 = 0.9999

hostLambdaLM <- lm(hostResourceBreakPointForLambda ~ hostForagingResourceForLambda)
summary(hostLambdaLM)
  #breakPoint = -0.42 + hostForaging*1.36
  #F(1, 78) = 3.678*10^(4), p < 2.2*10^(-16), R^2 = 0.9979

hostMuNegativeLM <- lm(hostResourceBreakPointForMuNegative ~ hostForagingResourceForMuNegative)
summary(hostMuNegativeLM)
  #breakPoint = -10.481 + hostForaging*10.289
  #F(1, 21) = 89.31, p = 5.162*10^(-9), R^2 = 0.8006

######################################################################################################

pphBirthLM <- lm(pphResourceBreakPointForB ~ pphForagingResourceForB)
summary(pphBirthLM)
  #breakPoint = -20.88 + pphForaging*20.62
  #F(1, 7) = 15.94, p = 0.005, R^2 = 0.6513

pphDeathLM <- lm(pphResourceBreakPointForD ~ pphForagingResourceForD)
summary(pphDeathLM)
  #breakPoint = -19.20 + pphForaging*18.62
  #F(1, 12) = 31.06, p = 0.0001, R^2 = 0.6981

pphCarryingCapacityLM <- lm(pphResourceBreakPointForKcarryCap ~ pphForagingResourceForKcarryCap)
summary(pphCarryingCapacityLM)
  #breakPoint = -0.42 + pphForaging*1.36
  #F(1, 78) = 3.678*10^(4), p < 2.2*10^(-16), R^2 = 0.9979

pphParasiteVirulenceLM <- lm(pphResourceBreakPointForAlpha ~ pphForagingResourceForAlpha)
summary(pphParasiteVirulenceLM)
  #breakPoint = -6.82 + pphForaging*7.25
  #F(1, 14) = 32.76, p = 5.264*10^(-5), R^2 = 0.6792

pphMuPositiveLM <- lm(pphResourceBreakPointForMuPositive ~ pphForagingResourceForMuPositive)
summary(pphMuPositiveLM)
  #breakPoint = -1.05 + pphForaging*2.10
  #F(1, 78) = 5.855*10^(5), p < 2.2*10^(-16), R^2 = 0.9999

pphLambdaLM <- lm(pphResourceBreakPointForLambda ~ pphForagingResourceForLambda)
summary(pphLambdaLM)
  #breakPoint = -0.42 + pphForaging*1.36
  #F(1, 78) = 3.653*10^(4), p < 2.2*10^(-16)

pphMuNegativeLM <- lm(pphResourceBreakPointForMuNegative ~ pphForagingResourceForMuNegative)
summary(pphMuNegativeLM)
  #breakPoint = -10.48 + pphForaging*10.29
  #F(1, 21) = 89.48, p = 5.082*10^(-9), R^2 = 0.8009

```

#Selects 3rd order polynomial for all curvilinear (also selects it for straight lines though)
```{r - NONLINEAR LEAST SQUARES REGRESSION}
#ONLY CONSIDER NON-LINEAR SHAPED LINES (visually inspected curvilinear)
#Hosts = d mu- & Hmax

#Host death NLS
hostDeathNLSLinear <- nls(formula=hostResourceBreakPointForD ~ a*hostForagingResourceForD, start=list(a=100))
hostDeathNLSQuadratic <- nls(formula=hostResourceBreakPointForD ~ a*hostForagingResourceForD + b*I(hostForagingResourceForD^2), start=list(a=100, b=100))
hostDeathNLSCubic <- nls(formula=hostResourceBreakPointForD ~ a*hostForagingResourceForD + b*I(hostForagingResourceForD^2) + c*I(hostForagingResourceForD^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostDeathModels <- list(hostDeathNLSLinear, hostDeathNLSQuadratic, hostDeathNLSCubic)
hostDeathModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostDeathModels, modnames=hostDeathModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(hostDeathNLSCubic)

#######################################

#Host Carrying Capacity NLS
hostCarryingCapacityNLSLinear <- nls(formula=hostResourceBreakPointForKcarryCap ~ a*hostForagingResourceForKcarryCap, start=list(a=100))
hostCarryingCapacityNLSQuadratic <- nls(formula=hostResourceBreakPointForKcarryCap ~ a*hostForagingResourceForKcarryCap + b*I(hostForagingResourceForKcarryCap^2), start=list(a=100, b=100))
hostCarryingCapacityNLSCubic <- nls(formula=hostResourceBreakPointForKcarryCap ~ a*hostForagingResourceForKcarryCap + b*I(hostForagingResourceForKcarryCap^2) + c*I(hostForagingResourceForKcarryCap^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostCarryingCapacityModels <- list(hostCarryingCapacityNLSLinear, hostCarryingCapacityNLSQuadratic, hostCarryingCapacityNLSCubic)
hostCarryingCapacityModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostCarryingCapacityModels, modnames=hostCarryingCapacityModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(hostCarryingCapacityNLSCubic)

#######################################

#Host Mu Negative NLS
hostMuNegativeNLSLinear <- nls(formula=hostResourceBreakPointForKcarryCap ~ a*hostForagingResourceForKcarryCap, start=list(a=100))
hostMuNegativeNLSQuadratic <- nls(formula=hostResourceBreakPointForKcarryCap ~ a*hostForagingResourceForKcarryCap + b*I(hostForagingResourceForKcarryCap^2), start=list(a=100, b=100))
hostMuNegativeNLSCubic <- nls(formula=hostResourceBreakPointForKcarryCap ~ a*hostForagingResourceForKcarryCap + b*I(hostForagingResourceForKcarryCap^2) + c*I(hostForagingResourceForKcarryCap^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostMuNegativeModels <- list(hostMuNegativeNLSLinear, hostMuNegativeNLSQuadratic, hostMuNegativeNLSCubic)
hostMuNegativeModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostMuNegativeModels, modnames=hostMuNegativeModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(hostMuNegativeNLSCubic)

############################################################################################################################################################
#ONLY CONSIDER NON-LINEAR SHAPED LINES (visually inspected curvilinear)
#PpH = b d alpha & mu-


#Pph Birth NLS
pphBirthNLSLinear <- nls(formula=pphResourceBreakPointForB ~ a*pphForagingResourceForB, start=list(a=100))
pphBirthNLSQuadratic <- nls(formula=pphResourceBreakPointForB ~ a*pphForagingResourceForB + b*I(pphForagingResourceForB^2), start=list(a=100, b=100))
pphBirthNLSCubic <- nls(formula=pphResourceBreakPointForB ~ a*pphForagingResourceForB + b*I(pphForagingResourceForB^2) + c*I(pphForagingResourceForB^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphBirthModels <- list(pphBirthNLSLinear, pphBirthNLSQuadratic, pphBirthNLSCubic)
pphBirthModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphBirthModels, modnames=pphBirthModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(pphBirthNLSCubic)

#######################################

#Pph Death NLS
pphDeathNLSLinear <- nls(formula=pphResourceBreakPointForD ~ a*pphForagingResourceForD, start=list(a=100))
pphDeathNLSQuadratic <- nls(formula=pphResourceBreakPointForD ~ a*pphForagingResourceForD + b*I(pphForagingResourceForD^2), start=list(a=100, b=100))
pphDeathNLSCubic <- nls(formula=pphResourceBreakPointForD ~ a*pphForagingResourceForD + b*I(pphForagingResourceForD^2) + c*I(pphForagingResourceForD^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphDeathModels <- list(pphDeathNLSLinear, pphDeathNLSQuadratic, pphDeathNLSCubic)
pphDeathModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphDeathModels, modnames=pphDeathModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(pphDeathNLSCubic)

#######################################

#Pph Virulence NLS
pphVirulenceNLSLinear <- nls(formula=pphResourceBreakPointForAlpha ~ a*pphForagingResourceForAlpha, start=list(a=100))
pphVirulenceNLSQuadratic <- nls(formula=pphResourceBreakPointForAlpha ~ a*pphForagingResourceForAlpha + b*I(pphForagingResourceForAlpha^2), start=list(a=100, b=100))
pphVirulenceNLSCubic <- nls(formula=pphResourceBreakPointForAlpha ~ a*pphForagingResourceForAlpha + b*I(pphForagingResourceForAlpha^2) + c*I(pphForagingResourceForAlpha^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphVirulenceModels <- list(pphVirulenceNLSLinear, pphVirulenceNLSQuadratic, pphVirulenceNLSCubic)
pphVirulenceModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphVirulenceModels, modnames=pphVirulenceModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(pphVirulenceNLSCubic)

#######################################

#Pph ParasiteMortalityNeg NLS
pphParasiteMortalityNegNLSLinear <- nls(formula=pphResourceBreakPointForMuNegative ~ a*pphForagingResourceForMuNegative, start=list(a=100))
pphParasiteMortalityNegNLSQuadratic <- nls(formula=pphResourceBreakPointForMuNegative ~ a*pphForagingResourceForMuNegative + b*I(pphForagingResourceForMuNegative^2), start=list(a=100, b=100))
pphParasiteMortalityNegNLSCubic <- nls(formula=pphResourceBreakPointForMuNegative ~ a*pphForagingResourceForMuNegative + b*I(pphForagingResourceForMuNegative^2) + c*I(pphForagingResourceForMuNegative^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphParasiteMortalityNegModels <- list(pphParasiteMortalityNegNLSLinear, pphParasiteMortalityNegNLSQuadratic, pphParasiteMortalityNegNLSCubic)
pphParasiteMortalityNegModelNames <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphParasiteMortalityNegModels, modnames=pphParasiteMortalityNegModelNames)

#Run summary of most parsimonious model (lowest AIC)
summary(pphParasiteMortalityNegNLSCubic)

```

```{r - Curvilinear regressions - Cubic regressions provided significant relationships and highest fit for all parameters}
#Host regressions (d hmax mu-)

hostDeathLMCubic <- lm(hostResourceBreakPointForD ~ hostForagingResourceForD + I(hostForagingResourceForD^2) + I(hostForagingResourceForD^3))
summary(hostDeathLMCubic)
  #breakPoint = -281.05 + 705.78*hostForaging - 587.07*hostForaging^2 + 162.62*hostForaging^3
  #F(3, 4) = 1625, p = 1.26*10^(-6), R^2 = 0.9986


hostCarryingCapacityLMCubic <- lm(hostResourceBreakPointForKcarryCap ~ hostForagingResourceForKcarryCap + I(hostForagingResourceForKcarryCap^2) +
                                  I(hostForagingResourceForKcarryCap^3))
summary(hostCarryingCapacityLMCubic)
  #breakPoint = -281.05 + 705.78*hostForaging - 587.07*hostForaging^2 + 162.62*hostForaging^3
  #F(3, 18) = 226.4, p = 1.776*10^(-14), R^2 = 0.9699


hostMuNegativeLMCubic <- lm(hostResourceBreakPointForMuNegative ~ hostForagingResourceForMuNegative + I(hostForagingResourceForMuNegative^2) +
                            I(hostForagingResourceForMuNegative^3))
summary(hostMuNegativeLMCubic)
  #breakPoint = -152.99 + 385.79*hostForaging - 322.76*hostForaging^2 + 90.57*hostForaging^3
  #F(3, 19) = 995.7, p < 2.2*10^(-16), R^2 = 0.9927

######################################################################################################
#PpH Regressions (b, d, alpha, mu-)

pphBirthLMCubic <- lm(pphResourceBreakPointForB ~ pphForagingResourceForB + I(pphForagingResourceForB^2) + I(pphForagingResourceForB^3))
summary(pphBirthLMCubic)
  #breakPoint = -281.05 + 705.78*pphForaging - 587.07*pphForaging^2 + 162.62*pphForaging^3
  #F(3, 5) = 98.05, p = 7.314*10^(-5), R^2 = 0.9733

pphDeathLMCubic <- lm(pphResourceBreakPointForD ~ pphForagingResourceForD + I(pphForagingResourceForD^2) + I(pphForagingResourceForD^3))
summary(pphDeathLMCubic)
  #breakPoint = -952.8 + 2531.0*pphForaging - 2237.5*pphForaging^2 + 659.5*pphForaging^3
  #F(3, 10) = 201.2, p = 3.09*10^(-9), R^2 = 0.9788

pphParasiteVirulenceLMCubic <- lm(pphResourceBreakPointForAlpha ~ pphForagingResourceForAlpha + I(pphForagingResourceForAlpha^2) + I(pphForagingResourceForAlpha^3))
summary(pphParasiteVirulenceLMCubic)
  #breakPoint = -360.15 + 933.46*pphForaging - 803.19*pphForaging^2 + 230.37*pphForaging^3
  #F(3, 12) = 67.03, p = 9.127*10^(-8), R^2 = 0.9296

pphMuNegativeLMLMCubic <- lm(pphResourceBreakPointForMuNegative ~ pphForagingResourceForMuNegative + I(pphForagingResourceForMuNegative^2) +
                             I(pphForagingResourceForMuNegative^3))
summary(pphMuNegativeLMLMCubic)
  #breakPoint = -153.19 + 386.24*pphForaging - 323.09*pphForaging^2 + 90.65*pphForaging^3
  #F(3, 19) = 1023, p < 2.2*10^(-16), R^2 = 0.9929

```

```{r - Linear Regression Predicted Points - Creating vectors that have the line of best fit points (when paired with foragingResource)}
hostBirthLMPoints <- c()
hostDeathLMPoints <- c()
hostCarryingCapacityLMPoints <- c()
hostParasiteVirulenceLMPoints <- c()
hostMuPositiveLMPoints <- c()
hostLambdaLMPoints <- c()
hostMuNegativeLMPoints <- c()

hostBirthLMPointsPair <- c()
hostDeathLMPointsPair <- c()
hostCarryingCapacityLMPointsPair <- c()
hostParasiteVirulenceLMPointsPair <- c()
hostMuPositiveLMPointsPair <- c()
hostLambdaLMPointsPair <- c()
hostMuNegativeLMPointsPair <- c()

pphBirthLMPoints <- c()
pphDeathLMPoints <- c()
pphCarryingCapacityLMPoints <- c()
pphParasiteVirulenceLMPoints <- c()
pphMuPositiveLMPoints <- c()
pphLambdaLMPoints <- c()
pphMuNegativeLMPoints <- c()

pphBirthLMPointsPair <- c()
pphDeathLMPointsPair <- c()
pphCarryingCapacityLMPointsPair <- c()
pphParasiteVirulenceLMPointsPair <- c()
pphMuPositiveLMPointsPair <- c()
pphLambdaLMPointsPair <- c()
pphMuNegativeLMPointsPair <- c()

#Calculating Regression line points (line of best fit points)
for (j in 1:length(foragingResource)){
  tempHostBirthLMPoints = unname((hostBirthLM$coefficients[1] + hostBirthLM$coefficients[2]*foragingResource[j])) #unname() removes the Intercept and Slope terms added by lm()
  hostBirthLMPoints <- append(hostBirthLMPoints, values=tempHostBirthLMPoints)
  hostBirthLMPointsPair <- append(hostBirthLMPointsPair, values=foragingResource[j])
  
  tempHostDeathLMPoints = unname((hostDeathLM$coefficients[1] + hostDeathLM$coefficients[2]*foragingResource[j]))
  hostDeathLMPoints <- append(hostDeathLMPoints, values=tempHostDeathLMPoints)
  hostDeathLMPointsPair <- append(hostDeathLMPointsPair, values=foragingResource[j])
  
  tempHostCarryingCapacityLMPoints = unname((hostCarryingCapacityLM$coefficients[1] + hostCarryingCapacityLM$coefficients[2]*foragingResource[j])) 
  hostCarryingCapacityLMPoints <- append(hostCarryingCapacityLMPoints, values=tempHostCarryingCapacityLMPoints)
  hostCarryingCapacityLMPointsPair <- append(hostCarryingCapacityLMPointsPair, values=foragingResource[j])
  
  #Recall that Alpha (parasite virulence) is incapable of overcoming foraging resource effects thus it is excluded
  #tempHostParasiteVirulenceLMPoints = unname((HostParasiteVirulenceLM$coefficients[1] + HostParasiteVirulenceLM$coefficients[2]*foragingResource[j]))
  #hostParasiteVirulenceLMPoints <- append(hostParasiteVirulenceLMPoints, values=tempHostParasiteVirulenceLMPoints)
  #hostParasiteVirulenceLMPointsPair <- append(hostParasiteVirulenceLMPointsPair, values=foragingResource[j])

  tempHostMuPositiveLMPoints = unname((hostMuPositiveLM$coefficients[1] + hostMuPositiveLM$coefficients[2]*foragingResource[j])) 
  hostMuPositiveLMPoints <- append(hostMuPositiveLMPoints, values=tempHostMuPositiveLMPoints)
  hostMuPositiveLMPointsPair <- append(hostMuPositiveLMPointsPair, values=foragingResource[j])

  tempHostLambdaLMPoints = unname((hostLambdaLM$coefficients[1] + hostLambdaLM$coefficients[2]*foragingResource[j]))
  hostLambdaLMPoints <- append(hostLambdaLMPoints, values=tempHostLambdaLMPoints)
  hostLambdaLMPointsPair <- append(hostLambdaLMPointsPair, values=foragingResource[j])

  tempHostMuNegativeLMPoints = unname((hostMuNegativeLM$coefficients[1] + hostMuNegativeLM$coefficients[2]*foragingResource[j])) 
  hostMuNegativeLMPoints <- append(hostMuNegativeLMPoints, values=tempHostMuNegativeLMPoints)
  hostMuNegativeLMPointsPair <- append(hostMuNegativeLMPointsPair, values=foragingResource[j])

  ##################################################################################################################################################################
  
  tempPphBirthLMPoints = unname((pphBirthLM$coefficients[1] + pphBirthLM$coefficients[2]*foragingResource[j])) #unname() removes the Intercept and Slope terms added by lm()
  pphBirthLMPoints <- append(pphBirthLMPoints, values=tempPphBirthLMPoints)
  pphBirthLMPointsPair <- append(pphBirthLMPointsPair, values=foragingResource[j])
  
  tempPphDeathLMPoints = unname((pphDeathLM$coefficients[1] + pphDeathLM$coefficients[2]*foragingResource[j]))
  pphDeathLMPoints <- append(pphDeathLMPoints, values=tempPphDeathLMPoints)
  pphDeathLMPointsPair <- append(pphDeathLMPointsPair, values=foragingResource[j])
  
  tempPphCarryingCapacityLMPoints = unname((pphCarryingCapacityLM$coefficients[1] + pphCarryingCapacityLM$coefficients[2]*foragingResource[j])) 
  pphCarryingCapacityLMPoints <- append(pphCarryingCapacityLMPoints, values=tempPphCarryingCapacityLMPoints)
  pphCarryingCapacityLMPointsPair <- append(pphCarryingCapacityLMPointsPair, values=foragingResource[j])

  tempPphParasiteVirulenceLMPoints = unname((pphParasiteVirulenceLM$coefficients[1] + pphParasiteVirulenceLM$coefficients[2]*foragingResource[j])) 
  pphParasiteVirulenceLMPoints <- append(pphParasiteVirulenceLMPoints, values=tempPphParasiteVirulenceLMPoints)
  pphParasiteVirulenceLMPointsPair <- append(pphParasiteVirulenceLMPointsPair, values=foragingResource[j])

  tempPphMuPositiveLMPoints = unname((pphMuPositiveLM$coefficients[1] + pphMuPositiveLM$coefficients[2]*foragingResource[j])) 
  pphMuPositiveLMPoints <- append(pphMuPositiveLMPoints, values=tempPphMuPositiveLMPoints)
  pphMuPositiveLMPointsPair <- append(pphMuPositiveLMPointsPair, values=foragingResource[j])

  tempPphLambdaLMPoints = unname((pphLambdaLM$coefficients[1] + pphLambdaLM$coefficients[2]*foragingResource[j]))
  pphLambdaLMPoints <- append(pphLambdaLMPoints, values=tempPphLambdaLMPoints)
  pphLambdaLMPointsPair <- append(pphLambdaLMPointsPair, values=foragingResource[j])

  tempPphMuNegativeLMPoints = unname((pphMuNegativeLM$coefficients[1] + pphMuNegativeLM$coefficients[2]*foragingResource[j])) 
  pphMuNegativeLMPoints <- append(pphMuNegativeLMPoints, values=tempPphMuNegativeLMPoints)
  pphMuNegativeLMPointsPair <- append(pphMuNegativeLMPointsPair, values=foragingResource[j])

}

#Saving the ENDING POINT of line of best fit so that we can graph the symbols larger later
#using linear regression equation to create a point of resourceBreakpoint that we can put in the graph to show which line is for which nonForagingParameter
hostBirthLMEndPoint = max(hostBirthLMPoints[hostBirthLMPoints <= max(resource)])
hostDeathLMEndPoint = max(hostDeathLMPoints[hostDeathLMPoints <= max(resource)])
hostCarryingCapacityLMEndPoint = max(hostCarryingCapacityLMPoints[hostCarryingCapacityLMPoints <= max(resource)])
#hostParasiteVirulenceLMEndPoint = max(hostParasiteVirulenceLMPoints[hostParasiteVirulenceLMPoints <= max(resource)]) #Doesn't work since only 1 point
hostMuPositiveLMEndPoint = max(hostMuPositiveLMPoints[hostMuPositiveLMPoints <= max(resource)])
hostLambdaLMEndPoint = max(hostLambdaLMPoints[hostLambdaLMPoints <= max(resource)])
hostMuNegativeLMEndPoint = max(hostMuNegativeLMPoints[hostMuNegativeLMPoints <= max(resource)])

hostBirthLMEndPointPair = hostBirthLMPointsPair[length(hostBirthLMPoints[hostBirthLMPoints <= max(resource)])]
hostDeathLMEndPointPair = hostDeathLMPointsPair[length(hostDeathLMPoints[hostDeathLMPoints <= max(resource)])]
hostCarryingCapacityLMEndPointPair = hostCarryingCapacityLMPointsPair[length(hostCarryingCapacityLMPoints[hostCarryingCapacityLMPoints <= max(resource)])]
#hostParasiteVirulenceLMEndPointPair = hostParasiteVirulenceLMPointsPair[length(hostParasiteVirulenceLMPoints[hostParasiteVirulenceLMPoints <= max(resource)])]
hostMuPositiveLMEndPointPair = hostMuPositiveLMPointsPair[length(hostMuPositiveLMPoints[hostMuPositiveLMPoints <= max(resource)])]
hostLambdaLMEndPointPair = hostLambdaLMPointsPair[length(hostLambdaLMPoints[hostLambdaLMPoints <= max(resource)])]
hostMuNegativeLMEndPointPair = hostMuNegativeLMPointsPair[length(hostMuNegativeLMPoints[hostMuNegativeLMPoints <= max(resource)])]

pphBirthLMEndPoint = max(pphBirthLMPoints[pphBirthLMPoints <= max(resource)])
pphDeathLMEndPoint = max(pphDeathLMPoints[pphDeathLMPoints <= max(resource)])
pphCarryingCapacityLMEndPoint = max(pphCarryingCapacityLMPoints[pphCarryingCapacityLMPoints <= max(resource)])
pphParasiteVirulenceLMEndPoint = max(pphParasiteVirulenceLMPoints[pphParasiteVirulenceLMPoints <= max(resource)])
pphMuPositiveLMEndPoint = max(pphMuPositiveLMPoints[pphMuPositiveLMPoints <= max(resource)])
pphLambdaLMEndPoint = max(pphLambdaLMPoints[pphLambdaLMPoints <= max(resource)])
pphMuNegativeLMEndPoint = max(pphMuNegativeLMPoints[pphMuNegativeLMPoints <= max(resource)])

pphBirthLMEndPointPair = pphBirthLMPointsPair[length(pphBirthLMPoints[pphBirthLMPoints <= max(resource)])]
pphDeathLMEndPointPair = pphDeathLMPointsPair[length(pphDeathLMPoints[pphDeathLMPoints <= max(resource)])]
pphCarryingCapacityLMEndPointPair = pphCarryingCapacityLMPointsPair[length(pphCarryingCapacityLMPoints[pphCarryingCapacityLMPoints <= max(resource)])]
pphParasiteVirulenceLMEndPointPair = pphParasiteVirulenceLMPointsPair[length(pphParasiteVirulenceLMPoints[pphParasiteVirulenceLMPoints <= max(resource)])]
pphMuPositiveLMEndPointPair = pphMuPositiveLMPointsPair[length(pphMuPositiveLMPoints[pphMuPositiveLMPoints <= max(resource)])]
pphLambdaLMEndPointPair = pphLambdaLMPointsPair[length(pphLambdaLMPoints[pphLambdaLMPoints <= max(resource)])]
pphMuNegativeLMEndPointPair = pphMuNegativeLMPointsPair[length(pphMuNegativeLMPoints[pphMuNegativeLMPoints <= max(resource)])]

```

```{r - Creating datasets}
#Ranked by nonForagingParameter alphabetization (because we graph our values by NFP for legend)
bShape <- 0
dShape <- 2
KcarryCapShape <- 1
AlphaShape <- 6
MuPositiveShape <- 5
LambdaShape <- 3
MuNegativeShape <- 4

#Creating dataframes for hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #resourceBreakPoints = amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #foragingResourceLevel = amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

#Selecting every n-th value from parameters that have too many points for graphing (we can no longer see the linear regression line)
vectorValueSimplifier <- function(vector, stepSize){
  vector[seq(1, length(vector), by=stepSize)]
}

#Hosts (b, lambda, mu-, mu+)
hostResourceBreakPointForBSimple <- vectorValueSimplifier(hostResourceBreakPointForB, 4) 
hostForagingResourceForBSimple <- vectorValueSimplifier(hostForagingResourceForB, 4)
hostResourceBreakPointForMuPositiveSimple <- vectorValueSimplifier(hostResourceBreakPointForMuPositive, 3)
hostForagingResourceForMuPositiveSimple <- vectorValueSimplifier(hostForagingResourceForMuPositive, 3)
hostResourceBreakPointForLambdaSimple <- vectorValueSimplifier(hostResourceBreakPointForLambda, 4) 
hostForagingResourceForLambdaSimple <- vectorValueSimplifier(hostForagingResourceForLambda, 4) 
hostResourceBreakPointForMuNegativeSimple <- vectorValueSimplifier(hostResourceBreakPointForMuNegative, 2)
hostForagingResourceForMuNegativeSimple <- vectorValueSimplifier(hostForagingResourceForMuNegative, 2)

#Parasites per Host (Hmax, lambda, mu-, mu+)
pphResourceBreakPointForKcarryCapSimple <- vectorValueSimplifier(pphResourceBreakPointForKcarryCap, 4)
pphForagingResourceForKcarryCapSimple <- vectorValueSimplifier(pphForagingResourceForKcarryCap, 4)
pphResourceBreakPointForLambdaSimple <- vectorValueSimplifier(pphResourceBreakPointForLambda, 4)
pphForagingResourceForLambdaSimple <- vectorValueSimplifier(pphForagingResourceForLambda, 4)
pphResourceBreakPointForMuNegativeSimple <- vectorValueSimplifier(pphResourceBreakPointForMuNegative, 2)
pphForagingResourceForMuNegativeSimple <- vectorValueSimplifier(pphForagingResourceForMuNegative, 2)
pphResourceBreakPointForMuPositiveSimple <- vectorValueSimplifier(pphResourceBreakPointForMuPositive, 4)
pphForagingResourceForMuPositiveSimple <- vectorValueSimplifier(pphForagingResourceForMuPositive, 4)


hostDataAll <- data.frame(resourceBreakPoints=c(hostResourceBreakPointForBSimple, hostResourceBreakPointForD, hostResourceBreakPointForKcarryCap, hostResourceBreakPointForAlpha, hostResourceBreakPointForMuPositiveSimple, hostResourceBreakPointForLambdaSimple, hostResourceBreakPointForMuNegativeSimple),
                          foragingResourceLevel=c(hostForagingResourceForBSimple, hostForagingResourceForD, hostForagingResourceForKcarryCap, hostForagingResourceForAlpha, hostForagingResourceForMuPositiveSimple, hostForagingResourceForLambdaSimple, hostForagingResourceForMuNegativeSimple), 
                          nonForagingParameter=c(rep("Host Birth Rate", times=length(hostResourceBreakPointForBSimple)), rep("Host Natural Mortality", times=length(hostResourceBreakPointForD)), rep("Host Carrying Capacity", times=length(hostResourceBreakPointForKcarryCap)), rep("Parasite Virulence", times=length(hostResourceBreakPointForAlpha)), rep("Parasite Mortality+", times=length(hostResourceBreakPointForMuPositiveSimple)), rep("Parasite Egg Production", times=length(hostResourceBreakPointForLambdaSimple)), rep("Parasite Mortality-", times=length(hostResourceBreakPointForMuNegativeSimple))),
                          NNP=c(rep("Increased Host Overlap", times=length(hostResourceBreakPointForBSimple)), rep("Decreased Host Overlap", times=length(hostResourceBreakPointForD)), rep("Increased Host Overlap", times=length(hostResourceBreakPointForKcarryCap)), rep("Decreased Host Overlap", times=length(hostResourceBreakPointForAlpha)), rep("Increased Host Overlap", times=length(hostResourceBreakPointForMuPositiveSimple)), rep("Decreased Host Overlap", times=length(hostResourceBreakPointForLambdaSimple)), rep("Decreased Host Overlap", times=length(hostResourceBreakPointForMuNegativeSimple))),
                          pointShape=c(rep(bShape, times=length(hostResourceBreakPointForBSimple)), rep(dShape, times=length(hostResourceBreakPointForD)), rep(KcarryCapShape, times=length(hostResourceBreakPointForKcarryCap)), rep(AlphaShape, times=length(hostResourceBreakPointForAlpha)), rep(MuPositiveShape, times=length(hostResourceBreakPointForMuPositiveSimple)), rep(LambdaShape, times=length(hostResourceBreakPointForLambdaSimple)), rep(MuNegativeShape, times=length(hostResourceBreakPointForMuNegativeSimple)))
                       )

pphDataAll <- data.frame(resourceBreakPoints=c(pphResourceBreakPointForB, pphResourceBreakPointForD, pphResourceBreakPointForKcarryCapSimple, pphResourceBreakPointForAlpha, pphResourceBreakPointForMuPositiveSimple, pphResourceBreakPointForLambdaSimple, pphResourceBreakPointForMuNegativeSimple),
                       foragingResourceLevel=c(pphForagingResourceForB, pphForagingResourceForD, pphForagingResourceForKcarryCapSimple, pphForagingResourceForAlpha, pphForagingResourceForMuPositiveSimple, pphForagingResourceForLambdaSimple, pphForagingResourceForMuNegativeSimple),
                       nonForagingParameter=c(rep("Host Birth Rate", times=length(pphResourceBreakPointForB)), rep("Host Natural Mortality", times=length(pphResourceBreakPointForD)), rep("Host Carrying Capacity", times=length(pphResourceBreakPointForKcarryCapSimple)), rep("Parasite Virulence", times=length(pphResourceBreakPointForAlpha)), rep("Parasite Mortality+", times=length(pphResourceBreakPointForMuPositiveSimple)), rep("Parasite Egg Production", times=length(pphResourceBreakPointForLambdaSimple)), rep("Parasite Mortality-", times=length(pphResourceBreakPointForMuNegativeSimple))),
                       NNP=c(rep("Decreased Host Overlap", times=length(pphResourceBreakPointForB)), rep("Decreased Host Overlap", times=length(pphResourceBreakPointForD)), rep("Decreased Host Overlap", times=length(pphResourceBreakPointForKcarryCapSimple)), rep("Decreased Host Overlap", times=length(pphResourceBreakPointForAlpha)), rep("Increased Host Overlap", times=length(pphResourceBreakPointForMuPositiveSimple)), rep("Decreased Host Overlap", times=length(pphResourceBreakPointForLambdaSimple)), rep("Decreased Host Overlap", times=length(pphResourceBreakPointForMuNegativeSimple))),
                       pointShape=c(rep(bShape, times=length(pphResourceBreakPointForB)), rep(dShape, times=length(pphResourceBreakPointForD)), rep(KcarryCapShape, times=length(pphResourceBreakPointForKcarryCapSimple)), rep(AlphaShape, times=length(pphResourceBreakPointForAlpha)), rep(MuPositiveShape, times=length(pphResourceBreakPointForMuPositiveSimple)), rep(LambdaShape, times=length(pphResourceBreakPointForLambdaSimple)), rep(MuNegativeShape, times=length(pphResourceBreakPointForMuNegativeSimple)))
                       )

#Creating dataframes for Regression Predictions of hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #predictedLMPoints = predicted amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #pairedForagingResourcePoints = predicted amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

hostRegressionData <- data.frame(predictedLMPoints=c(hostBirthLMPoints, hostDeathLMPoints, hostCarryingCapacityLMPoints, hostMuPositiveLMPoints, hostLambdaLMPoints, hostMuNegativeLMPoints),
                                 pairedForagingResourcePoints=c(hostBirthLMPointsPair, hostDeathLMPointsPair, hostCarryingCapacityLMPointsPair, hostMuPositiveLMPointsPair, hostLambdaLMPointsPair, hostMuNegativeLMPointsPair),
                                 NNP=c(rep("Increased Host Overlap", times=length(hostBirthLMPoints)), rep("Decreased Host Overlap", times=length(hostDeathLMPoints)), rep("Increased Host Overlap", times=length(hostCarryingCapacityLMPoints)), rep("Increased Host Overlap", times=length(hostMuPositiveLMPoints)), rep("Decreased Host Overlap", times=length(hostLambdaLMPoints)), rep("Decreased Host Overlap", times=length(hostMuNegativeLMPoints))),
                                 nonForagingParameter=c(rep("Host Birth Rate", times=length(hostBirthLMPoints)), rep("Host Natural Mortality", times=length(hostDeathLMPoints)), rep("Host Carrying Capacity", times=length(hostCarryingCapacityLMPoints)), rep("Parasite Mortality+", times=length(hostMuPositiveLMPoints)), rep("Parasite Egg Production", times=length(hostLambdaLMPoints)), rep("Parasite Mortality-", times=length(hostMuNegativeLMPoints))),
                                 pointShape=c(rep(bShape, times=length(hostBirthLMPoints)), rep(dShape, times=length(hostDeathLMPoints)), rep(KcarryCapShape, times=length(hostCarryingCapacityLMPoints)), rep(MuPositiveShape, times=length(hostMuPositiveLMPoints)), rep(LambdaShape, times=length(hostLambdaLMPoints)), rep(MuNegativeShape, times=length(hostMuNegativeLMPoints)))
                                 )

pphRegressionData <- data.frame(predictedLMPoints=c(pphBirthLMPoints, pphDeathLMPoints, pphCarryingCapacityLMPoints, pphParasiteVirulenceLMPoints, pphMuPositiveLMPoints, pphLambdaLMPoints, pphMuNegativeLMPoints),
                                 pairedForagingResourcePoints=c(pphBirthLMPointsPair, pphDeathLMPointsPair, pphCarryingCapacityLMPointsPair, pphParasiteVirulenceLMPointsPair, pphMuPositiveLMPointsPair, pphLambdaLMPointsPair, pphMuNegativeLMPointsPair),
                                NNP=c(rep("Decreased Host Overlap", times=length(pphBirthLMPoints)), rep("Decreased Host Overlap", times=length(pphDeathLMPoints)), rep("Decreased Host Overlap", times=length(pphCarryingCapacityLMPoints)), rep("Decreased Host Overlap", times=length(pphParasiteVirulenceLMPoints)), rep("Increased Host Overlap", times=length(pphMuPositiveLMPoints)), rep("Decreased Host Overlap", times=length(pphLambdaLMPoints)), rep("Decreased Host Overlap", times=length(pphMuNegativeLMPoints))),
                                nonForagingParameter=c(rep("Host Birth Rate", times=length(pphBirthLMPoints)), rep("Host Natural Mortality", times=length(pphDeathLMPoints)), rep("Host Carrying Capacity", times=length(pphCarryingCapacityLMPoints)), rep("Parasite Virulence", times=length(pphParasiteVirulenceLMPoints)), rep("Parasite Mortality+", times=length(pphMuPositiveLMPoints)), rep("Parasite Egg Production", times=length(pphLambdaLMPoints)), rep("Parasite Mortality-", times=length(pphMuNegativeLMPoints))),
                                pointShape=c(rep(bShape, times=length(pphBirthLMPoints)), rep(dShape, times=length(pphDeathLMPoints)), rep(KcarryCapShape, times=length(pphCarryingCapacityLMPoints)), rep(AlphaShape, times=length(pphParasiteVirulenceLMPoints)), rep(MuPositiveShape, times=length(pphMuPositiveLMPoints)), rep(LambdaShape, times=length(pphLambdaLMPoints)), rep(MuNegativeShape, times=length(pphMuNegativeLMPoints)))
                                 )

#Creating dataframes for Regression End Points of hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #predictedNonForagingEndPoints = predicted amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #pairedForagingEndPoints = predicted amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

hostRegressionEndPoints <- data.frame(predictedNonForagingEndPoints=c(hostBirthLMEndPoint, hostDeathLMEndPoint, hostCarryingCapacityLMEndPoint, hostMuPositiveLMEndPoint, hostLambdaLMEndPoint, hostMuNegativeLMEndPoint), #NONFORAGING RESOURCES (y-axis)
                                      pairedForagingEndPoints=c(hostBirthLMEndPointPair, hostDeathLMEndPointPair, hostCarryingCapacityLMEndPointPair, hostMuPositiveLMEndPointPair, hostLambdaLMEndPointPair, hostMuNegativeLMEndPointPair), #FORAGING RESOURCES (x-axis)
                                      nonForagingParameter=c("Host Birth Rate", "Host Natural Mortality", "Host Carrying Capacity", "Parasite Mortality+", "Parasite Egg Production", "Parasite Mortality-"),
                                      NNP=c("Increased Host Overlap", "Decreased Host Overlap", "Increased Host Overlap",  "Increased Host Overlap", "Decreased Host Overlap", "Decreased Host Overlap"),
                                      pointShape=c(bShape, dShape, KcarryCapShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                                      )

pphRegressionEndPoints <- data.frame(predictedNonForagingEndPoints=c(pphBirthLMEndPoint, pphDeathLMEndPoint, pphCarryingCapacityLMEndPoint, pphParasiteVirulenceLMEndPoint, pphMuPositiveLMEndPoint, pphLambdaLMEndPoint, pphMuNegativeLMEndPoint), #NONFORAGING RESOURCES (y-axis)
                                      pairedForagingEndPoints=c(pphBirthLMEndPointPair, pphDeathLMEndPointPair, pphCarryingCapacityLMEndPointPair, pphParasiteVirulenceLMEndPointPair, pphMuPositiveLMEndPointPair, pphLambdaLMEndPointPair, pphMuNegativeLMEndPointPair), #FORAGING RESOURCES (x-axis)
                                      nonForagingParameter=c("Host Birth Rate", "Host Natural Mortality", "Host Carrying Capacity", "Parasite Virulence", "Parasite Mortality+", "Parasite Egg Production", "Parasite Mortality-"),
                                     NNP=c("Decreased Host Overlap", "Decreased Host Overlap", "Decreased Host Overlap", "Decreased Host Overlap", "Increased Host Overlap", "Decreased Host Overlap", "Decreased Host Overlap"),
                                     pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                                     ) 

#Subsetting our data to graph 2x2 panels
hostDataPositive <- subset.data.frame(hostDataAll, NNP=="Increased Host Overlap", select=TRUE)
hostDataPositiveB <- subset.data.frame(hostDataAll, (NNP=="Increased Host Overlap" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostDataPositiveCarryingCapacity <- subset.data.frame(hostDataAll, (NNP=="Increased Host Overlap" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostDataPositiveParasiteMortalityPositive <- subset.data.frame(hostDataAll, (NNP=="Increased Host Overlap" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

hostDataNegative <- subset.data.frame(hostDataAll, NNP=="Decreased Host Overlap", select=TRUE)
hostDataNegativeD <- subset.data.frame(hostDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostDataNegativeEggProduction <- subset.data.frame(hostDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
hostDataNegativeParasiteMortalityNegative <- subset.data.frame(hostDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphDataPositive <- subset.data.frame(pphDataAll, NNP=="Increased Host Overlap", select=TRUE)
pphDataPositiveParasiteMortalityPositive <- subset.data.frame(pphDataAll, (NNP=="Increased Host Overlap" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphDataNegative <- subset.data.frame(pphDataAll, NNP=="Decreased Host Overlap", select=TRUE)
pphDataNegativeB <- subset.data.frame(pphDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphDataNegativeD <- subset.data.frame(pphDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphDataNegativeCarryingCapacity <- subset.data.frame(pphDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphDataNegativeParasiteVirulence <- subset.data.frame(pphDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphDataNegativeEggProduction <- subset.data.frame(pphDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphDataNegativeParasiteMortalityNegative <- subset.data.frame(pphDataAll, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

hostRegressionDataPositive <- subset.data.frame(hostRegressionData, NNP=="Increased Host Overlap", select=TRUE)
hostRegressionDataPositiveB <- subset.data.frame(hostRegressionData, (NNP=="Increased Host Overlap" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostRegressionDataPositiveCarryingCapacity <- subset.data.frame(hostRegressionData, (NNP=="Increased Host Overlap" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostRegressionDataPositiveParasiteMortalityPositive <- subset.data.frame(hostRegressionData, (NNP=="Increased Host Overlap" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

hostRegressionDataNegative <- subset.data.frame(hostRegressionData, NNP=="Decreased Host Overlap", select=TRUE)
hostRegressionDataNegativeD <- subset.data.frame(hostRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostRegressionDataNegativeEggProduction <- subset.data.frame(hostRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
hostRegressionDataNegativeParasiteMortalityNegative <- subset.data.frame(hostRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphRegressionDataPositive <- subset.data.frame(pphRegressionData, NNP=="Increased Host Overlap", select=TRUE)
pphRegressionDataPositiveParasiteMortalityPositive <- subset.data.frame(pphRegressionData, (NNP=="Increased Host Overlap" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphRegressionDataNegative <- subset.data.frame(pphRegressionData, NNP=="Decreased Host Overlap", select=TRUE)
pphRegressionDataNegativeB <- subset.data.frame(pphRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphRegressionDataNegativeD <- subset.data.frame(pphRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphRegressionDataNegativeCarryingCapacity <- subset.data.frame(pphRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphRegressionDataNegativeParasiteVirulence <- subset.data.frame(pphRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphRegressionDataNegativeEggProduction <- subset.data.frame(pphRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphRegressionDataNegativeParasiteMortalityNegative <- subset.data.frame(pphRegressionData, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

hostRegressionEndPointsPositive <- subset.data.frame(hostRegressionEndPoints, NNP=="Increased Host Overlap", select=TRUE)
hostRegressionEndPointsPositiveB <- subset.data.frame(hostRegressionEndPoints, (NNP=="Increased Host Overlap" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostRegressionEndPointsPositiveCarryingCapacity <- subset.data.frame(hostRegressionEndPoints, (NNP=="Increased Host Overlap" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostRegressionEndPointsPositiveParasiteMortalityPositive <- subset.data.frame(hostRegressionEndPoints, (NNP=="Increased Host Overlap" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

hostRegressionEndPointsNegative <- subset.data.frame(hostRegressionEndPoints, NNP=="Decreased Host Overlap", select=TRUE)
hostRegressionEndPointsNegativeD <- subset.data.frame(hostRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostRegressionEndPointsNegativeEggProduction <- subset.data.frame(hostRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
hostRegressionEndPointsNegativeParasiteMortalityNegative <- subset.data.frame(hostRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphRegressionEndPointsPositive <- subset.data.frame(pphRegressionEndPoints, NNP=="Increased Host Overlap", select=TRUE)
pphRegressionEndPointsPositiveParasiteMortalityPositive <- subset.data.frame(pphRegressionEndPoints, (NNP=="Increased Host Overlap" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphRegressionEndPointsNegative <- subset.data.frame(pphRegressionEndPoints, NNP=="Decreased Host Overlap", select=TRUE)
pphRegressionEndPointsNegativeB <- subset.data.frame(pphRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphRegressionEndPointsNegativeD <- subset.data.frame(pphRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphRegressionEndPointsNegativeCarryingCapacity <- subset.data.frame(pphRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphRegressionEndPointsNegativeParasiteVirulence <- subset.data.frame(pphRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphRegressionEndPointsNegativeEggProduction <- subset.data.frame(pphRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphRegressionEndPointsNegativeParasiteMortalityNegative <- subset.data.frame(pphRegressionEndPoints, (NNP=="Decreased Host Overlap" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

#Creating dataset for legend
legendDataframe <- data.frame(xValue=c(1, 2, 3, 4, 5, 6, 7),
                              yValue=c(1, 2, 3, 4, 5, 6, 7),
                              nonForagingParameter=c("Host Birth Rate, b", "Host Natural Mortality, d", "Host Carrying Capacity, Hmax", "Parasite Virulence, \U1D6FC", "Parasite Mortality+, \U1D6CD+", "Parasite Egg Production, \U1D6CC", "Parasite Mortality-, \U1D6CD-"),
                              NNP=c("Decreased Host Overlap", "Increased Host Overlap", "Decreased Host Overlap", "Decreased Host Overlap", "Increased Host Overlap", "Increased Host Overlap", "Increased Host Overlap"),
                              pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                              )

legendDataframeFull <- data.frame(xValue=c(1, 2, 3, 4, 5, 6, 7),
                              yValue=c(1, 2, 3, 4, 5, 6, 7),
                              nonForagingParameter=c("Host Birth Rate, b", "Host Natural Mortality, d", "Host Carrying Capacity, Hmax", "Parasite Virulence, \U1D6FC", "Parasite Mortality+, \U1D6CD+", "Parasite Egg Production, \U1D6CC", "Parasite Mortality-, \U1D6CD-"),
                              NNP=c("Beta+k+", "Beta+k-", "Beta-k+", "Beta-k-", "Beta+k+", "Beta+k-", "Beta-k+"),
                              pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                              )

```

```{r - Graphing - Model Outputs with linear and cubic regressions}
hostBreakpointsNegative <- ggplot() +
  #Regression lines
  stat_smooth(data=hostDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
geom_line(data=hostRegressionDataNegativeEggProduction, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightcoral", size=1.2) + 
  stat_smooth(data=hostDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  #Model outputs as points
  geom_point(data=hostDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNegativeD$pointShape, size=1.2) + 
  geom_point(data=hostDataNegativeEggProduction, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNegativeEggProduction$pointShape, size=1.2) + 
  geom_point(data=hostDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNegativeParasiteMortalityNegative$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsNegativeD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNegativeD$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsNegativeEggProduction, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNegativeEggProduction$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsNegativeParasiteMortalityNegative, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNegativeParasiteMortalityNegative$pointShape, size=3) + 
  annotate("text", x=1.10, y=4.85, label="d", size=5) +
  annotate("text", x=hostRegressionEndPointsNegativeEggProduction$pairedForagingEndPoints, y=hostRegressionEndPointsNegativeEggProduction$predictedNonForagingEndPoints+0.225, label=expression(lambda), size=5) + #lambda [NOTE: Need to -0.1 to y-axis to avoid overlapping with points]
  annotate("text", x=1.5, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "", 
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  ggtitle(expression(bold("Host Population (H)"))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=0.75, y=10, label="A", size=5)
  #annotate("text", x=3.4, y=0.95, label="A: Decreased Host Overlap", size=5)

hostBreakpointsPositive <- ggplot() +
  #Regression lines
  geom_line(data=hostRegressionDataPositiveB, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightblue", size=1.2) + 
  stat_smooth(data=hostDataPositiveCarryingCapacity, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightblue", se=FALSE, fullrange=TRUE) + 
  geom_line(data=hostRegressionDataPositiveParasiteMortalityPositive, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightblue", size=1.2) + 
  #Model outputs as points
  geom_point(data=hostDataPositiveB, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataPositiveB$pointShape, size=1.2) + 
  geom_point(data=hostDataPositiveCarryingCapacity, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataPositiveCarryingCapacity$pointShape, size=1.2) + 
  geom_point(data=hostDataPositiveParasiteMortalityPositive, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataPositiveParasiteMortalityPositive$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsPositiveB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsPositiveB$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsPositiveCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsPositiveCarryingCapacity$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsPositiveParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsPositiveParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=hostRegressionEndPointsPositiveB$pairedForagingEndPoints+0.05, y=hostRegressionEndPointsPositiveB$predictedNonForagingEndPoints, label="b", size=5) + #b [NOTE: Need to +0.1 to x-axis and -0.1 to y-axis to avoid overlapping with points]
  annotate("text", x=1.3, y=4.99, label="Hmax", size=5) + #Hmax
  annotate("text", x=hostRegressionEndPointsPositiveParasiteMortalityPositive$pairedForagingEndPoints+0.075,            
y=hostRegressionEndPointsPositiveParasiteMortalityPositive$predictedNonForagingEndPoints, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
    labs(x = expression(atop(bold("Resource Effect on"), bold(paste("Foraging Parameters  ", "(", rho[f], ")")))),
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  annotate("text", x=0.75, y=10, label="C", size=5)
  #annotate("text", x=3.45, y=0.95, label="B: Increased Host Overlap", size=5)
  
pphBreakpointsNegative <- ggplot() +
  #Regression lines
  stat_smooth(data=pphDataNegativeB, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=pphDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=FALSE) + 
  geom_line(data=pphRegressionDataNegativeCarryingCapacity, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightcoral", size=1.2) +
  stat_smooth(data=pphDataNegativeParasiteVirulence, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  geom_line(data=pphRegressionDataNegativeEggProduction, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightcoral", size=1.2) + 
  stat_smooth(data=pphDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  #Model outputs as points
  geom_point(data=pphDataNegativeB, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeB$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeD$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeCarryingCapacity, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeCarryingCapacity$pointShape, size=1.2) +  
  geom_point(data=pphDataNegativeParasiteVirulence, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeParasiteVirulence$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeEggProduction, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeEggProduction$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeParasiteMortalityNegative$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=pphRegressionEndPointsNegativeB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeB$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNegativeD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeD$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNegativeCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeCarryingCapacity$pointShape, size=3) +   
  #geom_point(data=pphRegressionEndPointsNegativeParasiteVirulence, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeParasiteVirulence$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNegativeEggProduction, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeEggProduction$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNegativeParasiteMortalityNegative, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeParasiteMortalityNegative$pointShape, size=3) + 
  annotate("text", x=1.225, y=4.6, label="b", size=5) + #b
  annotate("text", x=1.33, y=4.625, label="d", size=5) + #d
  annotate("text", x=pphRegressionEndPointsNegativeCarryingCapacity$pairedForagingEndPoints-0.1, y=pphRegressionEndPointsNegativeCarryingCapacity$predictedNonForagingEndPoints+0.225, label="Hmax", size=5) + #Hmax [NOTE: Need the -0.1 to x-axis to keep on graph and +0.7 to y-axis since it overlaps with lambda]
  annotate("text", x=1.425, y=4.625, label=expression(alpha), size=5) + #alpha
  annotate("text", x=pphRegressionEndPointsNegativeEggProduction$pairedForagingEndPoints, y=pphRegressionEndPointsNegativeEggProduction$predictedNonForagingEndPoints-0.2, label=expression(lambda), size=5) + #lambda [NOTE: Need to +0.1 to y-axis to avoid overlapping with points]
    annotate("text", x=1.5, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "", 
       y = "") +
  ggtitle(expression(bold("Parasite Abundance (P/H)"))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=0.75, y=10, label="B", size=5)
  #annotate("text", x=3.4, y=0.95, label="C: Decreased Host Overlap", size=5)
  
pphBreakpointsPositive <- ggplot() +
  #Regression lines
  geom_line(data=pphRegressionDataPositiveParasiteMortalityPositive, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightblue", size=1.2) + 
  #Model outputs as points
  geom_point(data=pphDataPositiveParasiteMortalityPositive, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataPositiveParasiteMortalityPositive$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
    #geom_point(data=pphRegressionEndPointsPositiveParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsPositiveParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=pphRegressionEndPointsPositiveParasiteMortalityPositive$pairedForagingEndPoints+0.1, y=pphRegressionEndPointsPositiveParasiteMortalityPositive$predictedNonForagingEndPoints, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +                      #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                                      #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = expression(atop(bold("Resource Effect on"), bold(paste("Foraging Parameters  ", "(", rho[f], ")")))),
       y = "") +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points  
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  annotate("text", x=0.75, y=10, label="D", size=5)
  #annotate("text", x=3.45, y=0.95, label="D: Increased Host Overlap", size=5)

#Old Legend Graph
#fakeGraphForLegend <- ggplot() +
#  geom_line(data=legendDataframe, aes(x=xValue, y=yValue, group=nonForagingParameter, color=NNP), size=1.2) +        
#  geom_point(data=legendDataframe, aes(x=xValue, y=yValue, shape=nonForagingParameter), size=3) +  #, position=position_dodge(width=0.05)
#  scale_shape_manual(values=c(bShape, KcarryCapShape, dShape, LambdaShape, MuNegativeShape, MuPositiveShape, AlphaShape)) + #THIS IS BAD PRACTICE! Breaks graph, but fixes #legend which is all we care about in this fake graph
#  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
#  guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
#  guides(color = guide_legend(override.aes = list(size = 2))) +
#  guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
#  guides(shape = guide_legend(title="Non-Foraging Parameters")) #Changes title of legend for shape of points  


fakeGraphForLegendLines <- ggplot() +
  geom_line(data=legendDataframe, aes(x=xValue, y=yValue, group=nonForagingParameter, color=NNP), size=1.2) +    
  scale_color_manual(values=c("lightcoral", "lightblue"),
                     labels=c("Decreased Parasite Encounter & Increased Heterogeneity (\U03B2-, k-)", "Increased Parasite Encounter & Decreased Heterogeneity (\U03B2+, k+)")) +
  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
  guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  guides(color = guide_legend(override.aes = list(size = 2))) +
  guides(color = guide_legend(title="Effect of Resources on Infection Parameters")) #Changes title of legend for line color

fakeGraphForLegendPoints <- ggplot() +
  geom_point(data=legendDataframe, aes(x=xValue, y=yValue, shape=nonForagingParameter), size=3) +  #, position=position_dodge(width=0.05)
  scale_shape_manual(values=c(bShape, KcarryCapShape, dShape, LambdaShape, MuNegativeShape, MuPositiveShape, AlphaShape),
                     labels=c("Host Birth Rate, b", "Host Carrying Capacity, Hmax", "Host Natural Mortality, d", "Parasite Egg Production, \U03BB", "Adult Parasite Mortality, \U03BC-", "Adult Parasite Mortality, \U03BC+", "Parasite Virulence, \U03B1")) + #THIS IS BAD PRACTICE! Breaks graph, but fixes legend which is all we care about in this fake graph
  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
  guides(shape = guide_legend(title="Non-Foraging Parameters")) #Changes title of legend for shape of points  

legendGraphForLines <- cowplot::get_legend(fakeGraphForLegendLines)
legendGraphForPoints <- cowplot::get_legend(fakeGraphForLegendPoints)

#Visualization choices Export as 800x1000
plot_grid(hostBreakpointsNegative, pphBreakpointsNegative, hostBreakpointsPositive, pphBreakpointsPositive, ncol=2, nrow=2)
plot_grid(hostBreakpointsNegative, pphBreakpointsNegative, hostBreakpointsPositive, pphBreakpointsPositive, legendGraphForPoints, legendGraphForLines, ncol=2, nrow=3)
```

```{r - Model -  DETER + Berding MONTHLY - Logistic Growth - Finding resource breakpoints for when each NON-FORAGING parameter undoes the effects of NUTRITION/STRESS parameters on Hosts/Parasites per Host BUT we are varying BOTH resource effects}
#b, d, beta, lambda, mu, gamma, KcarryCap and k from Deter 2008
#Alpha from Berding 1987

#Creating empty vectors
equilibriumH_Baseline <- c()
equilibriumP_Baseline <- c()
tmpBaseline <- c()

#Creating Breakpoint Vectors
hostResourceBreakPointForB_StrNut <- c()
pphResourceBreakPointForB_StrNut <- c()
hostResourceBreakPointForD_StrNut <- c()
pphResourceBreakPointForD_StrNut <- c()
hostResourceBreakPointForKcarryCap_StrNut <- c()
pphResourceBreakPointForKcarryCap_StrNut <- c()
hostResourceBreakPointForAlpha_StrNut <- c()           #Alpha (virulence) is incapable of overcoming resource effect
pphResourceBreakPointForAlpha_StrNut <- c()
hostResourceBreakPointForMuPositive_StrNut <- c()
pphResourceBreakPointForMuPositive_StrNut <- c()
hostResourceBreakPointForLambda_StrNut <- c()
pphResourceBreakPointForLambda_StrNut <- c()
hostResourceBreakPointForMuNegative_StrNut <- c()
pphResourceBreakPointForMuNegative_StrNut <- c()

#Creating ForagingResource Vectors (mostly just for organization)
hostForagingResourceForB_StrNut <- c()
pphForagingResourceForB_StrNut <- c()
hostForagingResourceForD_StrNut <- c()
pphForagingResourceForD_StrNut <- c()
hostForagingResourceForKcarryCap_StrNut <- c()
pphForagingResourceForKcarryCap_StrNut <- c()
hostForagingResourceForAlpha_StrNut <- c()
pphForagingResourceForAlpha_StrNut <- c()
hostForagingResourceForMuPositive_StrNut <- c()
pphForagingResourceForMuPositive_StrNut <- c()
hostForagingResourceForLambda_StrNut <- c()
pphForagingResourceForLambda_StrNut <- c()
hostForagingResourceForMuNegative_StrNut <- c()
pphForagingResourceForMuNegative_StrNut <- c()

#Baseline Scenario for Comparisons
b=b0
d=d0
alpha=alpha0
beta=beta0
lambda=lambda0
gamma=gamma0
mu=mu0
k=k0
KcarryCap = KcarryCap0
#Creating parameters & running model
params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
tmpBaseline <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
equilibriumH_Baseline[length(equilibriumH_Baseline)+1] <- tmpBaseline$H[length(tmpBaseline$H)]
equilibriumP_Baseline[length(equilibriumP_Baseline)+1] <- tmpBaseline$P[length(tmpBaseline$P)]


for (j in 1:length(foragingResource)){
  #Creating empty vectors (must be reset each time we select a new foragingResource level)
  equilibriumH_StressB <- c()
  equilibriumP_StressB <- c()
  tmpStressB <- c()
  equilibriumNonForagingResource_StressB <- c()
  equilibriumForagingResource_StressB <- c()
  equilibriumH_NutritionB <- c()
  equilibriumP_NutritionB <- c()
  tmpNutritionB <- c()
  equilibriumNonForagingResource_NutritionB <- c()
  equilibriumForagingResource_NutritionB <- c()
  
  equilibriumH_NutritionD <- c()
  equilibriumP_NutritionD <- c()
  tmpNutritionD <- c()
  equilibriumNonForagingResource_NutritionD <- c()
  equilibriumForagingResource_NutritionD <- c()
  
  equilibriumH_StressKcarryCap <- c()
  equilibriumP_StressKcarryCap <- c()
  tmpStressKcarryCap <- c()
  equilibriumNonForagingResource_StressKcarryCap <- c()
  equilibriumForagingResource_StressKcarryCap <- c()
  equilibriumH_NutritionKcarryCap <- c()
  equilibriumP_NutritionKcarryCap <- c()
  tmpNutritionKcarryCap <- c()
  equilibriumNonForagingResource_NutritionKcarryCap <- c()
  equilibriumForagingResource_NutritionKcarryCap <- c()
  
  equilibriumH_NutritionAlpha <- c()
  equilibriumP_NutritionAlpha <- c()
  tmpNutritionAlpha <- c()
  equilibriumNonForagingResource_NutritionAlpha <- c()
  equilibriumForagingResource_NutritionAlpha <- c()
  
  equilibriumH_StressMuPositive <- c()
  equilibriumP_StressMuPositive <- c()
  tmpStressMuPositive <- c()
  equilibriumNonForagingResource_StressMuPositive <- c()
  equilibriumForagingResource_StressMuPositive <- c()
  
  equilibriumH_NutritionLambda <- c()
  equilibriumP_NutritionLambda <- c()
  tmpNutritionLambda <- c()
  equilibriumNonForagingResource_NutritionLambda <- c()
  equilibriumForagingResource_NutritionLambda <- c()
  
  equilibriumH_NutritionMuNegative <- c()
  equilibriumP_NutritionMuNegative <- c()
  tmpNutritionMuNegative <- c()
  equilibriumNonForagingResource_NutritionMuNegative <- c()
  equilibriumForagingResource_NutritionMuNegative <- c()
  
  #Creating "finder" variables (must be reset each time we select a new foragingResource level)
  hostFirstB_StrNut <- TRUE
  pphFirstB_StrNut <- TRUE
  hostFirstD_StrNut <- TRUE
  pphFirstD_StrNut <- TRUE
  hostFirstKcarryCap_StrNut <- TRUE
  pphFirstKcarryCap_StrNut <- TRUE
  hostFirstAlpha_StrNut <- TRUE
  pphFirstAlpha_StrNut <- TRUE
  hostFirstMuPositive_StrNut <- TRUE
  pphFirstMuPositive_StrNut <- TRUE
  hostFirstLambda_StrNut <- TRUE
  pphFirstLambda_StrNut <- TRUE
  hostFirstMuNegative_StrNut <- TRUE
  pphFirstMuNegative_StrNut <- TRUE

  
  for (i in 1:length(resource)){ #This will go through the loop for the length of the resource variable
    xstart <- c(H=69, P=1) #Resets the initial parameter values

#[NOTE: This only works when the DIRECTIONALITY of FORAGING and NON-FORAGING PARAMETERS are OPPOSITE]
#Allowing resources to effect non-foraging paramaters (b, d, and KcarryCap) improves the host population [Look at the % Change Effect of baseline]
#Therefore we must select the Resource Effect on Foraging parameters that has the OPPOSITE EFFECT
#There is a POSITIVE effect of resources on Foraging Parameters (beta & k) which is WORSE FOR HOSTS

    #Stress effect of Resources (beta+ k-) with Positive effect (b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as dataframe
    tmpStressB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params)) 
    #Save equilibrium values from temporary dataframe into vectors
    equilibriumH_StressB[length(equilibriumH_StressB)+1] <- tmpStressB$H[length(tmpStressB$H)]
    equilibriumP_StressB[length(equilibriumP_StressB)+1] <- tmpStressB$P[length(tmpStressB$P)]
    equilibriumForagingResource_StressB[length(equilibriumForagingResource_StressB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_StressB[length(equilibriumNonForagingResource_StressB)+1] <- resource[i]
    
    #Nutrition effect of Resources (beta- & k+) and positive effect (b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as datframe
    tmpNutritionB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionB[length(equilibriumH_NutritionB)+1] <- tmpNutritionB$H[length(tmpNutritionB$H)]
    equilibriumP_NutritionB[length(equilibriumP_NutritionB)+1] <- tmpNutritionB$P[length(tmpNutritionB$P)]
    equilibriumForagingResource_NutritionB[length(equilibriumForagingResource_NutritionB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionB[length(equilibriumNonForagingResource_NutritionB)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForB <- (equilibriumH_StressB[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForB <- (equilibriumH_StressB[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
      
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionB[1]/equilibriumH_NutritionB[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionB[i]/equilibriumH_NutritionB[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForB <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForB <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstB_StrNut==TRUE & (sign(hostOriginalPctChangeForB)==-1 & hostCurrentPctChangeForB>0)){
      hostFirstB_StrNut <- FALSE
      hostResourceBreakPointForB_StrNut <- append(hostResourceBreakPointForB_StrNut, resource[i])
      hostForagingResourceForB_StrNut <- append(hostForagingResourceForB_StrNut, foragingResource[j])
    } else if (hostFirstB_StrNut==TRUE & (sign(hostOriginalPctChangeForB)==1 & hostCurrentPctChangeForB<0)){
      hostFirstB_StrNut <- FALSE
      hostResourceBreakPointForB_StrNut <- append(hostResourceBreakPointForB_StrNut, resource[i])      
      hostForagingResourceForB_StrNut <- append(hostForagingResourceForB_StrNut, foragingResource[j])
    } else {
      hostResourceBreakPointForB_StrNut <- hostResourceBreakPointForB_StrNut
      hostForagingResourceForB_StrNut <- hostForagingResourceForB_StrNut
    }
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstB_StrNut==TRUE & (sign(pphOriginalPctChangeForB)==-1 & pphCurrentPctChangeForB>0)){
      pphFirstB_StrNut <- FALSE
      pphResourceBreakPointForB_StrNut <- append(pphResourceBreakPointForB_StrNut, resource[i])
      pphForagingResourceForB_StrNut <- append(pphForagingResourceForB_StrNut, foragingResource[j])
    } else if (pphFirstB_StrNut==TRUE & (sign(pphOriginalPctChangeForB)==1 & pphCurrentPctChangeForB<0)){
      pphFirstB_StrNut <- FALSE
      pphResourceBreakPointForB_StrNut <- append(pphResourceBreakPointForB_StrNut, resource[i])
      pphForagingResourceForB_StrNut <- append(pphForagingResourceForB_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForB_StrNut <- pphResourceBreakPointForB_StrNut
      pphForagingResourceForB_StrNut <- pphForagingResourceForB_StrNut

    }
        
    #########################################################################################################################################
    
    #Nutrition effect of Resources (beta- & k+) and negative effect of d 
    b=b0
    d=dr[i]
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionD <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionD[length(equilibriumH_NutritionD)+1] <- tmpNutritionD$H[length(tmpNutritionD$H)]
    equilibriumP_NutritionD[length(equilibriumP_NutritionD)+1] <- tmpNutritionD$P[length(tmpNutritionD$P)]
    equilibriumForagingResource_NutritionD[length(equilibriumForagingResource_NutritionD)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionD[length(equilibriumNonForagingResource_NutritionD)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForD <- (equilibriumH_NutritionD[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForD <- (equilibriumH_NutritionD[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionD[1]/equilibriumH_NutritionD[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionD[i]/equilibriumH_NutritionD[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForD <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForD <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstD_StrNut==TRUE & (sign(hostOriginalPctChangeForD)==-1 & hostCurrentPctChangeForD>0)){
      hostFirstD_StrNut <- FALSE
      hostResourceBreakPointForD_StrNut <- append(hostResourceBreakPointForD_StrNut, resource[i])
      hostForagingResourceForD_StrNut <- append(hostForagingResourceForD_StrNut, foragingResource[j])
      } else if (hostFirstD_StrNut==TRUE & (sign(hostOriginalPctChangeForD)==1 & hostCurrentPctChangeForD<0)){
      hostFirstD_StrNut <- FALSE
      hostResourceBreakPointForD_StrNut <- append(hostResourceBreakPointForD_StrNut, resource[i])
      hostForagingResourceForD_StrNut <- append(hostForagingResourceForD_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForD_StrNut <- hostResourceBreakPointForD_StrNut
      hostForagingResourceForD_StrNut <- hostForagingResourceForD_StrNut
    }
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstD_StrNut==TRUE & (sign(pphOriginalPctChangeForD)==-1 & pphCurrentPctChangeForD>0)){
      pphFirstD_StrNut <- FALSE
      pphResourceBreakPointForD_StrNut <- append(pphResourceBreakPointForD_StrNut, resource[i])
      pphForagingResourceForD_StrNut <- append(pphForagingResourceForD_StrNut, foragingResource[j])
      } else if (pphFirstD_StrNut==TRUE & (sign(pphOriginalPctChangeForD)==1 & pphCurrentPctChangeForD<0)){
      pphFirstD_StrNut <- FALSE
      pphResourceBreakPointForD_StrNut <- append(pphResourceBreakPointForD_StrNut, resource[i])
      pphForagingResourceForD_StrNut <- append(pphForagingResourceForD_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForD_StrNut <- pphResourceBreakPointForD_StrNut
      pphForagingResourceForD_StrNut <- pphForagingResourceForD_StrNut

    }
    
  #########################################################################################################################################
    
    #Stress effect of Resources (beta+ & k-) with positive effect of KcarryCap
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpStressKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_StressKcarryCap[length(equilibriumH_StressKcarryCap)+1] <- tmpStressKcarryCap$H[length(tmpStressKcarryCap$H)]
    equilibriumP_StressKcarryCap[length(equilibriumP_StressKcarryCap)+1] <- tmpStressKcarryCap$P[length(tmpStressKcarryCap$P)]
    equilibriumForagingResource_StressKcarryCap[length(equilibriumForagingResource_StressKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_StressKcarryCap[length(equilibriumNonForagingResource_StressKcarryCap)+1] <- resource[i]
    
    #Nutrition effect of Resources (beta+ & k-) with positive effect of KcarryCap
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionKcarryCap[length(equilibriumH_NutritionKcarryCap)+1] <- tmpNutritionKcarryCap$H[length(tmpNutritionKcarryCap$H)]
    equilibriumP_NutritionKcarryCap[length(equilibriumP_NutritionKcarryCap)+1] <- tmpNutritionKcarryCap$P[length(tmpNutritionKcarryCap$P)]
    equilibriumForagingResource_NutritionKcarryCap[length(equilibriumForagingResource_NutritionKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionKcarryCap[length(equilibriumNonForagingResource_NutritionKcarryCap)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForKcarryCap <- (equilibriumH_StressKcarryCap[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForKcarryCap <- (equilibriumH_StressKcarryCap[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    #NOTE: KcarryCap is incapable of counteracting the effects of Nutrition or Stress on Parasites per Host (they share directionality)
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionKcarryCap[1]/equilibriumH_NutritionKcarryCap[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionKcarryCap[i]/equilibriumH_NutritionKcarryCap[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForKcarryCap <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForKcarryCap <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    
    
    
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstKcarryCap_StrNut==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==-1 & hostCurrentPctChangeForKcarryCap>0)){
      hostFirstKcarryCap_StrNut <- FALSE
      hostResourceBreakPointForKcarryCap_StrNut <- append(hostResourceBreakPointForKcarryCap_StrNut, resource[i])
      hostForagingResourceForKcarryCap_StrNut <- append(hostForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else if (hostFirstKcarryCap_StrNut==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==1 & hostCurrentPctChangeForKcarryCap<0)){
      hostFirstKcarryCap_StrNut <- FALSE
      hostResourceBreakPointForKcarryCap_StrNut <- append(hostResourceBreakPointForKcarryCap_StrNut, resource[i])
      hostForagingResourceForKcarryCap_StrNut <- append(hostForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForKcarryCap_StrNut <- hostResourceBreakPointForKcarryCap_StrNut
      hostForagingResourceForKcarryCap_StrNut <- hostForagingResourceForKcarryCap_StrNut
      }
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstKcarryCap_StrNut==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==-1 & pphCurrentPctChangeForKcarryCap>0)){
      pphFirstKcarryCap_StrNut <- FALSE
      pphResourceBreakPointForKcarryCap_StrNut <- append(pphResourceBreakPointForKcarryCap_StrNut, resource[i])
      pphForagingResourceForKcarryCap_StrNut <- append(pphForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else if (pphFirstKcarryCap_StrNut==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==1 & pphCurrentPctChangeForKcarryCap<0)){
      pphFirstKcarryCap_StrNut <- FALSE
      pphResourceBreakPointForKcarryCap_StrNut <- append(pphResourceBreakPointForKcarryCap_StrNut, resource[i])
      pphForagingResourceForKcarryCap_StrNut <- append(pphForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForKcarryCap_StrNut <- pphResourceBreakPointForKcarryCap_StrNut
      pphForagingResourceForKcarryCap_StrNut <- pphForagingResourceForKcarryCap_StrNut
    }
    
  
  ########################################################################################################################################
    
    #Nutrition effect of Resources (beta- and k+) with negative effect of alpha
    b=b0
    d=d0
    alpha=alphar[i]
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionAlpha <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionAlpha[length(equilibriumH_NutritionAlpha)+1] <- tmpNutritionAlpha$H[length(tmpNutritionAlpha$H)]
    equilibriumP_NutritionAlpha[length(equilibriumP_NutritionAlpha)+1] <- tmpNutritionAlpha$P[length(tmpNutritionAlpha$P)]
    equilibriumForagingResource_NutritionAlpha[length(equilibriumForagingResource_NutritionAlpha)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionAlpha[length(equilibriumNonForagingResource_NutritionAlpha)+1] <- resource[i]
      
    #Checking percentage change
    hostOriginalPctChangeForAlpha <- (equilibriumH_NutritionAlpha[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForAlpha <- (equilibriumH_NutritionAlpha[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionAlpha[1]/equilibriumH_NutritionAlpha[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionAlpha[i]/equilibriumH_NutritionAlpha[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForAlpha <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForAlpha <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstAlpha_StrNut==TRUE & (sign(hostOriginalPctChangeForAlpha)==-1 & hostCurrentPctChangeForAlpha>0)){
      hostFirstAlpha_StrNut <- FALSE
      hostResourceBreakPointForAlpha_StrNut <- append(hostResourceBreakPointForAlpha_StrNut, resource[i])
      hostForagingResourceForAlpha_StrNut <- append(hostForagingResourceForAlpha_StrNut, foragingResource[j])
      } else if (hostFirstAlpha_StrNut==TRUE & (sign(hostOriginalPctChangeForAlpha)==1 & hostCurrentPctChangeForAlpha<0)){
      hostFirstAlpha_StrNut <- FALSE
      hostResourceBreakPointForAlpha_StrNut <- append(hostResourceBreakPointForAlpha_StrNut, resource[i])
      hostForagingResourceForAlpha_StrNut <- append(hostForagingResourceForAlpha_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForAlpha_StrNut <- hostResourceBreakPointForAlpha_StrNut
      hostForagingResourceForAlpha_StrNut <- hostForagingResourceForAlpha_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstAlpha_StrNut==TRUE & (sign(pphOriginalPctChangeForAlpha)==-1 & pphCurrentPctChangeForAlpha>0)){
      pphFirstAlpha_StrNut <- FALSE
      pphResourceBreakPointForAlpha_StrNut <- append(pphResourceBreakPointForAlpha_StrNut, resource[i])
      pphForagingResourceForAlpha_StrNut <- append(pphForagingResourceForAlpha_StrNut, foragingResource[j])
      } else if (pphFirstAlpha_StrNut==TRUE & (sign(pphOriginalPctChangeForAlpha)==1 & pphCurrentPctChangeForAlpha<0)){
      pphFirstAlpha_StrNut <- FALSE
      pphResourceBreakPointForAlpha_StrNut <- append(pphResourceBreakPointForAlpha_StrNut, resource[i])
      pphForagingResourceForAlpha_StrNut <- append(pphForagingResourceForAlpha_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForAlpha_StrNut <- pphResourceBreakPointForAlpha_StrNut
      pphForagingResourceForAlpha_StrNut <- pphForagingResourceForAlpha_StrNut
    }
    
  ########################################################################################################################################
  
    #Stress effect of Resources (beta+ and k-) with positive effect muPositive
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=murPositive[i]
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpStressMuPositive <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_StressMuPositive[length(equilibriumH_StressMuPositive)+1] <- tmpStressMuPositive$H[length(tmpStressMuPositive$H)]
    equilibriumP_StressMuPositive[length(equilibriumP_StressMuPositive)+1] <- tmpStressMuPositive$P[length(tmpStressMuPositive$P)]
    equilibriumForagingResource_StressMuPositive[length(equilibriumForagingResource_StressMuPositive)+1] <- foragingResource[j]
    equilibriumNonForagingResource_StressMuPositive[length(equilibriumNonForagingResource_StressMuPositive)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForMuPositive <- (equilibriumH_StressMuPositive[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuPositive <- (equilibriumH_StressMuPositive[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_StressMuPositive[1]/equilibriumH_StressMuPositive[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_StressMuPositive[i]/equilibriumH_StressMuPositive[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuPositive <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuPositive <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuPositive_StrNut==TRUE & (sign(hostOriginalPctChangeForMuPositive)==-1 & hostCurrentPctChangeForMuPositive>0)){
      hostFirstMuPositive_StrNut <- FALSE
      hostResourceBreakPointForMuPositive_StrNut <- append(hostResourceBreakPointForMuPositive_StrNut, resource[i])
      hostForagingResourceForMuPositive_StrNut <- append(hostForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else if (hostFirstMuPositive_StrNut==TRUE & (sign(hostOriginalPctChangeForMuPositive)==1 & hostCurrentPctChangeForMuPositive<0)){
      hostFirstMuPositive_StrNut <- FALSE
      hostResourceBreakPointForMuPositive_StrNut <- append(hostResourceBreakPointForMuPositive_StrNut, resource[i])
      hostForagingResourceForMuPositive_StrNut <- append(hostForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForMuPositive_StrNut <- hostResourceBreakPointForMuPositive_StrNut      
      hostForagingResourceForMuPositive_StrNut <- hostForagingResourceForMuPositive_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuPositive_StrNut==TRUE & (sign(pphOriginalPctChangeForMuPositive)==-1 & pphCurrentPctChangeForMuPositive>0)){
      pphFirstMuPositive_StrNut <- FALSE
      pphResourceBreakPointForMuPositive_StrNut <- append(pphResourceBreakPointForMuPositive_StrNut, resource[i])
      pphForagingResourceForMuPositive_StrNut <- append(pphForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else if (pphFirstMuPositive_StrNut==TRUE & (sign(pphOriginalPctChangeForMuPositive)==1 & pphCurrentPctChangeForMuPositive<0)){
      pphFirstMuPositive_StrNut <- FALSE
      pphResourceBreakPointForMuPositive_StrNut <- append(pphResourceBreakPointForMuPositive_StrNut, resource[i])
      pphForagingResourceForMuPositive_StrNut <- append(pphForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForMuPositive_StrNut <- pphResourceBreakPointForMuPositive_StrNut      
      pphForagingResourceForMuPositive_StrNut <- pphForagingResourceForMuPositive_StrNut
    }
    
  ########################################################################################################################################
    
    #NOTE: Lambda is incapable of counteracting the effects of Nutrition or Stress (they share directionality)
#Nutrition effect of Resources (beta- and k+) with negative effect of Lambda 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambdar[i]
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionLambda <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionLambda[length(equilibriumH_NutritionLambda)+1] <- tmpNutritionLambda$H[length(tmpNutritionLambda$H)]
    equilibriumP_NutritionLambda[length(equilibriumP_NutritionLambda)+1] <- tmpNutritionLambda$P[length(tmpNutritionLambda$P)]
    equilibriumForagingResource_NutritionLambda[length(equilibriumForagingResource_NutritionLambda)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionLambda[length(equilibriumNonForagingResource_NutritionLambda)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForLambda <- (equilibriumH_NutritionLambda[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForLambda <- (equilibriumH_NutritionLambda[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionLambda[1]/equilibriumH_NutritionLambda[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionLambda[i]/equilibriumH_NutritionLambda[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForLambda <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForLambda <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstLambda_StrNut==TRUE & (sign(hostOriginalPctChangeForLambda)== -1 & hostCurrentPctChangeForLambda>0)){
      hostFirstLambda_StrNut <- FALSE
      hostResourceBreakPointForLambda_StrNut <- append(hostResourceBreakPointForLambda_StrNut, resource[i])
      hostForagingResourceForLambda_StrNut <- append(hostForagingResourceForLambda_StrNut, foragingResource[j])
      } else if (hostFirstLambda_StrNut==TRUE & (sign(hostOriginalPctChangeForLambda)== 1 & hostCurrentPctChangeForLambda<0)){
      hostFirstLambda_StrNut <- FALSE
      hostResourceBreakPointForLambda_StrNut <- append(hostResourceBreakPointForLambda_StrNut, resource[i])
      hostForagingResourceForLambda_StrNut <- append(hostForagingResourceForLambda_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForLambda_StrNut <- hostResourceBreakPointForLambda_StrNut      
      hostForagingResourceForLambda_StrNut <- hostForagingResourceForLambda_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstLambda_StrNut==TRUE & (sign(pphOriginalPctChangeForLambda)== -1 & pphCurrentPctChangeForLambda>0)){
      pphFirstLambda_StrNut <- FALSE
      pphResourceBreakPointForLambda_StrNut <- append(pphResourceBreakPointForLambda_StrNut, resource[i])
      pphForagingResourceForLambda_StrNut <- append(pphForagingResourceForLambda_StrNut, foragingResource[j])
      } else if (pphFirstLambda_StrNut==TRUE & (sign(pphOriginalPctChangeForLambda)== 1 & pphCurrentPctChangeForLambda<0)){
      pphFirstLambda_StrNut <- FALSE
      pphResourceBreakPointForLambda_StrNut <- append(pphResourceBreakPointForLambda_StrNut, resource[i])
      pphForagingResourceForLambda_StrNut <- append(pphForagingResourceForLambda_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForLambda_StrNut <- pphResourceBreakPointForLambda_StrNut      
      pphForagingResourceForLambda_StrNut  <- pphForagingResourceForLambda_StrNut 
    }
        
  ########################################################################################################################################
    
    #Nutrition effect of Resources (beta- and k+) with negative effect of muNegative 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=murNegative[i]
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionMuNegative <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionMuNegative[length(equilibriumH_NutritionMuNegative)+1] <- tmpNutritionMuNegative$H[length(tmpNutritionMuNegative$H)]
    equilibriumP_NutritionMuNegative[length(equilibriumP_NutritionMuNegative)+1] <- tmpNutritionMuNegative$P[length(tmpNutritionMuNegative$P)]
    equilibriumForagingResource_NutritionMuNegative[length(equilibriumForagingResource_NutritionMuNegative)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionMuNegative[length(equilibriumNonForagingResource_NutritionMuNegative)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForMuNegative <- (equilibriumH_NutritionMuNegative[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuNegative <- (equilibriumH_NutritionMuNegative[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionMuNegative[1]/equilibriumH_NutritionMuNegative[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionMuNegative[i]/equilibriumH_NutritionMuNegative[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuNegative <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuNegative <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuNegative_StrNut==TRUE & (sign(hostOriginalPctChangeForMuNegative)== -1 & hostCurrentPctChangeForMuNegative>0)){
      hostFirstMuNegative_StrNut <- FALSE
      hostResourceBreakPointForMuNegative_StrNut <- append(hostResourceBreakPointForMuNegative_StrNut, resource[i])
      hostForagingResourceForMuNegative_StrNut <- append(hostForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else if (hostFirstMuNegative_StrNut==TRUE & (sign(hostOriginalPctChangeForMuNegative)== 1 & hostCurrentPctChangeForMuNegative<0)){
      hostFirstMuNegative_StrNut <- FALSE
      hostResourceBreakPointForMuNegative_StrNut <- append(hostResourceBreakPointForMuNegative_StrNut, resource[i])
      hostForagingResourceForMuNegative_StrNut <- append(hostForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForMuNegative_StrNut <- hostResourceBreakPointForMuNegative_StrNut      
      hostForagingResourceForMuNegative_StrNut <- hostForagingResourceForMuNegative_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuNegative_StrNut==TRUE & (sign(pphOriginalPctChangeForMuNegative)== -1 & pphCurrentPctChangeForMuNegative>0)){
      pphFirstMuNegative_StrNut <- FALSE
      pphResourceBreakPointForMuNegative_StrNut <- append(pphResourceBreakPointForMuNegative_StrNut, resource[i])
      pphForagingResourceForMuNegative_StrNut <- append(pphForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else if (pphFirstMuNegative_StrNut==TRUE & (sign(pphOriginalPctChangeForMuNegative)== 1 & pphCurrentPctChangeForMuNegative<0)){
      pphFirstMuNegative_StrNut <- FALSE
      pphResourceBreakPointForMuNegative_StrNut <- append(pphResourceBreakPointForMuNegative_StrNut, resource[i])
      pphForagingResourceForMuNegative_StrNut <- append(pphForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForMuNegative_StrNut <- pphResourceBreakPointForMuNegative_StrNut      
      pphForagingResourceForMuNegative_StrNut  <- pphForagingResourceForMuNegative_StrNut 
    }
  
  }
  
}

```

```{r - Linear Regression to find equation for resourceBreakpoints of NUTRITION/STRESS}
#We can use slope of these regressions as the "sensitivity" of a nonForagingParameter to resource subsidy

hostBirthLM_StrNut <- lm(hostResourceBreakPointForB_StrNut ~ hostForagingResourceForB_StrNut)
summary(hostBirthLM_StrNut)
  #breakPoint = 1.14755 + hostForaging*0.72129 
  #df = 1, 38
  #p = 2.2*10^(-16)
  #adj R^2 = 0.9262

hostDeathLM_StrNut <- lm(hostResourceBreakPointForD_StrNut ~ hostForagingResourceForD_StrNut)
summary(hostDeathLM_StrNut)
  #Only one point, which is exactly what we have in the previous version. Something going on with d (natural mortality) parameter?
  #breakPoint =  + hostForaging*
  #df = 
  #p = 
  #adj R^2 = 

hostCarryingCapacityLM_StrNut <- lm(hostResourceBreakPointForKcarryCap_StrNut ~ hostForagingResourceForKcarryCap_StrNut)
summary(hostCarryingCapacityLM_StrNut)
  #breakPoint = -6.0143 + hostForaging*5.4
  #df = 1, 12
  #p = 1.563*10^(-5)
  #adj R^2 = 0.7839

#hostParasiteVirulenceLM_StrNut <- lm(hostResourceBreakPointForAlpha_StrNut ~ hostForagingResourceForAlpha_StrNut)
#summary(hostParasiteVirulenceLM_StrNut)
  #This fails to reach a breakpoint (Null values in both vectors). Likely because alpha effect is extremely small.

hostMuPositiveLM_StrNut <- lm(hostResourceBreakPointForMuPositive_StrNut ~ hostForagingResourceForMuPositive_StrNut)
summary(hostMuPositiveLM_StrNut)
  #breakPoint = -0.746689 + hostForaging*1.793996
  #df = 1, 38
  #p = 2.2*10^(-16)
  #adj R^2 = 0.9998

hostLambdaLM_StrNut <- lm(hostResourceBreakPointForLambda_StrNut ~ hostForagingResourceForLambda_StrNut)
summary(hostLambdaLM_StrNut)
  #breakPoint = 0.16150 + hostForaging*0.88311
  #df = 1, 38
  #p = 2.2*10^(-16)
  #adj R^2 = 0.9992

hostMuNegativeLM_StrNut <- lm(hostResourceBreakPointForMuNegative_StrNut ~ hostForagingResourceForMuNegative_StrNut)
summary(hostMuNegativeLM_StrNut)
  #breakPoint = -8.997 + hostForaging*8.23
  #df = 1, 8
  #p = 0.0002201
  #adj R^2 = 0.8139

######################################################################################################

pphBirthLM_StrNut <- lm(pphResourceBreakPointForB_StrNut ~ pphForagingResourceForB_StrNut)
summary(pphBirthLM_StrNut)
  #Only two points!
  #breakPoint = -7.5 + pphForaging*8
  #df = 1, 0
  #p = N/a
  #adj R^2 = N/a

pphDeathLM_StrNut <- lm(pphResourceBreakPointForD_StrNut ~ pphForagingResourceForD_StrNut)
summary(pphDeathLM_StrNut)
  #breakPoint = -20.29 + pphForaging*18.5
  #df = 1, 3
  #p = 0.04789
  #adj R^2 = 0.7035

pphCarryingCapacityLM_StrNut <- lm(pphResourceBreakPointForKcarryCap_StrNut ~ pphForagingResourceForKcarryCap_StrNut)
summary(pphCarryingCapacityLM_StrNut)
  #breakPoint = 0.150478 + hostForaging*0.888368
  #df = 1, 38
  #p = 2.2*10^(-16)
  #adj R^2 = 0.9992

pphParasiteVirulenceLM_StrNut <- lm(pphResourceBreakPointForAlpha_StrNut ~ pphForagingResourceForAlpha_StrNut)
summary(pphParasiteVirulenceLM_StrNut)
  #breakPoint = -9.9 + pphForaging*9.7
  #df = 1, 2
  #p = 0.1136
  #adj R^2 = 0.6786

pphMuPositiveLM_StrNut <- lm(pphResourceBreakPointForMuPositive_StrNut ~ pphForagingResourceForMuPositive_StrNut)
summary(pphMuPositiveLM_StrNut)
  #breakPoint = -0.746689 + pphForaging*1.793996
  #df = 1, 38
  #p = 2.2*10^(-16)
  #adj R^2 = 0.9998

pphLambdaLM_StrNut <- lm(pphResourceBreakPointForLambda_StrNut ~ pphForagingResourceForLambda_StrNut)
summary(pphLambdaLM_StrNut)
  #breakPoint = 0.166004 + hostForaging*0.882458
  #df = 1, 38
  #p = 2.2*10^(-16)
  #adj R^2 = 0.9992

pphMuNegativeLM_StrNut <- lm(pphResourceBreakPointForMuNegative_StrNut ~ pphForagingResourceForMuNegative_StrNut)
summary(pphMuNegativeLM_StrNut)
  #breakPoint = -8.997 + pphForaging*8.23
  #df = 1, 8
  #p = 0.0002201
  #adj R^2 = 0.8139

```

```{r  - NONLINEAR LEAST SQUARES REGRESSION}
#ONLY CONSIDER NON-LINEAR SHAPED LINES (visually inspected curvilinear)
#Hosts = b d Hmax mu-

#Host Birth NLS
hostBirthNLSLinear_StrNut <- nls(formula=hostResourceBreakPointForB_StrNut ~ a*hostForagingResourceForB_StrNut, start=list(a=100))
hostBirthNLSQuadratic_StrNut <- nls(formula=hostResourceBreakPointForB_StrNut ~ a*hostForagingResourceForB_StrNut + b*I(hostForagingResourceForB_StrNut^2), start=list(a=100, b=100))
hostBirthNLSCubic_StrNut <- nls(formula=hostResourceBreakPointForB_StrNut ~ a*hostForagingResourceForB_StrNut + b*I(hostForagingResourceForB_StrNut^2) + c*I(hostForagingResourceForB_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostBirthModels_StrNut <- list(hostBirthNLSLinear_StrNut, hostBirthNLSQuadratic_StrNut, hostBirthNLSCubic_StrNut)
hostBirthModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostBirthModels_StrNut, modnames=hostBirthModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(hostBirthNLSCubic_StrNut)

#######################################

#Host death NLS
hostDeathNLSLinear_StrNut <- nls(formula=hostResourceBreakPointForD_StrNut ~ a*hostForagingResourceForD_StrNut, start=list(a=100))
hostDeathNLSQuadratic_StrNut <- nls(formula=hostResourceBreakPointForD_StrNut ~ a*hostForagingResourceForD_StrNut + b*I(hostForagingResourceForD_StrNut^2), start=list(a=100, b=100))
hostDeathNLSCubic_StrNut <- nls(formula=hostResourceBreakPointForD_StrNut ~ a*hostForagingResourceForD_StrNut + b*I(hostForagingResourceForD_StrNut^2) + c*I(hostForagingResourceForD_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostDeathModels_StrNut <- list(hostDeathNLSLinear_StrNut, hostDeathNLSQuadratic_StrNut, hostDeathNLSCubic_StrNut)
hostDeathModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostDeathModels_StrNut, modnames=hostDeathModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(hostDeathNLSCubic_StrNut)

#######################################

#Host Carrying Capacity NLS
hostCarryingCapacityNLSLinear_StrNut <- nls(formula=hostResourceBreakPointForKcarryCap_StrNut ~ a*hostForagingResourceForKcarryCap_StrNut, start=list(a=100))
hostCarryingCapacityNLSQuadratic_StrNut <- nls(formula=hostResourceBreakPointForKcarryCap_StrNut ~ a*hostForagingResourceForKcarryCap_StrNut + b*I(hostForagingResourceForKcarryCap_StrNut^2), start=list(a=100, b=100))
hostCarryingCapacityNLSCubic_StrNut <- nls(formula=hostResourceBreakPointForKcarryCap_StrNut ~ a*hostForagingResourceForKcarryCap_StrNut + b*I(hostForagingResourceForKcarryCap_StrNut^2) + c*I(hostForagingResourceForKcarryCap_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostCarryingCapacityModels_StrNut <- list(hostCarryingCapacityNLSLinear_StrNut, hostCarryingCapacityNLSQuadratic_StrNut, hostCarryingCapacityNLSCubic_StrNut)
hostCarryingCapacityModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostCarryingCapacityModels_StrNut, modnames=hostCarryingCapacityModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(hostCarryingCapacityNLSCubic_StrNut)

#######################################

#Host Mu Negative NLS
hostMuNegativeNLSLinear_StrNut <- nls(formula=hostResourceBreakPointForKcarryCap_StrNut ~ a*hostForagingResourceForKcarryCap_StrNut, start=list(a=100))
hostMuNegativeNLSQuadratic_StrNut <- nls(formula=hostResourceBreakPointForKcarryCap_StrNut ~ a*hostForagingResourceForKcarryCap_StrNut + b*I(hostForagingResourceForKcarryCap_StrNut^2), start=list(a=100, b=100))
hostMuNegativeNLSCubic_StrNut <- nls(formula=hostResourceBreakPointForKcarryCap_StrNut ~ a*hostForagingResourceForKcarryCap_StrNut + b*I(hostForagingResourceForKcarryCap_StrNut^2) + c*I(hostForagingResourceForKcarryCap_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
hostMuNegativeModels_StrNut <- list(hostMuNegativeNLSLinear_StrNut, hostMuNegativeNLSQuadratic_StrNut, hostMuNegativeNLSCubic_StrNut)
hostMuNegativeModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=hostMuNegativeModels_StrNut, modnames=hostMuNegativeModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(hostMuNegativeNLSCubic_StrNut)

############################################################################################################################################################
#ONLY CONSIDER NON-LINEAR SHAPED LINES (visually inspected curvilinear)
#PpH = b d alpha mu-


#Pph Birth NLS
pphBirthNLSLinear_StrNut <- nls(formula=pphResourceBreakPointForB_StrNut ~ a*pphForagingResourceForB_StrNut, start=list(a=100))
pphBirthNLSQuadratic_StrNut <- nls(formula=pphResourceBreakPointForB_StrNut ~ a*pphForagingResourceForB_StrNut + b*I(pphForagingResourceForB_StrNut^2), start=list(a=100, b=100))
pphBirthNLSCubic_StrNut <- nls(formula=pphResourceBreakPointForB_StrNut ~ a*pphForagingResourceForB_StrNut + b*I(pphForagingResourceForB_StrNut^2) + c*I(pphForagingResourceForB_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphBirthModels_StrNut <- list(pphBirthNLSLinear_StrNut, pphBirthNLSQuadratic_StrNut, pphBirthNLSCubic_StrNut)
pphBirthModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphBirthModels_StrNut, modnames=pphBirthModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(pphBirthNLSCubic_StrNut)

#######################################

#Pph Death NLS
pphDeathNLSLinear_StrNut <- nls(formula=pphResourceBreakPointForD_StrNut ~ a*pphForagingResourceForD_StrNut, start=list(a=100))
pphDeathNLSQuadratic_StrNut <- nls(formula=pphResourceBreakPointForD_StrNut ~ a*pphForagingResourceForD_StrNut + b*I(pphForagingResourceForD_StrNut^2), start=list(a=100, b=100))
pphDeathNLSCubic_StrNut <- nls(formula=pphResourceBreakPointForD_StrNut ~ a*pphForagingResourceForD_StrNut + b*I(pphForagingResourceForD_StrNut^2) + c*I(pphForagingResourceForD_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphDeathModels_StrNut <- list(pphDeathNLSLinear_StrNut, pphDeathNLSQuadratic_StrNut, pphDeathNLSCubic_StrNut)
pphDeathModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphDeathModels_StrNut, modnames=pphDeathModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(pphDeathNLSCubic_StrNut)

#######################################

#Pph Virulence NLS
pphVirulenceNLSLinear_StrNut <- nls(formula=pphResourceBreakPointForAlpha_StrNut ~ a*pphForagingResourceForAlpha_StrNut, start=list(a=100))
pphVirulenceNLSQuadratic_StrNut <- nls(formula=pphResourceBreakPointForAlpha_StrNut ~ a*pphForagingResourceForAlpha_StrNut + b*I(pphForagingResourceForAlpha_StrNut^2), start=list(a=100, b=100))
pphVirulenceNLSCubic_StrNut <- nls(formula=pphResourceBreakPointForAlpha_StrNut ~ a*pphForagingResourceForAlpha_StrNut + b*I(pphForagingResourceForAlpha_StrNut^2) + c*I(pphForagingResourceForAlpha_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphVirulenceModels_StrNut <- list(pphVirulenceNLSLinear_StrNut, pphVirulenceNLSQuadratic_StrNut, pphVirulenceNLSCubic_StrNut)
pphVirulenceModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphVirulenceModels_StrNut, modnames=pphVirulenceModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(pphVirulenceNLSCubic_StrNut)

#######################################

#Pph ParasiteMortalityNeg NLS
pphParasiteMortalityNegNLSLinear_StrNut <- nls(formula=pphResourceBreakPointForMuNegative_StrNut ~ a*pphForagingResourceForMuNegative_StrNut, start=list(a=100))
pphParasiteMortalityNegNLSQuadratic_StrNut <- nls(formula=pphResourceBreakPointForMuNegative_StrNut ~ a*pphForagingResourceForMuNegative_StrNut + b*I(pphForagingResourceForMuNegative_StrNut^2), start=list(a=100, b=100))
pphParasiteMortalityNegNLSCubic_StrNut <- nls(formula=pphResourceBreakPointForMuNegative_StrNut ~ a*pphForagingResourceForMuNegative_StrNut + b*I(pphForagingResourceForMuNegative_StrNut^2) + c*I(pphForagingResourceForMuNegative_StrNut^3), start=list(a=100, b=100, c=100))

#Comparing AIC values
pphParasiteMortalityNegModels_StrNut <- list(pphParasiteMortalityNegNLSLinear_StrNut, pphParasiteMortalityNegNLSQuadratic_StrNut, pphParasiteMortalityNegNLSCubic_StrNut)
pphParasiteMortalityNegModelNames_StrNut <- c('linear', 'quadratic', 'cubic')
aictab(cand.set=pphParasiteMortalityNegModels_StrNut, modnames=pphParasiteMortalityNegModelNames_StrNut)

#Run summary of most parsimonious model (lowest AIC)
summary(pphParasiteMortalityNegNLSCubic_StrNut)

```

```{r - Curvilinear regressions - Cubic regressions provided significant relationships and highest fit for all parameters}
#Host regressions (b d Hmax mu-)

hostBirthLMCubic_StrNut <- lm(hostResourceBreakPointForB_StrNut ~ hostForagingResourceForB_StrNut + I(hostForagingResourceForB_StrNut^2) + I(hostForagingResourceForB_StrNut^3))
summary(hostBirthLMCubic_StrNut)
  #breakPoint = -2.29 + 4.41*hostForaging - 1.24*hostForaging^2 + 0.14*hostForaging^3
  #F(3, 156) = 9.42*10^(5), p = 2.2*10^(-16), R^2 = 0.9999

hostDeathLMCubic_StrNut <- lm(hostResourceBreakPointForD_StrNut ~ hostForagingResourceForD_StrNut + I(hostForagingResourceForD_StrNut^2) + I(hostForagingResourceForD_StrNut^3))
summary(hostDeathLMCubic_StrNut)
  #breakPoint = -1532.2 + 4403.4*hostForaging - 4222.9*hostForaging^2 + 1352.6*hostForaging^3
  #F(3, 8) = 3292, p = 1.055*10^(-12), R^2 = 0.9989


hostCarryingCapacityLMCubic_StrNut <- lm(hostResourceBreakPointForKcarryCap_StrNut ~ hostForagingResourceForKcarryCap_StrNut + I(hostForagingResourceForKcarryCap_StrNut^2) +
                                  I(hostForagingResourceForKcarryCap_StrNut^3))
summary(hostCarryingCapacityLMCubic_StrNut)
  #breakPoint = -5.75 + 14.31*hostForaging - 10.43*hostForaging^2 + 2.82*hostForaging^3
  #F(3, 88) = 226.4, p = 5.882*10^(4), R^2 = 0.9995


hostMuNegativeLMCubic_StrNut <- lm(hostResourceBreakPointForMuNegative_StrNut ~ hostForagingResourceForMuNegative_StrNut + I(hostForagingResourceForMuNegative_StrNut^2) +
                            I(hostForagingResourceForMuNegative_StrNut^3))
summary(hostMuNegativeLMCubic_StrNut)
  #breakPoint = -12.18 + 30.72*hostForaging - 24.81*hostForaging^2 + 7.23*hostForaging^3
  #F(3, 60) = 7.522*10^(4), p < 2.2*10^(-16), R^2 = 0.9997

######################################################################################################
#PpH Regressions (b, d, alpha, mu-)

pphBirthLMCubic_StrNut <- lm(pphResourceBreakPointForB_StrNut ~ pphForagingResourceForB_StrNut + I(pphForagingResourceForB_StrNut^2) + I(pphForagingResourceForB_StrNut^3))
summary(pphBirthLMCubic_StrNut)
  #breakPoint = -647.14 + 1772.52*pphForaging - 1616.34*pphForaging^2 + 491.71*pphForaging^3
  #F(3, 18) = 465.3, p < 2.2*10^(-16), R^2 = 0.9851

pphDeathLMCubic_StrNut <- lm(pphResourceBreakPointForD_StrNut ~ pphForagingResourceForD_StrNut + I(pphForagingResourceForD_StrNut^2) + I(pphForagingResourceForD_StrNut^3))
summary(pphDeathLMCubic_StrNut)
  #breakPoint = -99.82 + 267.43*pphForaging - 238.26*pphForaging^2 + 71.56*pphForaging^3
  #F(3, 30) = 8059, p < 2.2*10^(-16), R^2 = 0.9986

pphParasiteVirulenceLMCubic_StrNut <- lm(pphResourceBreakPointForAlpha_StrNut ~ pphForagingResourceForAlpha_StrNut + I(pphForagingResourceForAlpha_StrNut^2) +
                                         I(pphForagingResourceForAlpha_StrNut^3))
summary(pphParasiteVirulenceLMCubic_StrNut)
  #breakPoint = -232.02 + 604.59*pphForaging - 522.36*pphForaging^2 + 150.51*pphForaging^3
  #F(3, 28) = 135.8, p < 2.2*10^(-16), R^2 = 0.9288

pphMuNegativeLMCubic_StrNut <- lm(pphResourceBreakPointForMuNegative_StrNut ~ pphForagingResourceForMuNegative_StrNut + I(pphForagingResourceForMuNegative_StrNut^2) +
                             I(pphForagingResourceForMuNegative_StrNut^3))
summary(pphMuNegativeLMCubic_StrNut)
  #breakPoint = -11.89 + 30.01*pphForaging - 24.23*pphForaging^2 + 7.07*pphForaging^3
  #F(3, 60) = 7.511*10^(4), p < 2.2*10^(-16), R^2 = 0.9997

```

```{r - Linear Regression Predicted Points - Creating vectors that have the line of best fit points (when paired with foragingResource NUTRITION/STRESS)}
hostBirthLMPoints_StrNut <- c()
hostDeathLMPoints_StrNut <- c()
hostCarryingCapacityLMPoints_StrNut <- c()
hostParasiteVirulenceLMPoints_StrNut <- c()
hostMuPositiveLMPoints_StrNut <- c()
hostLambdaLMPoints_StrNut <- c()
hostMuNegativeLMPoints_StrNut <- c()

hostBirthLMPointsPair_StrNut <- c()
hostDeathLMPointsPair_StrNut <- c()
hostCarryingCapacityLMPointsPair_StrNut <- c()
hostParasiteVirulenceLMPointsPair_StrNut <- c()
hostMuPositiveLMPointsPair_StrNut <- c()
hostLambdaLMPointsPair_StrNut <- c()
hostMuNegativeLMPointsPair_StrNut <- c()

pphBirthLMPoints_StrNut <- c()
pphDeathLMPoints_StrNut <- c()
pphCarryingCapacityLMPoints_StrNut <- c()
pphParasiteVirulenceLMPoints_StrNut <- c()
pphMuPositiveLMPoints_StrNut <- c()
pphLambdaLMPoints_StrNut <- c()
pphMuNegativeLMPoints_StrNut <- c()

pphBirthLMPointsPair_StrNut <- c()
pphDeathLMPointsPair_StrNut <- c()
pphCarryingCapacityLMPointsPair_StrNut <- c()
pphParasiteVirulenceLMPointsPair_StrNut <- c()
pphMuPositiveLMPointsPair_StrNut <- c()
pphLambdaLMPointsPair_StrNut <- c()
pphMuNegativeLMPointsPair_StrNut <- c()

#Calculating Regression line points (line of best fit points)
for (j in 1:length(foragingResource)){
  tempHostBirthLMPoints_StrNut = unname((hostBirthLM_StrNut$coefficients[1] + hostBirthLM_StrNut$coefficients[2]*foragingResource[j])) #unname() removes the Intercept and Slope terms added by lm()
  hostBirthLMPoints_StrNut <- append(hostBirthLMPoints_StrNut, values=tempHostBirthLMPoints_StrNut)
  hostBirthLMPointsPair_StrNut <- append(hostBirthLMPointsPair_StrNut, values=foragingResource[j])
  
  tempHostDeathLMPoints_StrNut = unname((hostDeathLM_StrNut$coefficients[1] + hostDeathLM_StrNut$coefficients[2]*foragingResource[j]))
  hostDeathLMPoints_StrNut <- append(hostDeathLMPoints_StrNut, values=tempHostDeathLMPoints_StrNut)
  hostDeathLMPointsPair_StrNut <- append(hostDeathLMPointsPair_StrNut, values=foragingResource[j])
  
  tempHostCarryingCapacityLMPoints_StrNut = unname((hostCarryingCapacityLM_StrNut$coefficients[1] + hostCarryingCapacityLM_StrNut$coefficients[2]*foragingResource[j])) 
  hostCarryingCapacityLMPoints_StrNut <- append(hostCarryingCapacityLMPoints_StrNut, values=tempHostCarryingCapacityLMPoints_StrNut)
  hostCarryingCapacityLMPointsPair_StrNut <- append(hostCarryingCapacityLMPointsPair_StrNut, values=foragingResource[j])
  
  #NOTE: Alpha (parasite virulence) is incapable of overcoming foraging resource effects thus it is excluded
  #tempHostParasiteVirulenceLMPoints_StrNut = unname((hostParasiteVirulenceLM_StrNut$coefficients[1] + hostParasiteVirulenceLM_StrNut$coefficients[2]*foragingResource[j]))
  #hostParasiteVirulenceLMPoints_StrNut <- append(hostParasiteVirulenceLMPoints_StrNut, values=tempHostParasiteVirulenceLMPoints_StrNut)
  #hostParasiteVirulenceLMPointsPair_StrNut <- append(hostParasiteVirulenceLMPointsPair_StrNut, values=foragingResource[j])

  tempHostMuPositiveLMPoints_StrNut = unname((hostMuPositiveLM_StrNut$coefficients[1] + hostMuPositiveLM_StrNut$coefficients[2]*foragingResource[j])) 
  hostMuPositiveLMPoints_StrNut <- append(hostMuPositiveLMPoints_StrNut, values=tempHostMuPositiveLMPoints_StrNut)
  hostMuPositiveLMPointsPair_StrNut <- append(hostMuPositiveLMPointsPair_StrNut, values=foragingResource[j])

  tempHostLambdaLMPoints_StrNut = unname((hostLambdaLM_StrNut$coefficients[1] + hostLambdaLM_StrNut$coefficients[2]*foragingResource[j]))
  hostLambdaLMPoints_StrNut <- append(hostLambdaLMPoints_StrNut, values=tempHostLambdaLMPoints_StrNut)
  hostLambdaLMPointsPair_StrNut <- append(hostLambdaLMPointsPair_StrNut, values=foragingResource[j])

  tempHostMuNegativeLMPoints_StrNut = unname((hostMuNegativeLM_StrNut$coefficients[1] + hostMuNegativeLM_StrNut$coefficients[2]*foragingResource[j])) 
  hostMuNegativeLMPoints_StrNut <- append(hostMuNegativeLMPoints_StrNut, values=tempHostMuNegativeLMPoints_StrNut)
  hostMuNegativeLMPointsPair_StrNut <- append(hostMuNegativeLMPointsPair_StrNut, values=foragingResource[j])

  ##################################################################################################################################################################
  
  tempPphBirthLMPoints_StrNut = unname((pphBirthLM_StrNut$coefficients[1] + pphBirthLM_StrNut$coefficients[2]*foragingResource[j])) #unname() removes the Intercept and Slope terms added by lm()
  pphBirthLMPoints_StrNut <- append(pphBirthLMPoints_StrNut, values=tempPphBirthLMPoints_StrNut)
  pphBirthLMPointsPair_StrNut <- append(pphBirthLMPointsPair_StrNut, values=foragingResource[j])
  
  tempPphDeathLMPoints_StrNut = unname((pphDeathLM_StrNut$coefficients[1] + pphDeathLM_StrNut$coefficients[2]*foragingResource[j]))
  pphDeathLMPoints_StrNut <- append(pphDeathLMPoints_StrNut, values=tempPphDeathLMPoints_StrNut)
  pphDeathLMPointsPair_StrNut <- append(pphDeathLMPointsPair_StrNut, values=foragingResource[j])
  
  tempPphCarryingCapacityLMPoints_StrNut = unname((pphCarryingCapacityLM_StrNut$coefficients[1] + pphCarryingCapacityLM_StrNut$coefficients[2]*foragingResource[j])) 
  pphCarryingCapacityLMPoints_StrNut <- append(pphCarryingCapacityLMPoints_StrNut, values=tempPphCarryingCapacityLMPoints_StrNut)
  pphCarryingCapacityLMPointsPair_StrNut <- append(pphCarryingCapacityLMPointsPair_StrNut, values=foragingResource[j])

  tempPphParasiteVirulenceLMPoints_StrNut = unname((pphParasiteVirulenceLM_StrNut$coefficients[1] + pphParasiteVirulenceLM_StrNut$coefficients[2]*foragingResource[j])) 
  pphParasiteVirulenceLMPoints_StrNut <- append(pphParasiteVirulenceLMPoints_StrNut, values=tempPphParasiteVirulenceLMPoints_StrNut)
  pphParasiteVirulenceLMPointsPair_StrNut <- append(pphParasiteVirulenceLMPointsPair_StrNut, values=foragingResource[j])

  tempPphMuPositiveLMPoints_StrNut = unname((pphMuPositiveLM_StrNut$coefficients[1] + pphMuPositiveLM_StrNut$coefficients[2]*foragingResource[j])) 
  pphMuPositiveLMPoints_StrNut <- append(pphMuPositiveLMPoints_StrNut, values=tempPphMuPositiveLMPoints_StrNut)
  pphMuPositiveLMPointsPair_StrNut <- append(pphMuPositiveLMPointsPair_StrNut, values=foragingResource[j])

  tempPphLambdaLMPoints_StrNut = unname((pphLambdaLM_StrNut$coefficients[1] + pphLambdaLM_StrNut$coefficients[2]*foragingResource[j]))
  pphLambdaLMPoints_StrNut <- append(pphLambdaLMPoints_StrNut, values=tempPphLambdaLMPoints_StrNut)
  pphLambdaLMPointsPair_StrNut <- append(pphLambdaLMPointsPair_StrNut, values=foragingResource[j])

  tempPphMuNegativeLMPoints_StrNut = unname((pphMuNegativeLM_StrNut$coefficients[1] + pphMuNegativeLM_StrNut$coefficients[2]*foragingResource[j])) 
  pphMuNegativeLMPoints_StrNut <- append(pphMuNegativeLMPoints_StrNut, values=tempPphMuNegativeLMPoints_StrNut)
  pphMuNegativeLMPointsPair_StrNut <- append(pphMuNegativeLMPointsPair_StrNut, values=foragingResource[j])

}

#Saving the ENDING POINT of line of best fit so that we can graph the symbols larger later
#using linear regression equation to create a point of resourceBreakpoint that we can put in the graph to show which line is for which nonForagingParameter
hostBirthLMEndPoint_StrNut = max(hostBirthLMPoints_StrNut[hostBirthLMPoints_StrNut <= max(resource)])
#hostDeathLMEndPoint_StrNut = max(hostDeathLMPoints_StrNut[hostDeathLMPoints_StrNut <= max(resource)]) 
    #Doesn't work since only 1 point
hostCarryingCapacityLMEndPoint_StrNut = max(hostCarryingCapacityLMPoints_StrNut[hostCarryingCapacityLMPoints_StrNut <= max(resource)])
#hostParasiteVirulenceLMEndPoint_StrNut = max(hostParasiteVirulenceLMPoints_StrNut[hostParasiteVirulenceLMPoints_StrNut <= max(resource)]) 
    #Doesn't work because alpha cannot overcome effects of Nutrition
hostMuPositiveLMEndPoint_StrNut = max(hostMuPositiveLMPoints_StrNut[hostMuPositiveLMPoints_StrNut <= max(resource)])
hostLambdaLMEndPoint_StrNut = max(hostLambdaLMPoints_StrNut[hostLambdaLMPoints_StrNut <= max(resource)])
hostMuNegativeLMEndPoint_StrNut = max(hostMuNegativeLMPoints_StrNut[hostMuNegativeLMPoints_StrNut <= max(resource)])

hostBirthLMEndPointPair_StrNut = hostBirthLMPointsPair_StrNut[length(hostBirthLMPoints_StrNut[hostBirthLMPoints_StrNut <= max(resource)])]
#hostDeathLMEndPointPair_StrNut = hostDeathLMPointsPair_StrNut[length(hostDeathLMPoints_StrNut[hostDeathLMPoints_StrNut <= max(resource)])]
    #Doesn't work because only 1 point
hostCarryingCapacityLMEndPointPair_StrNut = hostCarryingCapacityLMPointsPair_StrNut[length(hostCarryingCapacityLMPoints_StrNut[hostCarryingCapacityLMPoints_StrNut <= max(resource)])]
#hostParasiteVirulenceLMEndPointPair_StrNut = hostParasiteVirulenceLMPointsPair_StrNut[length(hostParasiteVirulenceLMPoints_StrNut[hostParasiteVirulenceLMPoints_StrNut <= max(resource)])]
    #Doesn't work because alpha cannot overcome effects of Nutrition
hostMuPositiveLMEndPointPair_StrNut = hostMuPositiveLMPointsPair_StrNut[length(hostMuPositiveLMPoints_StrNut[hostMuPositiveLMPoints_StrNut <= max(resource)])]
hostLambdaLMEndPointPair_StrNut = hostLambdaLMPointsPair_StrNut[length(hostLambdaLMPoints_StrNut[hostLambdaLMPoints_StrNut <= max(resource)])]
hostMuNegativeLMEndPointPair_StrNut = hostMuNegativeLMPointsPair_StrNut[length(hostMuNegativeLMPoints_StrNut[hostMuNegativeLMPoints_StrNut <= max(resource)])]

pphBirthLMEndPoint_StrNut = max(pphBirthLMPoints_StrNut[pphBirthLMPoints_StrNut <= max(resource)])
pphDeathLMEndPoint_StrNut = max(pphDeathLMPoints_StrNut[pphDeathLMPoints_StrNut <= max(resource)])
pphCarryingCapacityLMEndPoint_StrNut = max(pphCarryingCapacityLMPoints_StrNut[pphCarryingCapacityLMPoints_StrNut <= max(resource)])
pphParasiteVirulenceLMEndPoint_StrNut = max(pphParasiteVirulenceLMPoints_StrNut[pphParasiteVirulenceLMPoints_StrNut <= max(resource)])
pphMuPositiveLMEndPoint_StrNut = max(pphMuPositiveLMPoints_StrNut[pphMuPositiveLMPoints_StrNut <= max(resource)])
pphLambdaLMEndPoint_StrNut = max(pphLambdaLMPoints_StrNut[pphLambdaLMPoints_StrNut <= max(resource)])
pphMuNegativeLMEndPoint_StrNut = max(pphMuNegativeLMPoints_StrNut[pphMuNegativeLMPoints_StrNut <= max(resource)])

pphBirthLMEndPointPair_StrNut = pphBirthLMPointsPair_StrNut[length(pphBirthLMPoints_StrNut[pphBirthLMPoints_StrNut <= max(resource)])]
pphDeathLMEndPointPair_StrNut = pphDeathLMPointsPair_StrNut[length(pphDeathLMPoints_StrNut[pphDeathLMPoints_StrNut <= max(resource)])]
pphCarryingCapacityLMEndPointPair_StrNut = pphCarryingCapacityLMPointsPair_StrNut[length(pphCarryingCapacityLMPoints_StrNut[pphCarryingCapacityLMPoints_StrNut <= max(resource)])]
pphParasiteVirulenceLMEndPointPair_StrNut = pphParasiteVirulenceLMPointsPair_StrNut[length(pphParasiteVirulenceLMPoints_StrNut[pphParasiteVirulenceLMPoints_StrNut <= max(resource)])]
pphMuPositiveLMEndPointPair_StrNut = pphMuPositiveLMPointsPair_StrNut[length(pphMuPositiveLMPoints_StrNut[pphMuPositiveLMPoints_StrNut <= max(resource)])]
pphLambdaLMEndPointPair_StrNut = pphLambdaLMPointsPair_StrNut[length(pphLambdaLMPoints_StrNut[pphLambdaLMPoints_StrNut <= max(resource)])]
pphMuNegativeLMEndPointPair_StrNut = pphMuNegativeLMPointsPair_StrNut[length(pphMuNegativeLMPoints_StrNut[pphMuNegativeLMPoints_StrNut <= max(resource)])]

```

```{r - Creating datasets NUTRITION/STRESS}
#Ranked by nonForagingParameter alphabetization (because we graph our values by NFP for legend)
bShape <- 0
dShape <- 2
KcarryCapShape <- 1
AlphaShape <- 6
MuPositiveShape <- 5
LambdaShape <- 3
MuNegativeShape <- 4

#Creating dataframes for hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #resourceBreakPoints = amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #foragingResourceLevel = amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

#Selecting every n-th value from parameters that have too many points for graphing (we can no longer see the linear regression line)
vectorValueSimplifier <- function(vector, stepSize){
  vector[seq(1, length(vector), by=stepSize)]
}

#Hosts (b, lambda, mu-, mu+, Hmax)
hostResourceBreakPointForBSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForB_StrNut, 4) 
hostForagingResourceForBSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForB_StrNut, 4)
hostResourceBreakPointForKcarryCapSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForKcarryCap_StrNut, 3) 
hostForagingResourceForKcarryCapSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForKcarryCap_StrNut, 3)
hostResourceBreakPointForMuPositiveSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForMuPositive_StrNut, 4)
hostForagingResourceForMuPositiveSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForMuPositive_StrNut, 4)
hostResourceBreakPointForLambdaSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForLambda_StrNut, 4) 
hostForagingResourceForLambdaSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForLambda_StrNut, 4) 
hostResourceBreakPointForMuNegativeSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForMuNegative_StrNut, 2)
hostForagingResourceForMuNegativeSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForMuNegative_StrNut, 2)

#Parasites per Host (Hmax, lambda, mu-, mu+)
pphResourceBreakPointForDSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForD_StrNut, 2)
pphForagingResourceForDSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForD_StrNut, 2)
pphResourceBreakPointForAlphaSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForAlpha_StrNut, 2)
pphForagingResourceForAlphaSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForAlpha_StrNut, 2)

pphResourceBreakPointForKcarryCapSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForKcarryCap_StrNut, 4)
pphForagingResourceForKcarryCapSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForKcarryCap_StrNut, 4)
pphResourceBreakPointForLambdaSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForLambda_StrNut, 4)
pphForagingResourceForLambdaSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForLambda_StrNut, 4)
pphResourceBreakPointForMuNegativeSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForMuNegative_StrNut, 2)
pphForagingResourceForMuNegativeSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForMuNegative_StrNut, 2)
pphResourceBreakPointForMuPositiveSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForMuPositive_StrNut, 4)
pphForagingResourceForMuPositiveSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForMuPositive_StrNut, 4)




hostDataAll_StrNut <- data.frame(resourceBreakPoints=c(hostResourceBreakPointForBSimple_StrNut, hostResourceBreakPointForD_StrNut, hostResourceBreakPointForKcarryCapSimple_StrNut, hostResourceBreakPointForAlpha_StrNut, hostResourceBreakPointForMuPositiveSimple_StrNut, hostResourceBreakPointForLambdaSimple_StrNut, hostResourceBreakPointForMuNegativeSimple_StrNut),
                          foragingResourceLevel=c(hostForagingResourceForBSimple_StrNut, hostForagingResourceForD_StrNut, hostForagingResourceForKcarryCapSimple_StrNut, hostForagingResourceForAlpha_StrNut, hostForagingResourceForMuPositiveSimple_StrNut, hostForagingResourceForLambdaSimple_StrNut, hostForagingResourceForMuNegativeSimple_StrNut), 
                          nonForagingParameter=c(rep("Host Birth Rate", times=length(hostResourceBreakPointForBSimple_StrNut)), rep("Host Natural Mortality", times=length(hostResourceBreakPointForD_StrNut)), rep("Host Carrying Capacity", times=length(hostResourceBreakPointForKcarryCapSimple_StrNut)), rep("Parasite Virulence", times=length(hostResourceBreakPointForAlpha_StrNut)), rep("Parasite Mortality+", times=length(hostResourceBreakPointForMuPositiveSimple_StrNut)), rep("Parasite Egg Production", times=length(hostResourceBreakPointForLambdaSimple_StrNut)), rep("Parasite Mortality-", times=length(hostResourceBreakPointForMuNegativeSimple_StrNut))),
                          NNP=c(rep("Stress", times=length(hostResourceBreakPointForBSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForD_StrNut)), rep("Stress", times=length(hostResourceBreakPointForKcarryCapSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForAlpha_StrNut)), rep("Stress", times=length(hostResourceBreakPointForMuPositiveSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForLambdaSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForMuNegativeSimple_StrNut))),
                          pointShape=c(rep(bShape, times=length(hostResourceBreakPointForBSimple_StrNut)), rep(dShape, times=length(hostResourceBreakPointForD_StrNut)), rep(KcarryCapShape, times=length(hostResourceBreakPointForKcarryCapSimple_StrNut)), rep(AlphaShape, times=length(hostResourceBreakPointForAlpha_StrNut)), rep(MuPositiveShape, times=length(hostResourceBreakPointForMuPositiveSimple_StrNut)), rep(LambdaShape, times=length(hostResourceBreakPointForLambdaSimple_StrNut)), rep(MuNegativeShape, times=length(hostResourceBreakPointForMuNegativeSimple_StrNut)))
                       )

pphDataAll_StrNut <- data.frame(resourceBreakPoints=c(pphResourceBreakPointForB_StrNut, pphResourceBreakPointForDSimple_StrNut, pphResourceBreakPointForKcarryCapSimple_StrNut, pphResourceBreakPointForAlphaSimple_StrNut, pphResourceBreakPointForMuPositiveSimple_StrNut, pphResourceBreakPointForLambdaSimple_StrNut, pphResourceBreakPointForMuNegativeSimple_StrNut),
                       foragingResourceLevel=c(pphForagingResourceForB_StrNut, pphForagingResourceForDSimple_StrNut, pphForagingResourceForKcarryCapSimple_StrNut, pphForagingResourceForAlphaSimple_StrNut, pphForagingResourceForMuPositiveSimple_StrNut, pphForagingResourceForLambdaSimple_StrNut, pphForagingResourceForMuNegativeSimple_StrNut),
                       nonForagingParameter=c(rep("Host Birth Rate", times=length(pphResourceBreakPointForB_StrNut)), rep("Host Natural Mortality", times=length(pphResourceBreakPointForDSimple_StrNut)), rep("Host Carrying Capacity", times=length(pphResourceBreakPointForKcarryCapSimple_StrNut)), rep("Parasite Virulence", times=length(pphResourceBreakPointForAlphaSimple_StrNut)), rep("Parasite Mortality+", times=length(pphResourceBreakPointForMuPositiveSimple_StrNut)), rep("Parasite Egg Production", times=length(pphResourceBreakPointForLambdaSimple_StrNut)), rep("Parasite Mortality-", times=length(pphResourceBreakPointForMuNegativeSimple_StrNut))),
                       NNP=c(rep("Nutrition", times=length(pphResourceBreakPointForB_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForDSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForKcarryCapSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForAlphaSimple_StrNut)), rep("Stress", times=length(pphResourceBreakPointForMuPositiveSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForLambdaSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForMuNegativeSimple_StrNut))),
                       pointShape=c(rep(bShape, times=length(pphResourceBreakPointForB_StrNut)), rep(dShape, times=length(pphResourceBreakPointForDSimple_StrNut)), rep(KcarryCapShape, times=length(pphResourceBreakPointForKcarryCapSimple_StrNut)), rep(AlphaShape, times=length(pphResourceBreakPointForAlphaSimple_StrNut)), rep(MuPositiveShape, times=length(pphResourceBreakPointForMuPositiveSimple_StrNut)), rep(LambdaShape, times=length(pphResourceBreakPointForLambdaSimple_StrNut)), rep(MuNegativeShape, times=length(pphResourceBreakPointForMuNegativeSimple_StrNut)))
                       )

#Creating dataframes for Regression Predictions of hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #predictedLMPoints = predicted amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #pairedForagingResourcePoints = predicted amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

#Alpha must be removed for hosts, it fails to overcome effects of Nutrition or Stress

hostRegressionData_StrNut <- data.frame(predictedLMPoints=c(hostBirthLMPoints_StrNut, hostDeathLMPoints_StrNut, hostCarryingCapacityLMPoints_StrNut, hostMuPositiveLMPoints_StrNut, hostLambdaLMPoints_StrNut, hostMuNegativeLMPoints_StrNut),
                                 pairedForagingResourcePoints=c(hostBirthLMPointsPair_StrNut, hostDeathLMPointsPair_StrNut, hostCarryingCapacityLMPointsPair_StrNut, hostMuPositiveLMPointsPair_StrNut, hostLambdaLMPointsPair_StrNut, hostMuNegativeLMPointsPair_StrNut),
                                 NNP=c(rep("Stress", times=length(hostBirthLMPoints_StrNut)), rep("Nutrition", times=length(hostDeathLMPoints_StrNut)), rep("Stress", times=length(hostCarryingCapacityLMPoints_StrNut)), rep("Stress", times=length(hostMuPositiveLMPoints_StrNut)), rep("Nutrition", times=length(hostLambdaLMPoints_StrNut)), rep("Nutrition", times=length(hostMuNegativeLMPoints_StrNut))),
                                 nonForagingParameter=c(rep("Host Birth Rate", times=length(hostBirthLMPoints_StrNut)), rep("Host Natural Mortality", times=length(hostDeathLMPoints_StrNut)), rep("Host Carrying Capacity", times=length(hostCarryingCapacityLMPoints_StrNut)), rep("Parasite Mortality+", times=length(hostMuPositiveLMPoints_StrNut)), rep("Parasite Egg Production", times=length(hostLambdaLMPoints_StrNut)), rep("Parasite Mortality-", times=length(hostMuNegativeLMPoints_StrNut))),
                                 pointShape=c(rep(bShape, times=length(hostBirthLMPoints_StrNut)), rep(dShape, times=length(hostDeathLMPoints_StrNut)), rep(KcarryCapShape, times=length(hostCarryingCapacityLMPoints_StrNut)), rep(MuPositiveShape, times=length(hostMuPositiveLMPoints_StrNut)), rep(LambdaShape, times=length(hostLambdaLMPoints_StrNut)), rep(MuNegativeShape, times=length(hostMuNegativeLMPoints_StrNut)))
                                 )

#Lambda is removed from both regressions, because it cannot overcome the effects of Nutrition or Stress (shared directionality)
#Hmax is removed from PpH regressions, because it cannot overcome the effects of Nutrition or Stress (shared directionality)

pphRegressionData_StrNut <- data.frame(predictedLMPoints=c(pphBirthLMPoints_StrNut, pphDeathLMPoints_StrNut, pphCarryingCapacityLMPoints_StrNut, pphParasiteVirulenceLMPoints_StrNut, pphMuPositiveLMPoints_StrNut, pphLambdaLMPoints_StrNut, pphMuNegativeLMPoints_StrNut),
                                 pairedForagingResourcePoints=c(pphBirthLMPointsPair_StrNut, pphDeathLMPointsPair_StrNut, pphCarryingCapacityLMPointsPair_StrNut, pphParasiteVirulenceLMPointsPair_StrNut, pphMuPositiveLMPointsPair_StrNut, pphLambdaLMPointsPair_StrNut, pphMuNegativeLMPointsPair_StrNut),
                                NNP=c(rep("Nutrition", times=length(pphBirthLMPoints_StrNut)), rep("Nutrition", times=length(pphDeathLMPoints_StrNut)), rep("Nutrition", times=length(pphCarryingCapacityLMPoints_StrNut)), rep("Nutrition", times=length(pphParasiteVirulenceLMPoints_StrNut)), rep("Stress", times=length(pphMuPositiveLMPoints_StrNut)), rep("Nutrition", times=length(pphLambdaLMPoints_StrNut)), rep("Nutrition", times=length(pphMuNegativeLMPoints_StrNut))),
                                nonForagingParameter=c(rep("Host Birth Rate", times=length(pphBirthLMPoints_StrNut)), rep("Host Natural Mortality", times=length(pphDeathLMPoints_StrNut)), rep("Host Carrying Capacity", times=length(pphCarryingCapacityLMPoints_StrNut)), rep("Parasite Virulence", times=length(pphParasiteVirulenceLMPoints_StrNut)), rep("Parasite Mortality+", times=length(pphMuPositiveLMPoints_StrNut)), rep("Parasite Egg Production", times=length(pphLambdaLMPoints_StrNut)), rep("Parasite Mortality-", times=length(pphMuNegativeLMPoints_StrNut))),
                                pointShape=c(rep(bShape, times=length(pphBirthLMPoints_StrNut)), rep(dShape, times=length(pphDeathLMPoints_StrNut)), rep(KcarryCapShape, times=length(pphCarryingCapacityLMPoints_StrNut)), rep(AlphaShape, times=length(pphParasiteVirulenceLMPoints_StrNut)), rep(MuPositiveShape, times=length(pphMuPositiveLMPoints_StrNut)), rep(LambdaShape, times=length(pphLambdaLMPoints_StrNut)), rep(MuNegativeShape, times=length(pphMuNegativeLMPoints_StrNut)))
                                 )

#Creating dataframes for Regression End Points of hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #predictedNonForagingEndPoints = predicted amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #pairedForagingEndPoints = predicted amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)



#WORKING HERE. Need to figure out which values are excluded in the linear regression data. Last time it was host virulence. This time, it's several things.


#Hosts remove alpha (fails to overcome)
hostRegressionEndPoints_StrNut <- data.frame(predictedNonForagingEndPoints=c(hostBirthLMEndPoint_StrNut, hostCarryingCapacityLMEndPoint_StrNut, hostMuPositiveLMEndPoint_StrNut, hostLambdaLMEndPoint_StrNut, hostMuNegativeLMEndPoint_StrNut), #NONFORAGING RESOURCES (y-axis)
                                      pairedForagingEndPoints=c(hostBirthLMEndPointPair_StrNut, hostCarryingCapacityLMEndPointPair_StrNut, hostMuPositiveLMEndPointPair_StrNut, hostLambdaLMEndPointPair_StrNut, hostMuNegativeLMEndPointPair_StrNut), #FORAGING RESOURCES (x-axis)
                                      nonForagingParameter=c("Host Birth Rate", "Host Carrying Capacity", "Parasite Mortality+", "Parasite Egg Production", "Parasite Mortality-"),
                                      NNP=c("Stress", "Stress", "Stress", "Nutrition", "Nutrition"),
                                      pointShape=c(bShape, KcarryCapShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                                      )

pphRegressionEndPoints_StrNut <- data.frame(predictedNonForagingEndPoints=c(pphBirthLMEndPoint_StrNut, pphDeathLMEndPoint_StrNut, pphCarryingCapacityLMEndPoint_StrNut, pphParasiteVirulenceLMEndPoint_StrNut, pphMuPositiveLMEndPoint_StrNut, pphLambdaLMEndPoint_StrNut, pphMuNegativeLMEndPoint_StrNut), #NONFORAGING RESOURCES (y-axis)
                                      pairedForagingEndPoints=c(pphBirthLMEndPointPair_StrNut, pphDeathLMEndPointPair_StrNut, pphCarryingCapacityLMEndPointPair_StrNut, pphParasiteVirulenceLMEndPointPair_StrNut, pphMuPositiveLMEndPointPair_StrNut, pphLambdaLMEndPointPair_StrNut, pphMuNegativeLMEndPointPair_StrNut), #FORAGING RESOURCES (x-axis)
                                      nonForagingParameter=c("Host Birth Rate", "Host Natural Mortality", "Host Carrying Capacity", "Parasite Virulence", "Parasite Mortality+", "Parasite Egg Production", "Parasite Mortality-"),
                                     NNP=c("Nutrition", "Nutrition", "Nutrition", "Nutrition", "Stress", "Nutrition", "Nutrition"),
                                     pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                                     ) 

#Subsetting our data to graph 2x2 panels

#Data points produced by Mathematical Model (will be plotted as small symbols)
hostDataNutrition_StrNut <- subset.data.frame(hostDataAll_StrNut, NNP=="Nutrition", select=TRUE)
hostDataNutritionD_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostDataNutritionAlpha_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
hostDataNutritionLambda_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
hostDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

hostDataStress_StrNut <- subset.data.frame(hostDataAll_StrNut, NNP=="Stress", select=TRUE)
hostDataStressB_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostDataStressCarryingCapacity_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphDataNutrition_StrNut <- subset.data.frame(pphDataAll_StrNut, NNP=="Nutrition", select=TRUE)
pphDataNutritionB_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphDataNutritionD_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphDataNutritionCarryingCapacity_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphDataNutritionParasiteVirulence_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphDataNutritionLambda_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)


pphDataStress_StrNut <- subset.data.frame(pphDataAll_StrNut, NNP=="Stress", select=TRUE)
pphDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

#Data points produced by Linear Regression interpreting relationship between Model output (will be plotted as lines)
hostRegressionDataNutrition_StrNut <- subset.data.frame(hostRegressionData_StrNut, NNP=="Nutrition", select=TRUE)
hostRegressionDataNutritionD_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostRegressionDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)
hostRegressionDataNutritionLambda_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)

hostRegressionDataStress_StrNut <- subset.data.frame(hostRegressionData_StrNut, NNP=="Stress", select=TRUE)
hostRegressionDataStressB_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostRegressionDataStressCarryingCapacity_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostRegressionDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphRegressionDataNutrition_StrNut <- subset.data.frame(pphRegressionData_StrNut, NNP=="Nutrition", select=TRUE)
pphRegressionDataNutritionB_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphRegressionDataNutritionD_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphRegressionDataNutritionCarryingCapacity_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphRegressionDataNutritionParasiteVirulence_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphRegressionDataNutritionLambda_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphRegressionDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphRegressionDataStress_StrNut <- subset.data.frame(pphRegressionData_StrNut, NNP=="Stress", select=TRUE)
pphRegressionDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

hostRegressionEndPointsNutrition_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, NNP=="Nutrition", select=TRUE)
hostRegressionEndPointsNutritionD_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostRegressionEndPointsNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)
hostRegressionEndPointsNutritionLambda_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)

hostRegressionEndPointsStress_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, NNP=="Stress", select=TRUE)
hostRegressionEndPointsStressB_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostRegressionEndPointsStressCarryingCapacity_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostRegressionEndPointsStressParasiteMortalityPositive_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphRegressionEndPointsNutrition_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, NNP=="Nutrition", select=TRUE)
pphRegressionEndPointsNutritionB_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphRegressionEndPointsNutritionD_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphRegressionEndPointsNutritionCarryingCapacity_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphRegressionEndPointsNutritionParasiteVirulence_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphRegressionEndPointsNutritionLambda_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphRegressionEndPointsNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphRegressionEndPointsStress_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, NNP=="Stress", select=TRUE)
pphRegressionEndPointsStressParasiteMortalityPositive_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

#Creating dataset for legend
legendDataframe_StrNut <- data.frame(xValue=c(1, 2, 3, 4, 5, 6, 7),
                              yValue=c(1, 2, 3, 4, 5, 6, 7),
                              nonForagingParameter=c("Host Birth Rate, b", "Host Natural Mortality, d", "Host Carrying Capacity, Hmax", "Parasite Virulence, \U1D6FC", "Parasite Mortality+, \U1D6CD+", "Parasite Egg Production, \U1D6CC", "Parasite Mortality-, \U1D6CD-"),
                              NNP=c("Stress", "Nutrition", "Stress", "Nutrition", "Stress", "Nutrition", "Stress"), #Order doesn't matter for these since they're just used for color
                              pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                              )

```

```{r - Graphing Supplemental Figure - Plot foragingResource along x-axis, breakpoints along y-axis, colored/marked by parameter and NUTRITION/STRESS type }
hostBreakpointsNutrition <- ggplot() +
  #Regression lines
  stat_smooth(data=hostDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  geom_line(data=hostRegressionDataNutritionLambda_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="darkgreen", size=1.2) + 
  stat_smooth(data=hostDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  #Model outputs as points
  geom_point(data=hostDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionD_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataNutritionLambda_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionLambda_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionParasiteMortalityNegative_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataNutritionAlpha_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionAlpha_StrNut$pointShape, size=1.2) +
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsNutritionD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNutritionD$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsNutritionEggProduction, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNutritionEggProduction$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsNutritionParasiteMortalityNutrition, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNutritionParasiteMortalityNutrition$pointShape, size=3) + 
  annotate("text", x=hostRegressionEndPointsNutritionLambda_StrNut$pairedForagingEndPoints, y=hostRegressionEndPointsNutritionLambda_StrNut$predictedNonForagingEndPoints-0.325, label=expression(lambda), size=5) + #lambda [NOTE: Need to -0.2 to y-axis to avoid overlapping with points]
  annotate("text", x=1.18, y=4.99, label="d", size=5) + #lambda [NOTE: Need to -0.2 to y-axis to avoid overlapping with points]
  annotate("text", x=1.8, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +             #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                             #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "", 
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  ggtitle(expression(bold("Host Population (H)"))) + 
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=1, y=10, label="A", size=5)
  #annotate("text", x=3.4, y=0.95, label="A: Decreased Host Overlap", size=5)

hostBreakpointsStress <- ggplot() +
  #Regression lines
  stat_smooth(data=hostDataStressB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="purple", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=hostDataStressCarryingCapacity_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="purple", se=FALSE, fullrange=TRUE) + 
  geom_line(data=hostRegressionDataStressParasiteMortalityPositive_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="purple", size=1.2) + 
  #Model outputs as points
  geom_point(data=hostDataStressB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataStressB_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataStressCarryingCapacity_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataStressCarryingCapacity_StrNut$pointShape, size=1.2) +
  geom_point(data=hostDataStressParasiteMortalityPositive_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataStressParasiteMortalityPositive_StrNut$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsStressB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsStressB$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsStressCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsStressCarryingCapacity$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsStressParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsStressParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=hostRegressionEndPointsStressB_StrNut$pairedForagingEndPoints, y=hostRegressionEndPointsStressB_StrNut$predictedNonForagingEndPoints+0.15, label="b", size=5) + #b
  annotate("text", x=2.2, y=4.99, label="Hmax", size=5) + #Hmax
  annotate("text", x=hostRegressionEndPointsStressParasiteMortalityPositive_StrNut$pairedForagingEndPoints,            
y=hostRegressionEndPointsStressParasiteMortalityPositive_StrNut$predictedNonForagingEndPoints+0.25, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = expression(atop(bold("Resource Effect on"), bold(paste("Foraging Parameters  ", "(", rho[f], ")")))),
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  annotate("text", x=1, y=10, label="C", size=5)
  #annotate("text", x=3.45, y=0.95, label="B: Increased Host Overlap", size=5)



pphBreakpointsNutrition <- ggplot() +
  #Regression lines
  stat_smooth(data=pphDataNutritionB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=FALSE) + 
  stat_smooth(data=pphDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=pphDataNutritionParasiteVirulence_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=pphDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  geom_line(data=pphRegressionDataNutritionCarryingCapacity_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="darkgreen", size=1.2) +
  geom_line(data=pphRegressionDataNutritionLambda_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="darkgreen", size=1.2) + 
  #Model outputs as points
  geom_point(data=pphDataNutritionB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionB_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionD_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionCarryingCapacity_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionCarryingCapacity_StrNut$pointShape, size=1.2) +  
  geom_point(data=pphDataNutritionParasiteVirulence_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionParasiteVirulence_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionLambda_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionLambda_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionParasiteMortalityNegative_StrNut$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=pphRegressionEndPointsNutritionB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionB$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNutritionD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionD$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNutritionCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionCarryingCapacity$pointShape, size=3) +   
  #geom_point(data=pphRegressionEndPointsNutritionParasiteVirulence, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionParasiteVirulence$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNutritionLambda, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionLambda$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNutritionParasiteMortalityNegative, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionParasiteMortalityNegative$pointShape, size=3) + 
  annotate("text", x=1.275, y=4.99, label="b", size=5) + #b
  annotate("text", x=1.375, y=4.75, label="d", size=5) + #d
  annotate("text", x=pphRegressionEndPointsNutritionCarryingCapacity_StrNut$pairedForagingEndPoints-0.1, y=pphRegressionEndPointsNutritionCarryingCapacity_StrNut$predictedNonForagingEndPoints-0.75, label="Hmax", size=5) + #Hmax [NOTE: Need the -0.1 to x-axis to keep on graph and +0.7 to y-axis since it overlaps with lambda]
  annotate("text", x=1.5, y=4.75, label=expression(alpha), size=5) + #alpha
  annotate("text", x=pphRegressionEndPointsNutritionLambda_StrNut$pairedForagingEndPoints+0.05, y=pphRegressionEndPointsNutritionLambda_StrNut$predictedNonForagingEndPoints-0.3, label=expression(lambda), size=5) + #lambda [NOTE: Need to +0.1 to y-axis to avoid overlapping with points]
    annotate("text", x=1.775, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x="",
       y="") +
  ggtitle(expression(bold("Parasite Abundance (P/H)"))) + 
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=1, y=10, label="B", size=5)
  #annotate("text", x=3.4, y=0.95, label="C: Decreased Host Overlap", size=5)
  
pphBreakpointsStress <- ggplot() +
  #Regression lines
  geom_line(data=pphRegressionDataStressParasiteMortalityPositive_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="purple", size=1.2) + 
  #Model outputs as points
  geom_point(data=pphDataStressParasiteMortalityPositive_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataStressParasiteMortalityPositive_StrNut$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
    #geom_point(data=pphRegressionEndPointsStressParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsStressParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=pphRegressionEndPointsStressParasiteMortalityPositive_StrNut$pairedForagingEndPoints, y=pphRegressionEndPointsStressParasiteMortalityPositive_StrNut$predictedNonForagingEndPoints+0.25, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +                      #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                                      #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = expression(atop(bold("Resource Effect on"), bold(paste("Foraging Parameters  ", "(", rho[f], ")")))),
       y = "") +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points  
  theme_bw() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  annotate("text", x=1, y=10, label="D", size=5)
  #annotate("text", x=3.45, y=0.95, label="D: Increased Host Overlap", size=5)

#Old Legend Graph
#fakeGraphForLegend <- ggplot() +
#  geom_line(data=legendDataframe, aes(x=xValue, y=yValue, group=nonForagingParameter, color=NNP), size=1.2) +        
#  geom_point(data=legendDataframe, aes(x=xValue, y=yValue, shape=nonForagingParameter), size=3) +  #, position=position_dodge(width=0.05)
#  scale_shape_manual(values=c(bShape, KcarryCapShape, dShape, LambdaShape, MuNegativeShape, MuPositiveShape, AlphaShape)) + #THIS IS BAD PRACTICE! Breaks graph, but fixes #legend which is all we care about in this fake graph
#  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
#  guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
#  guides(color = guide_legend(override.aes = list(size = 2))) +
#  guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
#  guides(shape = guide_legend(title="Non-Foraging Parameters")) #Changes title of legend for shape of points  


fakeGraphForLegendLines_StrNut <- ggplot() +
  geom_line(data=legendDataframe_StrNut, aes(x=xValue, y=yValue, group=nonForagingParameter, color=NNP), size=1.2) +
  scale_color_manual(values=c("darkgreen", "purple"),
                     labels=c("Decreased Parasite Encounter & Heterogeneity (\U03B2-, k+)", "Increased Parasite Encounter & Heterogeneity (\U03B2+, k-)")) +
  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
  guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  guides(color = guide_legend(override.aes = list(size = 2))) +
  guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) #Changes title of legend for line color

fakeGraphForLegendPoints_StrNut <- ggplot() +
  geom_point(data=legendDataframe_StrNut, aes(x=xValue, y=yValue, shape=nonForagingParameter), size=3) +  #, position=position_dodge(width=0.05)
  scale_shape_manual(values=c(bShape, KcarryCapShape, dShape, LambdaShape, MuNegativeShape, MuPositiveShape, AlphaShape),
                     labels=c("Host Birth Rate, b", "Host Carrying Capacity, Hmax", "Host Natural Mortality, d", "Parasite Egg Production, \U03BB", "Adult Parasite Mortality, \U03BC-", "Adult Parasite Mortality, \U03BC+", "Parasite Virulence, \U03B1")) + #THIS IS BAD PRACTICE! Breaks graph, but fixes legend which is all we care about in this fake graph
  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
  guides(shape = guide_legend(title="Non-Foraging Parameters")) #Changes title of legend for shape of points  

legendGraphForLines_StrNut <- cowplot::get_legend(fakeGraphForLegendLines_StrNut)
legendGraphForPoints_StrNut <- cowplot::get_legend(fakeGraphForLegendPoints_StrNut)

#Visualization choices export these as 800x1000
plot_grid(hostBreakpointsNutrition, pphBreakpointsNutrition, hostBreakpointsStress, pphBreakpointsStress, ncol=2, nrow=2)
plot_grid(hostBreakpointsNutrition, pphBreakpointsNutrition, hostBreakpointsStress, pphBreakpointsStress, legendGraphForPoints_StrNut, legendGraphForLines_StrNut, ncol=2, nrow=3)

```

```{r - FULL Model - DETER + Berding MONTHLY - Logistic Growth - Finding resource breakpoints for when each NON-FORAGING parameter undoes the effects of FORAGING parameters on Hosts/Parasites per Host BUT we are varying BOTH resource effects}
#b, d, beta, lambda, mu, gamma, KcarryCap and k from Deter 2008
#Alpha from Berding 1987

#Creating empty vectors
equilibriumH_Baseline <- c()
equilibriumP_Baseline <- c()
tmpBaseline <- c()

#Creating Breakpoint Vectors
hostResourceBreakPointForB <- c()
pphResourceBreakPointForB <- c()
hostResourceBreakPointForD <- c()
pphResourceBreakPointForD <- c()
hostResourceBreakPointForKcarryCap <- c()
pphResourceBreakPointForKcarryCap <- c()
hostResourceBreakPointForAlpha <- c()           #Alpha (virulence) is incapable of overcoming resource effect
pphResourceBreakPointForAlpha <- c()
hostResourceBreakPointForMuPositive <- c()
pphResourceBreakPointForMuPositive <- c()
hostResourceBreakPointForLambda <- c()
pphResourceBreakPointForLambda <- c()
hostResourceBreakPointForMuNegative <- c()
pphResourceBreakPointForMuNegative <- c()

#Creating ForagingResource Vectors (mostly just for organization)
hostForagingResourceForB <- c()
pphForagingResourceForB <- c()
hostForagingResourceForD <- c()
pphForagingResourceForD <- c()
hostForagingResourceForKcarryCap <- c()
pphForagingResourceForKcarryCap <- c()
hostForagingResourceForAlpha <- c()
pphForagingResourceForAlpha <- c()
hostForagingResourceForMuPositive <- c()
pphForagingResourceForMuPositive <- c()
hostForagingResourceForLambda <- c()
pphForagingResourceForLambda <- c()
hostForagingResourceForMuNegative <- c()
pphForagingResourceForMuNegative <- c()

#Creating Breakpoint Vectors
hostResourceBreakPointForB_StrNut <- c()
pphResourceBreakPointForB_StrNut <- c()
hostResourceBreakPointForD_StrNut <- c()
pphResourceBreakPointForD_StrNut <- c()
hostResourceBreakPointForKcarryCap_StrNut <- c()
pphResourceBreakPointForKcarryCap_StrNut <- c()
hostResourceBreakPointForAlpha_StrNut <- c()           #Alpha (virulence) is incapable of overcoming resource effect
pphResourceBreakPointForAlpha_StrNut <- c()
hostResourceBreakPointForMuPositive_StrNut <- c()
pphResourceBreakPointForMuPositive_StrNut <- c()
hostResourceBreakPointForLambda_StrNut <- c()
pphResourceBreakPointForLambda_StrNut <- c()
hostResourceBreakPointForMuNegative_StrNut <- c()
pphResourceBreakPointForMuNegative_StrNut <- c()

#Creating ForagingResource Vectors (mostly just for organization)
hostForagingResourceForB_StrNut <- c()
pphForagingResourceForB_StrNut <- c()
hostForagingResourceForD_StrNut <- c()
pphForagingResourceForD_StrNut <- c()
hostForagingResourceForKcarryCap_StrNut <- c()
pphForagingResourceForKcarryCap_StrNut <- c()
hostForagingResourceForAlpha_StrNut <- c()
pphForagingResourceForAlpha_StrNut <- c()
hostForagingResourceForMuPositive_StrNut <- c()
pphForagingResourceForMuPositive_StrNut <- c()
hostForagingResourceForLambda_StrNut <- c()
pphForagingResourceForLambda_StrNut <- c()
hostForagingResourceForMuNegative_StrNut <- c()
pphForagingResourceForMuNegative_StrNut <- c()

#Baseline Scenario for Comparisons
b=b0
d=d0
alpha=alpha0
beta=beta0
lambda=lambda0
gamma=gamma0
mu=mu0
k=k0
KcarryCap = KcarryCap0
#Creating parameters & running model
params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
tmpBaseline <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
equilibriumH_Baseline[length(equilibriumH_Baseline)+1] <- tmpBaseline$H[length(tmpBaseline$H)]
equilibriumP_Baseline[length(equilibriumP_Baseline)+1] <- tmpBaseline$P[length(tmpBaseline$P)]


for (j in 1:length(foragingResource)){
  #Creating empty vectors (must be reset each time we select a new foragingResource level)
  equilibriumH_PositiveB <- c()
  equilibriumP_PositiveB <- c()
  tmpPositiveB <- c()
  equilibriumNonForagingResource_PositiveB <- c()
  equilibriumForagingResource_PositiveB <- c()
  equilibriumH_NegativeB <- c()
  equilibriumP_NegativeB <- c()
  tmpNegativeB <- c()
  equilibriumNonForagingResource_NegativeB <- c()
  equilibriumForagingResource_NegativeB <- c()
  
  equilibriumH_NegativeD <- c()
  equilibriumP_NegativeD <- c()
  tmpNegativeD <- c()
  equilibriumNonForagingResource_NegativeD <- c()
  equilibriumForagingResource_NegativeD <- c()
  
  equilibriumH_PositiveKcarryCap <- c()
  equilibriumP_PositiveKcarryCap <- c()
  tmpPositiveKcarryCap <- c()
  equilibriumNonForagingResource_PositiveKcarryCap <- c()
  equilibriumForagingResource_PositiveKcarryCap <- c()
  equilibriumH_NegativeKcarryCap <- c()
  equilibriumP_NegativeKcarryCap <- c()
  tmpNegativeKcarryCap <- c()
  equilibriumNonForagingResource_NegativeKcarryCap <- c()
  equilibriumForagingResource_NegativeKcarryCap <- c()
  
  equilibriumH_NegativeAlpha <- c()
  equilibriumP_NegativeAlpha <- c()
  tmpNegativeAlpha <- c()
  equilibriumNonForagingResource_NegativeAlpha <- c()
  equilibriumForagingResource_NegativeAlpha <- c()
  
  equilibriumH_PositiveMuPositive <- c()
  equilibriumP_PositiveMuPositive <- c()
  tmpPositiveMuPositive <- c()
  equilibriumNonForagingResource_PositiveMuPositive <- c()
  equilibriumForagingResource_PositiveMuPositive <- c()
  
  equilibriumH_NegativeLambda <- c()
  equilibriumP_NegativeLambda <- c()
  tmpNegativeLambda <- c()
  equilibriumNonForagingResource_NegativeLambda <- c()
  equilibriumForagingResource_NegativeLambda <- c()
  
  equilibriumH_NegativeMuNegative <- c()
  equilibriumP_NegativeMuNegative <- c()
  tmpNegativeMuNegative <- c()
  equilibriumNonForagingResource_NegativeMuNegative <- c()
  equilibriumForagingResource_NegativeMuNegative <- c()
  
  #Creating "finder" variables (must be reset each time we select a new foragingResource level)
  hostFirstB <- TRUE
  pphFirstB <- TRUE
  hostFirstD <- TRUE
  pphFirstD <- TRUE
  hostFirstKcarryCap <- TRUE
  pphFirstKcarryCap <- TRUE
  hostFirstAlpha <- TRUE
  pphFirstAlpha <- TRUE
  hostFirstMuPositive <- TRUE
  pphFirstMuPositive <- TRUE
  hostFirstLambda <- TRUE
  pphFirstLambda <- TRUE
  hostFirstMuNegative <- TRUE
  pphFirstMuNegative <- TRUE

  #Creating empty vectors (must be reset each time we select a new foragingResource level)
  equilibriumH_StressB <- c()
  equilibriumP_StressB <- c()
  tmpStressB <- c()
  equilibriumNonForagingResource_StressB <- c()
  equilibriumForagingResource_StressB <- c()
  equilibriumH_NutritionB <- c()
  equilibriumP_NutritionB <- c()
  tmpNutritionB <- c()
  equilibriumNonForagingResource_NutritionB <- c()
  equilibriumForagingResource_NutritionB <- c()
  
  equilibriumH_NutritionD <- c()
  equilibriumP_NutritionD <- c()
  tmpNutritionD <- c()
  equilibriumNonForagingResource_NutritionD <- c()
  equilibriumForagingResource_NutritionD <- c()
  
  equilibriumH_StressKcarryCap <- c()
  equilibriumP_StressKcarryCap <- c()
  tmpStressKcarryCap <- c()
  equilibriumNonForagingResource_StressKcarryCap <- c()
  equilibriumForagingResource_StressKcarryCap <- c()
  equilibriumH_NutritionKcarryCap <- c()
  equilibriumP_NutritionKcarryCap <- c()
  tmpNutritionKcarryCap <- c()
  equilibriumNonForagingResource_NutritionKcarryCap <- c()
  equilibriumForagingResource_NutritionKcarryCap <- c()
  
  equilibriumH_NutritionAlpha <- c()
  equilibriumP_NutritionAlpha <- c()
  tmpNutritionAlpha <- c()
  equilibriumNonForagingResource_NutritionAlpha <- c()
  equilibriumForagingResource_NutritionAlpha <- c()
  
  equilibriumH_StressMuPositive <- c()
  equilibriumP_StressMuPositive <- c()
  tmpStressMuPositive <- c()
  equilibriumNonForagingResource_StressMuPositive <- c()
  equilibriumForagingResource_StressMuPositive <- c()
  
  equilibriumH_NutritionLambda <- c()
  equilibriumP_NutritionLambda <- c()
  tmpNutritionLambda <- c()
  equilibriumNonForagingResource_NutritionLambda <- c()
  equilibriumForagingResource_NutritionLambda <- c()
  
  equilibriumH_NutritionMuNegative <- c()
  equilibriumP_NutritionMuNegative <- c()
  tmpNutritionMuNegative <- c()
  equilibriumNonForagingResource_NutritionMuNegative <- c()
  equilibriumForagingResource_NutritionMuNegative <- c()
  
  #Creating "finder" variables (must be reset each time we select a new foragingResource level)
  hostFirstB_StrNut <- TRUE
  pphFirstB_StrNut <- TRUE
  hostFirstD_StrNut <- TRUE
  pphFirstD_StrNut <- TRUE
  hostFirstKcarryCap_StrNut <- TRUE
  pphFirstKcarryCap_StrNut <- TRUE
  hostFirstAlpha_StrNut <- TRUE
  pphFirstAlpha_StrNut <- TRUE
  hostFirstMuPositive_StrNut <- TRUE
  pphFirstMuPositive_StrNut <- TRUE
  hostFirstLambda_StrNut <- TRUE
  pphFirstLambda_StrNut <- TRUE
  hostFirstMuNegative_StrNut <- TRUE
  pphFirstMuNegative_StrNut <- TRUE
  
  for (i in 1:length(resource)){ #This will go through the loop for the length of the resource variable
    xstart <- c(H=69, P=1) #Resets the initial parameter values

#[NOTE: This only works when the DIRECTIONALITY of FORAGING and NON-FORAGING PARAMETERS are OPPOSITE]
#Allowing resources to effect non-foraging paramaters (b, d, and KcarryCap) improves the host population [Look at the % Change Effect of baseline]
#Therefore we must select the Resource Effect on Foraging parameters that has the OPPOSITE EFFECT
#There is a POSITIVE effect of resources on Foraging Parameters (beta & k) which is WORSE FOR HOSTS

    #Negative effect of Resources (beta & k) with Positive effect (b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as dataframe
    tmpNegativeB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params)) 
    #Save equilibrium values from temporary dataframe into vectors
    equilibriumH_NegativeB[length(equilibriumH_NegativeB)+1] <- tmpNegativeB$H[length(tmpNegativeB$H)]
    equilibriumP_NegativeB[length(equilibriumP_NegativeB)+1] <- tmpNegativeB$P[length(tmpNegativeB$P)]
    equilibriumForagingResource_NegativeB[length(equilibriumForagingResource_NegativeB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeB[length(equilibriumNonForagingResource_NegativeB)+1] <- resource[i]
    
    #Positive effect of Resources (beta & k & b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as datframe
    tmpPositiveB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_PositiveB[length(equilibriumH_PositiveB)+1] <- tmpPositiveB$H[length(tmpPositiveB$H)]
    equilibriumP_PositiveB[length(equilibriumP_PositiveB)+1] <- tmpPositiveB$P[length(tmpPositiveB$P)]
    equilibriumForagingResource_PositiveB[length(equilibriumForagingResource_PositiveB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_PositiveB[length(equilibriumNonForagingResource_PositiveB)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForB <- (equilibriumH_PositiveB[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForB <- (equilibriumH_PositiveB[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
      
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeB[1]/equilibriumH_NegativeB[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeB[i]/equilibriumH_NegativeB[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForB <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForB <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstB==TRUE & (sign(hostOriginalPctChangeForB)==-1 & hostCurrentPctChangeForB>0)){
      hostFirstB <- FALSE
      hostResourceBreakPointForB <- append(hostResourceBreakPointForB, resource[i])
      hostForagingResourceForB <- append(hostForagingResourceForB, foragingResource[j])
    } else if (hostFirstB==TRUE & (sign(hostOriginalPctChangeForB)==1 & hostCurrentPctChangeForB<0)){
      hostFirstB <- FALSE
      hostResourceBreakPointForB <- append(hostResourceBreakPointForB, resource[i])      
      hostForagingResourceForB <- append(hostForagingResourceForB, foragingResource[j])
    } else {
      hostResourceBreakPointForB <- hostResourceBreakPointForB
      hostForagingResourceForB <- hostForagingResourceForB
    }
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstB==TRUE & (sign(pphOriginalPctChangeForB)==-1 & pphCurrentPctChangeForB>0)){
      pphFirstB <- FALSE
      pphResourceBreakPointForB <- append(pphResourceBreakPointForB, resource[i])
      pphForagingResourceForB <- append(pphForagingResourceForB, foragingResource[j])
    } else if (pphFirstB==TRUE & (sign(pphOriginalPctChangeForB)==1 & pphCurrentPctChangeForB<0)){
      pphFirstB <- FALSE
      pphResourceBreakPointForB <- append(pphResourceBreakPointForB, resource[i])
      pphForagingResourceForB <- append(pphForagingResourceForB, foragingResource[j])
      } else {
      pphResourceBreakPointForB <- pphResourceBreakPointForB
      pphForagingResourceForB <- pphForagingResourceForB

    }
        
    #########################################################################################################################################
    
    #Negative effect of Resources (beta & k & d) 
    b=b0
    d=dr[i]
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeD <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeD[length(equilibriumH_NegativeD)+1] <- tmpNegativeD$H[length(tmpNegativeD$H)]
    equilibriumP_NegativeD[length(equilibriumP_NegativeD)+1] <- tmpNegativeD$P[length(tmpNegativeD$P)]
    equilibriumForagingResource_NegativeD[length(equilibriumForagingResource_NegativeD)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeD[length(equilibriumNonForagingResource_NegativeD)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForD <- (equilibriumH_NegativeD[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForD <- (equilibriumH_NegativeD[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeD[1]/equilibriumH_NegativeD[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeD[i]/equilibriumH_NegativeD[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForD <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForD <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstD==TRUE & (sign(hostOriginalPctChangeForD)==-1 & hostCurrentPctChangeForD>0)){
      hostFirstD <- FALSE
      hostResourceBreakPointForD <- append(hostResourceBreakPointForD, resource[i])
      hostForagingResourceForD <- append(hostForagingResourceForD, foragingResource[j])
      } else if (hostFirstD==TRUE & (sign(hostOriginalPctChangeForD)==1 & hostCurrentPctChangeForD<0)){
      hostFirstD <- FALSE
      hostResourceBreakPointForD <- append(hostResourceBreakPointForD, resource[i])
      hostForagingResourceForD <- append(hostForagingResourceForD, foragingResource[j])
      } else {
      hostResourceBreakPointForD <- hostResourceBreakPointForD
      hostForagingResourceForD <- hostForagingResourceForD
    }
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstD==TRUE & (sign(pphOriginalPctChangeForD)==-1 & pphCurrentPctChangeForD>0)){
      pphFirstD <- FALSE
      pphResourceBreakPointForD <- append(pphResourceBreakPointForD, resource[i])
      pphForagingResourceForD <- append(pphForagingResourceForD, foragingResource[j])
      } else if (pphFirstD==TRUE & (sign(pphOriginalPctChangeForD)==1 & pphCurrentPctChangeForD<0)){
      pphFirstD <- FALSE
      pphResourceBreakPointForD <- append(pphResourceBreakPointForD, resource[i])
      pphForagingResourceForD <- append(pphForagingResourceForD, foragingResource[j])
      } else {
      pphResourceBreakPointForD <- pphResourceBreakPointForD
      pphForagingResourceForD <- pphForagingResourceForD

    }
    
  #########################################################################################################################################
    
    #Positive effect of Resources (beta & k & KcarryCap)
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpPositiveKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_PositiveKcarryCap[length(equilibriumH_PositiveKcarryCap)+1] <- tmpPositiveKcarryCap$H[length(tmpPositiveKcarryCap$H)]
    equilibriumP_PositiveKcarryCap[length(equilibriumP_PositiveKcarryCap)+1] <- tmpPositiveKcarryCap$P[length(tmpPositiveKcarryCap$P)]
    equilibriumForagingResource_PositiveKcarryCap[length(equilibriumForagingResource_PositiveKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_PositiveKcarryCap[length(equilibriumNonForagingResource_PositiveKcarryCap)+1] <- resource[i]
    
    #Negative effect of Resources (beta & k) with Positive effect (KcarryCap) 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeKcarryCap[length(equilibriumH_NegativeKcarryCap)+1] <- tmpNegativeKcarryCap$H[length(tmpNegativeKcarryCap$H)]
    equilibriumP_NegativeKcarryCap[length(equilibriumP_NegativeKcarryCap)+1] <- tmpNegativeKcarryCap$P[length(tmpNegativeKcarryCap$P)]
    equilibriumForagingResource_NegativeKcarryCap[length(equilibriumForagingResource_NegativeKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeKcarryCap[length(equilibriumNonForagingResource_NegativeKcarryCap)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForKcarryCap <- (equilibriumH_PositiveKcarryCap[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForKcarryCap <- (equilibriumH_PositiveKcarryCap[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeKcarryCap[1]/equilibriumH_NegativeKcarryCap[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeKcarryCap[i]/equilibriumH_NegativeKcarryCap[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForKcarryCap <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForKcarryCap <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstKcarryCap==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==-1 & hostCurrentPctChangeForKcarryCap>0)){
      hostFirstKcarryCap <- FALSE
      hostResourceBreakPointForKcarryCap <- append(hostResourceBreakPointForKcarryCap, resource[i])
      hostForagingResourceForKcarryCap <- append(hostForagingResourceForKcarryCap, foragingResource[j])
      } else if (hostFirstKcarryCap==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==1 & hostCurrentPctChangeForKcarryCap<0)){
      hostFirstKcarryCap <- FALSE
      hostResourceBreakPointForKcarryCap <- append(hostResourceBreakPointForKcarryCap, resource[i])
      hostForagingResourceForKcarryCap <- append(hostForagingResourceForKcarryCap, foragingResource[j])
      } else {
      hostResourceBreakPointForKcarryCap <- hostResourceBreakPointForKcarryCap
      hostForagingResourceForKcarryCap <- hostForagingResourceForKcarryCap
      }
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstKcarryCap==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==-1 & pphCurrentPctChangeForKcarryCap>0)){
      pphFirstKcarryCap <- FALSE
      pphResourceBreakPointForKcarryCap <- append(pphResourceBreakPointForKcarryCap, resource[i])
      pphForagingResourceForKcarryCap <- append(pphForagingResourceForKcarryCap, foragingResource[j])
      } else if (pphFirstKcarryCap==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==1 & pphCurrentPctChangeForKcarryCap<0)){
      pphFirstKcarryCap <- FALSE
      pphResourceBreakPointForKcarryCap <- append(pphResourceBreakPointForKcarryCap, resource[i])
      pphForagingResourceForKcarryCap <- append(pphForagingResourceForKcarryCap, foragingResource[j])
      } else {
      pphResourceBreakPointForKcarryCap <- pphResourceBreakPointForKcarryCap
      pphForagingResourceForKcarryCap <- pphForagingResourceForKcarryCap
      }
  
  ########################################################################################################################################
    
    #Negative effect of Resources (beta, k, & alpha)
    b=b0
    d=d0
    alpha=alphar[i]
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeAlpha <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeAlpha[length(equilibriumH_NegativeAlpha)+1] <- tmpNegativeAlpha$H[length(tmpNegativeAlpha$H)]
    equilibriumP_NegativeAlpha[length(equilibriumP_NegativeAlpha)+1] <- tmpNegativeAlpha$P[length(tmpNegativeAlpha$P)]
    equilibriumForagingResource_NegativeAlpha[length(equilibriumForagingResource_NegativeAlpha)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeAlpha[length(equilibriumNonForagingResource_NegativeAlpha)+1] <- resource[i]
      
    #Checking percentage change
    hostOriginalPctChangeForAlpha <- (equilibriumH_NegativeAlpha[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForAlpha <- (equilibriumH_NegativeAlpha[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeAlpha[1]/equilibriumH_NegativeAlpha[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeAlpha[i]/equilibriumH_NegativeAlpha[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForAlpha <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForAlpha <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstAlpha==TRUE & (sign(hostOriginalPctChangeForAlpha)==-1 & hostCurrentPctChangeForAlpha>0)){
      hostFirstAlpha <- FALSE
      hostResourceBreakPointForAlpha <- append(hostResourceBreakPointForAlpha, resource[i])
      hostForagingResourceForAlpha <- append(hostForagingResourceForAlpha, foragingResource[j])
      } else if (hostFirstAlpha==TRUE & (sign(hostOriginalPctChangeForAlpha)==1 & hostCurrentPctChangeForAlpha<0)){
      hostFirstAlpha <- FALSE
      hostResourceBreakPointForAlpha <- append(hostResourceBreakPointForAlpha, resource[i])
      hostForagingResourceForAlpha <- append(hostForagingResourceForAlpha, foragingResource[j])
      } else {
      hostResourceBreakPointForAlpha <- hostResourceBreakPointForAlpha
      hostForagingResourceForAlpha <- hostForagingResourceForAlpha
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstAlpha==TRUE & (sign(pphOriginalPctChangeForAlpha)==-1 & pphCurrentPctChangeForAlpha>0)){
      pphFirstAlpha <- FALSE
      pphResourceBreakPointForAlpha <- append(pphResourceBreakPointForAlpha, resource[i])
      pphForagingResourceForAlpha <- append(pphForagingResourceForAlpha, foragingResource[j])
      } else if (pphFirstAlpha==TRUE & (sign(pphOriginalPctChangeForAlpha)==1 & pphCurrentPctChangeForAlpha<0)){
      pphFirstAlpha <- FALSE
      pphResourceBreakPointForAlpha <- append(pphResourceBreakPointForAlpha, resource[i])
      pphForagingResourceForAlpha <- append(pphForagingResourceForAlpha, foragingResource[j])
      } else {
      pphResourceBreakPointForAlpha <- pphResourceBreakPointForAlpha
      pphForagingResourceForAlpha <- pphForagingResourceForAlpha
    }
    
  ########################################################################################################################################
  
    #Positive effect of Resources (beta, k, & muPositive)
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=murPositive[i]
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpPositiveMuPositive <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_PositiveMuPositive[length(equilibriumH_PositiveMuPositive)+1] <- tmpPositiveMuPositive$H[length(tmpPositiveMuPositive$H)]
    equilibriumP_PositiveMuPositive[length(equilibriumP_PositiveMuPositive)+1] <- tmpPositiveMuPositive$P[length(tmpPositiveMuPositive$P)]
    equilibriumForagingResource_PositiveMuPositive[length(equilibriumForagingResource_PositiveMuPositive)+1] <- foragingResource[j]
    equilibriumNonForagingResource_PositiveMuPositive[length(equilibriumNonForagingResource_PositiveMuPositive)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForMuPositive <- (equilibriumH_PositiveMuPositive[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuPositive <- (equilibriumH_PositiveMuPositive[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_PositiveMuPositive[1]/equilibriumH_PositiveMuPositive[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_PositiveMuPositive[i]/equilibriumH_PositiveMuPositive[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuPositive <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuPositive <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuPositive==TRUE & (sign(hostOriginalPctChangeForMuPositive)==-1 & hostCurrentPctChangeForMuPositive>0)){
      hostFirstMuPositive <- FALSE
      hostResourceBreakPointForMuPositive <- append(hostResourceBreakPointForMuPositive, resource[i])
      hostForagingResourceForMuPositive <- append(hostForagingResourceForMuPositive, foragingResource[j])
      } else if (hostFirstMuPositive==TRUE & (sign(hostOriginalPctChangeForMuPositive)==1 & hostCurrentPctChangeForMuPositive<0)){
      hostFirstMuPositive <- FALSE
      hostResourceBreakPointForMuPositive <- append(hostResourceBreakPointForMuPositive, resource[i])
      hostForagingResourceForMuPositive <- append(hostForagingResourceForMuPositive, foragingResource[j])
      } else {
      hostResourceBreakPointForMuPositive <- hostResourceBreakPointForMuPositive      
      hostForagingResourceForMuPositive <- hostForagingResourceForMuPositive
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuPositive==TRUE & (sign(pphOriginalPctChangeForMuPositive)==-1 & pphCurrentPctChangeForMuPositive>0)){
      pphFirstMuPositive <- FALSE
      pphResourceBreakPointForMuPositive <- append(pphResourceBreakPointForMuPositive, resource[i])
      pphForagingResourceForMuPositive <- append(pphForagingResourceForMuPositive, foragingResource[j])
      } else if (pphFirstMuPositive==TRUE & (sign(pphOriginalPctChangeForMuPositive)==1 & pphCurrentPctChangeForMuPositive<0)){
      pphFirstMuPositive <- FALSE
      pphResourceBreakPointForMuPositive <- append(pphResourceBreakPointForMuPositive, resource[i])
      pphForagingResourceForMuPositive <- append(pphForagingResourceForMuPositive, foragingResource[j])
      } else {
      pphResourceBreakPointForMuPositive <- pphResourceBreakPointForMuPositive      
      pphForagingResourceForMuPositive <- pphForagingResourceForMuPositive
    }
    
  ########################################################################################################################################
    
    #Negative effect of Resources (beta & k & lambda) 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambdar[i]
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeLambda <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeLambda[length(equilibriumH_NegativeLambda)+1] <- tmpNegativeLambda$H[length(tmpNegativeLambda$H)]
    equilibriumP_NegativeLambda[length(equilibriumP_NegativeLambda)+1] <- tmpNegativeLambda$P[length(tmpNegativeLambda$P)]
    equilibriumForagingResource_NegativeLambda[length(equilibriumForagingResource_NegativeLambda)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeLambda[length(equilibriumNonForagingResource_NegativeLambda)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForLambda <- (equilibriumH_NegativeLambda[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForLambda <- (equilibriumH_NegativeLambda[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeLambda[1]/equilibriumH_NegativeLambda[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeLambda[i]/equilibriumH_NegativeLambda[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForLambda <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForLambda <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstLambda==TRUE & (sign(hostOriginalPctChangeForLambda)==-1 & hostCurrentPctChangeForLambda>0)){
      hostFirstLambda <- FALSE
      hostResourceBreakPointForLambda <- append(hostResourceBreakPointForLambda, resource[i])
      hostForagingResourceForLambda <- append(hostForagingResourceForLambda, foragingResource[j])
      } else if (hostFirstLambda==TRUE & (sign(hostOriginalPctChangeForLambda)==1 & hostCurrentPctChangeForLambda<0)){
      hostFirstLambda <- FALSE
      hostResourceBreakPointForLambda <- append(hostResourceBreakPointForLambda, resource[i])
      hostForagingResourceForLambda <- append(hostForagingResourceForLambda, foragingResource[j])
      } else {
      hostResourceBreakPointForLambda <- hostResourceBreakPointForLambda      
      hostForagingResourceForLambda <- hostForagingResourceForLambda
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstLambda==TRUE & (sign(pphOriginalPctChangeForLambda)==-1 & pphCurrentPctChangeForLambda>0)){
      pphFirstLambda <- FALSE
      pphResourceBreakPointForLambda <- append(pphResourceBreakPointForLambda, resource[i])
      pphForagingResourceForLambda <- append(pphForagingResourceForLambda, foragingResource[j])
      } else if (pphFirstLambda==TRUE & (sign(pphOriginalPctChangeForLambda)==1 & pphCurrentPctChangeForLambda<0)){
      pphFirstLambda <- FALSE
      pphResourceBreakPointForLambda <- append(pphResourceBreakPointForLambda, resource[i])
      pphForagingResourceForLambda <- append(pphForagingResourceForLambda, foragingResource[j])
      } else {
      pphResourceBreakPointForLambda<- pphResourceBreakPointForLambda     
      pphForagingResourceForLambda <- pphForagingResourceForLambda
    }
    
  ########################################################################################################################################
    
    #Negative effect of Resources (beta & k & muNegative) 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=murNegative[i]
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNegativeMuNegative <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NegativeMuNegative[length(equilibriumH_NegativeMuNegative)+1] <- tmpNegativeMuNegative$H[length(tmpNegativeMuNegative$H)]
    equilibriumP_NegativeMuNegative[length(equilibriumP_NegativeMuNegative)+1] <- tmpNegativeMuNegative$P[length(tmpNegativeMuNegative$P)]
    equilibriumForagingResource_NegativeMuNegative[length(equilibriumForagingResource_NegativeMuNegative)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NegativeMuNegative[length(equilibriumNonForagingResource_NegativeMuNegative)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForMuNegative <- (equilibriumH_NegativeMuNegative[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuNegative <- (equilibriumH_NegativeMuNegative[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NegativeMuNegative[1]/equilibriumH_NegativeMuNegative[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NegativeMuNegative[i]/equilibriumH_NegativeMuNegative[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuNegative <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuNegative <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuNegative==TRUE & (sign(hostOriginalPctChangeForMuNegative)== -1 & hostCurrentPctChangeForMuNegative>0)){
      hostFirstMuNegative <- FALSE
      hostResourceBreakPointForMuNegative <- append(hostResourceBreakPointForMuNegative, resource[i])
      hostForagingResourceForMuNegative <- append(hostForagingResourceForMuNegative, foragingResource[j])
      } else if (hostFirstMuNegative==TRUE & (sign(hostOriginalPctChangeForMuNegative)== 1 & hostCurrentPctChangeForMuNegative<0)){
      hostFirstMuNegative <- FALSE
      hostResourceBreakPointForMuNegative <- append(hostResourceBreakPointForMuNegative, resource[i])
      hostForagingResourceForMuNegative <- append(hostForagingResourceForMuNegative, foragingResource[j])
      } else {
      hostResourceBreakPointForMuNegative <- hostResourceBreakPointForMuNegative      
      hostForagingResourceForMuNegative <- hostForagingResourceForMuNegative
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuNegative==TRUE & (sign(pphOriginalPctChangeForMuNegative)== -1 & pphCurrentPctChangeForMuNegative>0)){
      pphFirstMuNegative <- FALSE
      pphResourceBreakPointForMuNegative  <- append(pphResourceBreakPointForMuNegative , resource[i])
      pphForagingResourceForMuNegative  <- append(pphForagingResourceForMuNegative , foragingResource[j])
      } else if (pphFirstMuNegative==TRUE & (sign(pphOriginalPctChangeForMuNegative)== 1 & pphCurrentPctChangeForMuNegative<0)){
      pphFirstMuNegative <- FALSE
      pphResourceBreakPointForMuNegative  <- append(pphResourceBreakPointForMuNegative , resource[i])
      pphForagingResourceForMuNegative  <- append(pphForagingResourceForMuNegative , foragingResource[j])
      } else {
      pphResourceBreakPointForMuNegative <- pphResourceBreakPointForMuNegative      
      pphForagingResourceForMuNegative  <- pphForagingResourceForMuNegative 
      }
    
    
    
    
    #Stress effect of Resources (beta+ k-) with Positive effect (b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as dataframe
    tmpStressB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params)) 
    #Save equilibrium values from temporary dataframe into vectors
    equilibriumH_StressB[length(equilibriumH_StressB)+1] <- tmpStressB$H[length(tmpStressB$H)]
    equilibriumP_StressB[length(equilibriumP_StressB)+1] <- tmpStressB$P[length(tmpStressB$P)]
    equilibriumForagingResource_StressB[length(equilibriumForagingResource_StressB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_StressB[length(equilibriumNonForagingResource_StressB)+1] <- resource[i]
    
    #Nutrition effect of Resources (beta- & k+) and positive effect (b)
    b=br[i]
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    #Run ordinary diff eq solver and save as datframe
    tmpNutritionB <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionB[length(equilibriumH_NutritionB)+1] <- tmpNutritionB$H[length(tmpNutritionB$H)]
    equilibriumP_NutritionB[length(equilibriumP_NutritionB)+1] <- tmpNutritionB$P[length(tmpNutritionB$P)]
    equilibriumForagingResource_NutritionB[length(equilibriumForagingResource_NutritionB)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionB[length(equilibriumNonForagingResource_NutritionB)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForB <- (equilibriumH_StressB[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForB <- (equilibriumH_StressB[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
      
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionB[1]/equilibriumH_NutritionB[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionB[i]/equilibriumH_NutritionB[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForB <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForB <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstB_StrNut==TRUE & (sign(hostOriginalPctChangeForB)==-1 & hostCurrentPctChangeForB>0)){
      hostFirstB_StrNut <- FALSE
      hostResourceBreakPointForB_StrNut <- append(hostResourceBreakPointForB_StrNut, resource[i])
      hostForagingResourceForB_StrNut <- append(hostForagingResourceForB_StrNut, foragingResource[j])
    } else if (hostFirstB_StrNut==TRUE & (sign(hostOriginalPctChangeForB)==1 & hostCurrentPctChangeForB<0)){
      hostFirstB_StrNut <- FALSE
      hostResourceBreakPointForB_StrNut <- append(hostResourceBreakPointForB_StrNut, resource[i])      
      hostForagingResourceForB_StrNut <- append(hostForagingResourceForB_StrNut, foragingResource[j])
    } else {
      hostResourceBreakPointForB_StrNut <- hostResourceBreakPointForB_StrNut
      hostForagingResourceForB_StrNut <- hostForagingResourceForB_StrNut
    }
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstB_StrNut==TRUE & (sign(pphOriginalPctChangeForB)==-1 & pphCurrentPctChangeForB>0)){
      pphFirstB_StrNut <- FALSE
      pphResourceBreakPointForB_StrNut <- append(pphResourceBreakPointForB_StrNut, resource[i])
      pphForagingResourceForB_StrNut <- append(pphForagingResourceForB_StrNut, foragingResource[j])
    } else if (pphFirstB_StrNut==TRUE & (sign(pphOriginalPctChangeForB)==1 & pphCurrentPctChangeForB<0)){
      pphFirstB_StrNut <- FALSE
      pphResourceBreakPointForB_StrNut <- append(pphResourceBreakPointForB_StrNut, resource[i])
      pphForagingResourceForB_StrNut <- append(pphForagingResourceForB_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForB_StrNut <- pphResourceBreakPointForB_StrNut
      pphForagingResourceForB_StrNut <- pphForagingResourceForB_StrNut

    }
        
    #########################################################################################################################################
    
    #Nutrition effect of Resources (beta- & k+) and negative effect of d 
    b=b0
    d=dr[i]
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionD <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionD[length(equilibriumH_NutritionD)+1] <- tmpNutritionD$H[length(tmpNutritionD$H)]
    equilibriumP_NutritionD[length(equilibriumP_NutritionD)+1] <- tmpNutritionD$P[length(tmpNutritionD$P)]
    equilibriumForagingResource_NutritionD[length(equilibriumForagingResource_NutritionD)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionD[length(equilibriumNonForagingResource_NutritionD)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForD <- (equilibriumH_NutritionD[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForD <- (equilibriumH_NutritionD[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionD[1]/equilibriumH_NutritionD[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionD[i]/equilibriumH_NutritionD[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForD <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForD <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
  
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstD_StrNut==TRUE & (sign(hostOriginalPctChangeForD)==-1 & hostCurrentPctChangeForD>0)){
      hostFirstD_StrNut <- FALSE
      hostResourceBreakPointForD_StrNut <- append(hostResourceBreakPointForD_StrNut, resource[i])
      hostForagingResourceForD_StrNut <- append(hostForagingResourceForD_StrNut, foragingResource[j])
      } else if (hostFirstD_StrNut==TRUE & (sign(hostOriginalPctChangeForD)==1 & hostCurrentPctChangeForD<0)){
      hostFirstD_StrNut <- FALSE
      hostResourceBreakPointForD_StrNut <- append(hostResourceBreakPointForD_StrNut, resource[i])
      hostForagingResourceForD_StrNut <- append(hostForagingResourceForD_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForD_StrNut <- hostResourceBreakPointForD_StrNut
      hostForagingResourceForD_StrNut <- hostForagingResourceForD_StrNut
    }
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstD_StrNut==TRUE & (sign(pphOriginalPctChangeForD)==-1 & pphCurrentPctChangeForD>0)){
      pphFirstD_StrNut <- FALSE
      pphResourceBreakPointForD_StrNut <- append(pphResourceBreakPointForD_StrNut, resource[i])
      pphForagingResourceForD_StrNut <- append(pphForagingResourceForD_StrNut, foragingResource[j])
      } else if (pphFirstD_StrNut==TRUE & (sign(pphOriginalPctChangeForD)==1 & pphCurrentPctChangeForD<0)){
      pphFirstD_StrNut <- FALSE
      pphResourceBreakPointForD_StrNut <- append(pphResourceBreakPointForD_StrNut, resource[i])
      pphForagingResourceForD_StrNut <- append(pphForagingResourceForD_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForD_StrNut <- pphResourceBreakPointForD_StrNut
      pphForagingResourceForD_StrNut <- pphForagingResourceForD_StrNut

    }
    
  #########################################################################################################################################
    
    #Stress effect of Resources (beta+ & k-) with positive effect of KcarryCap
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krNegative[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpStressKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_StressKcarryCap[length(equilibriumH_StressKcarryCap)+1] <- tmpStressKcarryCap$H[length(tmpStressKcarryCap$H)]
    equilibriumP_StressKcarryCap[length(equilibriumP_StressKcarryCap)+1] <- tmpStressKcarryCap$P[length(tmpStressKcarryCap$P)]
    equilibriumForagingResource_StressKcarryCap[length(equilibriumForagingResource_StressKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_StressKcarryCap[length(equilibriumNonForagingResource_StressKcarryCap)+1] <- resource[i]
    
    #Nutrition effect of Resources (beta+ & k-) with positive effect of KcarryCap
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCapr[i]
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionKcarryCap <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionKcarryCap[length(equilibriumH_NutritionKcarryCap)+1] <- tmpNutritionKcarryCap$H[length(tmpNutritionKcarryCap$H)]
    equilibriumP_NutritionKcarryCap[length(equilibriumP_NutritionKcarryCap)+1] <- tmpNutritionKcarryCap$P[length(tmpNutritionKcarryCap$P)]
    equilibriumForagingResource_NutritionKcarryCap[length(equilibriumForagingResource_NutritionKcarryCap)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionKcarryCap[length(equilibriumNonForagingResource_NutritionKcarryCap)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForKcarryCap <- (equilibriumH_StressKcarryCap[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForKcarryCap <- (equilibriumH_StressKcarryCap[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    #NOTE: KcarryCap is incapable of counteracting the effects of Nutrition or Stress on Parasites per Host (they share directionality)
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionKcarryCap[1]/equilibriumH_NutritionKcarryCap[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionKcarryCap[i]/equilibriumH_NutritionKcarryCap[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForKcarryCap <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForKcarryCap <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    
    
    
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstKcarryCap_StrNut==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==-1 & hostCurrentPctChangeForKcarryCap>0)){
      hostFirstKcarryCap_StrNut <- FALSE
      hostResourceBreakPointForKcarryCap_StrNut <- append(hostResourceBreakPointForKcarryCap_StrNut, resource[i])
      hostForagingResourceForKcarryCap_StrNut <- append(hostForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else if (hostFirstKcarryCap_StrNut==TRUE & (sign(hostOriginalPctChangeForKcarryCap)==1 & hostCurrentPctChangeForKcarryCap<0)){
      hostFirstKcarryCap_StrNut <- FALSE
      hostResourceBreakPointForKcarryCap_StrNut <- append(hostResourceBreakPointForKcarryCap_StrNut, resource[i])
      hostForagingResourceForKcarryCap_StrNut <- append(hostForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForKcarryCap_StrNut <- hostResourceBreakPointForKcarryCap_StrNut
      hostForagingResourceForKcarryCap_StrNut <- hostForagingResourceForKcarryCap_StrNut
      }
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstKcarryCap_StrNut==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==-1 & pphCurrentPctChangeForKcarryCap>0)){
      pphFirstKcarryCap_StrNut <- FALSE
      pphResourceBreakPointForKcarryCap_StrNut <- append(pphResourceBreakPointForKcarryCap_StrNut, resource[i])
      pphForagingResourceForKcarryCap_StrNut <- append(pphForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else if (pphFirstKcarryCap_StrNut==TRUE & (sign(pphOriginalPctChangeForKcarryCap)==1 & pphCurrentPctChangeForKcarryCap<0)){
      pphFirstKcarryCap_StrNut <- FALSE
      pphResourceBreakPointForKcarryCap_StrNut <- append(pphResourceBreakPointForKcarryCap_StrNut, resource[i])
      pphForagingResourceForKcarryCap_StrNut <- append(pphForagingResourceForKcarryCap_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForKcarryCap_StrNut <- pphResourceBreakPointForKcarryCap_StrNut
      pphForagingResourceForKcarryCap_StrNut <- pphForagingResourceForKcarryCap_StrNut
    }
    
  
  ########################################################################################################################################
    
    #Nutrition effect of Resources (beta- and k+) with negative effect of alpha
    b=b0
    d=d0
    alpha=alphar[i]
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionAlpha <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionAlpha[length(equilibriumH_NutritionAlpha)+1] <- tmpNutritionAlpha$H[length(tmpNutritionAlpha$H)]
    equilibriumP_NutritionAlpha[length(equilibriumP_NutritionAlpha)+1] <- tmpNutritionAlpha$P[length(tmpNutritionAlpha$P)]
    equilibriumForagingResource_NutritionAlpha[length(equilibriumForagingResource_NutritionAlpha)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionAlpha[length(equilibriumNonForagingResource_NutritionAlpha)+1] <- resource[i]
      
    #Checking percentage change
    hostOriginalPctChangeForAlpha <- (equilibriumH_NutritionAlpha[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForAlpha <- (equilibriumH_NutritionAlpha[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionAlpha[1]/equilibriumH_NutritionAlpha[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionAlpha[i]/equilibriumH_NutritionAlpha[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForAlpha <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForAlpha <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstAlpha_StrNut==TRUE & (sign(hostOriginalPctChangeForAlpha)==-1 & hostCurrentPctChangeForAlpha>0)){
      hostFirstAlpha_StrNut <- FALSE
      hostResourceBreakPointForAlpha_StrNut <- append(hostResourceBreakPointForAlpha_StrNut, resource[i])
      hostForagingResourceForAlpha_StrNut <- append(hostForagingResourceForAlpha_StrNut, foragingResource[j])
      } else if (hostFirstAlpha_StrNut==TRUE & (sign(hostOriginalPctChangeForAlpha)==1 & hostCurrentPctChangeForAlpha<0)){
      hostFirstAlpha_StrNut <- FALSE
      hostResourceBreakPointForAlpha_StrNut <- append(hostResourceBreakPointForAlpha_StrNut, resource[i])
      hostForagingResourceForAlpha_StrNut <- append(hostForagingResourceForAlpha_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForAlpha_StrNut <- hostResourceBreakPointForAlpha_StrNut
      hostForagingResourceForAlpha_StrNut <- hostForagingResourceForAlpha_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstAlpha_StrNut==TRUE & (sign(pphOriginalPctChangeForAlpha)==-1 & pphCurrentPctChangeForAlpha>0)){
      pphFirstAlpha_StrNut <- FALSE
      pphResourceBreakPointForAlpha_StrNut <- append(pphResourceBreakPointForAlpha_StrNut, resource[i])
      pphForagingResourceForAlpha_StrNut <- append(pphForagingResourceForAlpha_StrNut, foragingResource[j])
      } else if (pphFirstAlpha_StrNut==TRUE & (sign(pphOriginalPctChangeForAlpha)==1 & pphCurrentPctChangeForAlpha<0)){
      pphFirstAlpha_StrNut <- FALSE
      pphResourceBreakPointForAlpha_StrNut <- append(pphResourceBreakPointForAlpha_StrNut, resource[i])
      pphForagingResourceForAlpha_StrNut <- append(pphForagingResourceForAlpha_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForAlpha_StrNut <- pphResourceBreakPointForAlpha_StrNut
      pphForagingResourceForAlpha_StrNut <- pphForagingResourceForAlpha_StrNut
    }
    
  ########################################################################################################################################
  
    #Stress effect of Resources (beta+ and k-) with positive effect muPositive
    b=b0
    d=d0
    alpha=alpha0
    beta=betarPositive[j]
    lambda=lambda0
    gamma=gamma0
    mu=murPositive[i]
    k=krNegative[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpStressMuPositive <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_StressMuPositive[length(equilibriumH_StressMuPositive)+1] <- tmpStressMuPositive$H[length(tmpStressMuPositive$H)]
    equilibriumP_StressMuPositive[length(equilibriumP_StressMuPositive)+1] <- tmpStressMuPositive$P[length(tmpStressMuPositive$P)]
    equilibriumForagingResource_StressMuPositive[length(equilibriumForagingResource_StressMuPositive)+1] <- foragingResource[j]
    equilibriumNonForagingResource_StressMuPositive[length(equilibriumNonForagingResource_StressMuPositive)+1] <- resource[i]
    
    #Checking percentage change
    hostOriginalPctChangeForMuPositive <- (equilibriumH_StressMuPositive[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuPositive <- (equilibriumH_StressMuPositive[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_StressMuPositive[1]/equilibriumH_StressMuPositive[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_StressMuPositive[i]/equilibriumH_StressMuPositive[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuPositive <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuPositive <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuPositive_StrNut==TRUE & (sign(hostOriginalPctChangeForMuPositive)==-1 & hostCurrentPctChangeForMuPositive>0)){
      hostFirstMuPositive_StrNut <- FALSE
      hostResourceBreakPointForMuPositive_StrNut <- append(hostResourceBreakPointForMuPositive_StrNut, resource[i])
      hostForagingResourceForMuPositive_StrNut <- append(hostForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else if (hostFirstMuPositive_StrNut==TRUE & (sign(hostOriginalPctChangeForMuPositive)==1 & hostCurrentPctChangeForMuPositive<0)){
      hostFirstMuPositive_StrNut <- FALSE
      hostResourceBreakPointForMuPositive_StrNut <- append(hostResourceBreakPointForMuPositive_StrNut, resource[i])
      hostForagingResourceForMuPositive_StrNut <- append(hostForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForMuPositive_StrNut <- hostResourceBreakPointForMuPositive_StrNut      
      hostForagingResourceForMuPositive_StrNut <- hostForagingResourceForMuPositive_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuPositive_StrNut==TRUE & (sign(pphOriginalPctChangeForMuPositive)==-1 & pphCurrentPctChangeForMuPositive>0)){
      pphFirstMuPositive_StrNut <- FALSE
      pphResourceBreakPointForMuPositive_StrNut <- append(pphResourceBreakPointForMuPositive_StrNut, resource[i])
      pphForagingResourceForMuPositive_StrNut <- append(pphForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else if (pphFirstMuPositive_StrNut==TRUE & (sign(pphOriginalPctChangeForMuPositive)==1 & pphCurrentPctChangeForMuPositive<0)){
      pphFirstMuPositive_StrNut <- FALSE
      pphResourceBreakPointForMuPositive_StrNut <- append(pphResourceBreakPointForMuPositive_StrNut, resource[i])
      pphForagingResourceForMuPositive_StrNut <- append(pphForagingResourceForMuPositive_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForMuPositive_StrNut <- pphResourceBreakPointForMuPositive_StrNut      
      pphForagingResourceForMuPositive_StrNut <- pphForagingResourceForMuPositive_StrNut
    }
    
  ########################################################################################################################################
    
    #NOTE: Lambda is incapable of counteracting the effects of Nutrition or Stress (they share directionality)
#Nutrition effect of Resources (beta- and k+) with negative effect of Lambda 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambdar[i]
    gamma=gamma0
    mu=mu0
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionLambda <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionLambda[length(equilibriumH_NutritionLambda)+1] <- tmpNutritionLambda$H[length(tmpNutritionLambda$H)]
    equilibriumP_NutritionLambda[length(equilibriumP_NutritionLambda)+1] <- tmpNutritionLambda$P[length(tmpNutritionLambda$P)]
    equilibriumForagingResource_NutritionLambda[length(equilibriumForagingResource_NutritionLambda)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionLambda[length(equilibriumNonForagingResource_NutritionLambda)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForLambda <- (equilibriumH_NutritionLambda[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForLambda <- (equilibriumH_NutritionLambda[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionLambda[1]/equilibriumH_NutritionLambda[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionLambda[i]/equilibriumH_NutritionLambda[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForLambda <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForLambda <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstLambda_StrNut==TRUE & (sign(hostOriginalPctChangeForLambda)== -1 & hostCurrentPctChangeForLambda>0)){
      hostFirstLambda_StrNut <- FALSE
      hostResourceBreakPointForLambda_StrNut <- append(hostResourceBreakPointForLambda_StrNut, resource[i])
      hostForagingResourceForLambda_StrNut <- append(hostForagingResourceForLambda_StrNut, foragingResource[j])
      } else if (hostFirstLambda_StrNut==TRUE & (sign(hostOriginalPctChangeForLambda)== 1 & hostCurrentPctChangeForLambda<0)){
      hostFirstLambda_StrNut <- FALSE
      hostResourceBreakPointForLambda_StrNut <- append(hostResourceBreakPointForLambda_StrNut, resource[i])
      hostForagingResourceForLambda_StrNut <- append(hostForagingResourceForLambda_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForLambda_StrNut <- hostResourceBreakPointForLambda_StrNut      
      hostForagingResourceForLambda_StrNut <- hostForagingResourceForLambda_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstLambda_StrNut==TRUE & (sign(pphOriginalPctChangeForLambda)== -1 & pphCurrentPctChangeForLambda>0)){
      pphFirstLambda_StrNut <- FALSE
      pphResourceBreakPointForLambda_StrNut <- append(pphResourceBreakPointForLambda_StrNut, resource[i])
      pphForagingResourceForLambda_StrNut <- append(pphForagingResourceForLambda_StrNut, foragingResource[j])
      } else if (pphFirstLambda_StrNut==TRUE & (sign(pphOriginalPctChangeForLambda)== 1 & pphCurrentPctChangeForLambda<0)){
      pphFirstLambda_StrNut <- FALSE
      pphResourceBreakPointForLambda_StrNut <- append(pphResourceBreakPointForLambda_StrNut, resource[i])
      pphForagingResourceForLambda_StrNut <- append(pphForagingResourceForLambda_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForLambda_StrNut <- pphResourceBreakPointForLambda_StrNut      
      pphForagingResourceForLambda_StrNut  <- pphForagingResourceForLambda_StrNut 
    }
        
  ########################################################################################################################################
    
    #Nutrition effect of Resources (beta- and k+) with negative effect of muNegative 
    b=b0
    d=d0
    alpha=alpha0
    beta=betarNegative[j]
    lambda=lambda0
    gamma=gamma0
    mu=murNegative[i]
    k=krPositive[j]
    KcarryCap = KcarryCap0
    #Creating parameters & running model
    params <- c(b, d, alpha, beta, lambda, gamma, mu, k, KcarryCap)
    tmpNutritionMuNegative <- as.data.frame(ode(xstart, time, macroParasiteLogistic, params))
    equilibriumH_NutritionMuNegative[length(equilibriumH_NutritionMuNegative)+1] <- tmpNutritionMuNegative$H[length(tmpNutritionMuNegative$H)]
    equilibriumP_NutritionMuNegative[length(equilibriumP_NutritionMuNegative)+1] <- tmpNutritionMuNegative$P[length(tmpNutritionMuNegative$P)]
    equilibriumForagingResource_NutritionMuNegative[length(equilibriumForagingResource_NutritionMuNegative)+1] <- foragingResource[j]
    equilibriumNonForagingResource_NutritionMuNegative[length(equilibriumNonForagingResource_NutritionMuNegative)+1] <- resource[i]
        
    #Checking percentage change
    hostOriginalPctChangeForMuNegative <- (equilibriumH_NutritionMuNegative[1]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    hostCurrentPctChangeForMuNegative <- (equilibriumH_NutritionMuNegative[i]-equilibriumH_Baseline[1])/equilibriumH_Baseline[1]*100
    
    pphOriginalPctChangeTerm1 <- equilibriumP_NutritionMuNegative[1]/equilibriumH_NutritionMuNegative[1]
    pphOriginalPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphOriginalPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphCurrentPctChangeTerm1 <- equilibriumP_NutritionMuNegative[i]/equilibriumH_NutritionMuNegative[i]
    pphCurrentPctChangeTerm2 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    pphCurrentPctChangeTerm3 <- equilibriumP_Baseline[1]/equilibriumH_Baseline[1]
    
    pphOriginalPctChangeForMuNegative <- (pphOriginalPctChangeTerm1-pphOriginalPctChangeTerm2)/pphOriginalPctChangeTerm3*100
    pphCurrentPctChangeForMuNegative <- (pphCurrentPctChangeTerm1-pphCurrentPctChangeTerm2)/pphCurrentPctChangeTerm3*100
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (hostFirstMuNegative_StrNut==TRUE & (sign(hostOriginalPctChangeForMuNegative)== -1 & hostCurrentPctChangeForMuNegative>0)){
      hostFirstMuNegative_StrNut <- FALSE
      hostResourceBreakPointForMuNegative_StrNut <- append(hostResourceBreakPointForMuNegative_StrNut, resource[i])
      hostForagingResourceForMuNegative_StrNut <- append(hostForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else if (hostFirstMuNegative_StrNut==TRUE & (sign(hostOriginalPctChangeForMuNegative)== 1 & hostCurrentPctChangeForMuNegative<0)){
      hostFirstMuNegative_StrNut <- FALSE
      hostResourceBreakPointForMuNegative_StrNut <- append(hostResourceBreakPointForMuNegative_StrNut, resource[i])
      hostForagingResourceForMuNegative_StrNut <- append(hostForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else {
      hostResourceBreakPointForMuNegative_StrNut <- hostResourceBreakPointForMuNegative_StrNut      
      hostForagingResourceForMuNegative_StrNut <- hostForagingResourceForMuNegative_StrNut
    } 
    
    #If statement to check when the nonforaging parameter is able to "undo or overpower" the foraging parameters effect
    if (pphFirstMuNegative_StrNut==TRUE & (sign(pphOriginalPctChangeForMuNegative)== -1 & pphCurrentPctChangeForMuNegative>0)){
      pphFirstMuNegative_StrNut <- FALSE
      pphResourceBreakPointForMuNegative_StrNut <- append(pphResourceBreakPointForMuNegative_StrNut, resource[i])
      pphForagingResourceForMuNegative_StrNut <- append(pphForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else if (pphFirstMuNegative_StrNut==TRUE & (sign(pphOriginalPctChangeForMuNegative)== 1 & pphCurrentPctChangeForMuNegative<0)){
      pphFirstMuNegative_StrNut <- FALSE
      pphResourceBreakPointForMuNegative_StrNut <- append(pphResourceBreakPointForMuNegative_StrNut, resource[i])
      pphForagingResourceForMuNegative_StrNut <- append(pphForagingResourceForMuNegative_StrNut, foragingResource[j])
      } else {
      pphResourceBreakPointForMuNegative_StrNut <- pphResourceBreakPointForMuNegative_StrNut      
      pphForagingResourceForMuNegative_StrNut  <- pphForagingResourceForMuNegative_StrNut 
    }
  
  }
  
}

```

```{r - Creating datasets NUTRITION/STRESS}
#Ranked by nonForagingParameter alphabetization (because we graph our values by NFP for legend)
bShape <- 0
dShape <- 2
KcarryCapShape <- 1
AlphaShape <- 6
MuPositiveShape <- 5
LambdaShape <- 3
MuNegativeShape <- 4

#Creating dataframes for hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #resourceBreakPoints = amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #foragingResourceLevel = amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

#Selecting every n-th value from parameters that have too many points for graphing (we can no longer see the linear regression line)
vectorValueSimplifier <- function(vector, stepSize){
  vector[seq(1, length(vector), by=stepSize)]
}

#Hosts (b, lambda, mu-, mu+, Hmax)
hostResourceBreakPointForBSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForB_StrNut, 4) 
hostForagingResourceForBSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForB_StrNut, 4)
hostResourceBreakPointForKcarryCapSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForKcarryCap_StrNut, 3) 
hostForagingResourceForKcarryCapSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForKcarryCap_StrNut, 3)
hostResourceBreakPointForMuPositiveSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForMuPositive_StrNut, 4)
hostForagingResourceForMuPositiveSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForMuPositive_StrNut, 4)
hostResourceBreakPointForLambdaSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForLambda_StrNut, 4) 
hostForagingResourceForLambdaSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForLambda_StrNut, 4) 
hostResourceBreakPointForMuNegativeSimple_StrNut <- vectorValueSimplifier(hostResourceBreakPointForMuNegative_StrNut, 2)
hostForagingResourceForMuNegativeSimple_StrNut <- vectorValueSimplifier(hostForagingResourceForMuNegative_StrNut, 2)

#Parasites per Host (Hmax, lambda, mu-, mu+)
pphResourceBreakPointForDSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForD_StrNut, 2)
pphForagingResourceForDSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForD_StrNut, 2)
pphResourceBreakPointForAlphaSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForAlpha_StrNut, 2)
pphForagingResourceForAlphaSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForAlpha_StrNut, 2)

pphResourceBreakPointForKcarryCapSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForKcarryCap_StrNut, 4)
pphForagingResourceForKcarryCapSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForKcarryCap_StrNut, 4)
pphResourceBreakPointForLambdaSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForLambda_StrNut, 4)
pphForagingResourceForLambdaSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForLambda_StrNut, 4)
pphResourceBreakPointForMuNegativeSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForMuNegative_StrNut, 2)
pphForagingResourceForMuNegativeSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForMuNegative_StrNut, 2)
pphResourceBreakPointForMuPositiveSimple_StrNut <- vectorValueSimplifier(pphResourceBreakPointForMuPositive_StrNut, 4)
pphForagingResourceForMuPositiveSimple_StrNut <- vectorValueSimplifier(pphForagingResourceForMuPositive_StrNut, 4)




hostDataAll_StrNut <- data.frame(resourceBreakPoints=c(hostResourceBreakPointForBSimple_StrNut, hostResourceBreakPointForD_StrNut, hostResourceBreakPointForKcarryCapSimple_StrNut, hostResourceBreakPointForAlpha_StrNut, hostResourceBreakPointForMuPositiveSimple_StrNut, hostResourceBreakPointForLambdaSimple_StrNut, hostResourceBreakPointForMuNegativeSimple_StrNut),
                          foragingResourceLevel=c(hostForagingResourceForBSimple_StrNut, hostForagingResourceForD_StrNut, hostForagingResourceForKcarryCapSimple_StrNut, hostForagingResourceForAlpha_StrNut, hostForagingResourceForMuPositiveSimple_StrNut, hostForagingResourceForLambdaSimple_StrNut, hostForagingResourceForMuNegativeSimple_StrNut), 
                          nonForagingParameter=c(rep("Host Birth Rate", times=length(hostResourceBreakPointForBSimple_StrNut)), rep("Host Natural Mortality", times=length(hostResourceBreakPointForD_StrNut)), rep("Host Carrying Capacity", times=length(hostResourceBreakPointForKcarryCapSimple_StrNut)), rep("Parasite Virulence", times=length(hostResourceBreakPointForAlpha_StrNut)), rep("Parasite Mortality+", times=length(hostResourceBreakPointForMuPositiveSimple_StrNut)), rep("Parasite Egg Production", times=length(hostResourceBreakPointForLambdaSimple_StrNut)), rep("Parasite Mortality-", times=length(hostResourceBreakPointForMuNegativeSimple_StrNut))),
                          NNP=c(rep("Stress", times=length(hostResourceBreakPointForBSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForD_StrNut)), rep("Stress", times=length(hostResourceBreakPointForKcarryCapSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForAlpha_StrNut)), rep("Stress", times=length(hostResourceBreakPointForMuPositiveSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForLambdaSimple_StrNut)), rep("Nutrition", times=length(hostResourceBreakPointForMuNegativeSimple_StrNut))),
                          pointShape=c(rep(bShape, times=length(hostResourceBreakPointForBSimple_StrNut)), rep(dShape, times=length(hostResourceBreakPointForD_StrNut)), rep(KcarryCapShape, times=length(hostResourceBreakPointForKcarryCapSimple_StrNut)), rep(AlphaShape, times=length(hostResourceBreakPointForAlpha_StrNut)), rep(MuPositiveShape, times=length(hostResourceBreakPointForMuPositiveSimple_StrNut)), rep(LambdaShape, times=length(hostResourceBreakPointForLambdaSimple_StrNut)), rep(MuNegativeShape, times=length(hostResourceBreakPointForMuNegativeSimple_StrNut)))
                       )

pphDataAll_StrNut <- data.frame(resourceBreakPoints=c(pphResourceBreakPointForB_StrNut, pphResourceBreakPointForDSimple_StrNut, pphResourceBreakPointForKcarryCapSimple_StrNut, pphResourceBreakPointForAlphaSimple_StrNut, pphResourceBreakPointForMuPositiveSimple_StrNut, pphResourceBreakPointForLambdaSimple_StrNut, pphResourceBreakPointForMuNegativeSimple_StrNut),
                       foragingResourceLevel=c(pphForagingResourceForB_StrNut, pphForagingResourceForDSimple_StrNut, pphForagingResourceForKcarryCapSimple_StrNut, pphForagingResourceForAlphaSimple_StrNut, pphForagingResourceForMuPositiveSimple_StrNut, pphForagingResourceForLambdaSimple_StrNut, pphForagingResourceForMuNegativeSimple_StrNut),
                       nonForagingParameter=c(rep("Host Birth Rate", times=length(pphResourceBreakPointForB_StrNut)), rep("Host Natural Mortality", times=length(pphResourceBreakPointForDSimple_StrNut)), rep("Host Carrying Capacity", times=length(pphResourceBreakPointForKcarryCapSimple_StrNut)), rep("Parasite Virulence", times=length(pphResourceBreakPointForAlphaSimple_StrNut)), rep("Parasite Mortality+", times=length(pphResourceBreakPointForMuPositiveSimple_StrNut)), rep("Parasite Egg Production", times=length(pphResourceBreakPointForLambdaSimple_StrNut)), rep("Parasite Mortality-", times=length(pphResourceBreakPointForMuNegativeSimple_StrNut))),
                       NNP=c(rep("Nutrition", times=length(pphResourceBreakPointForB_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForDSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForKcarryCapSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForAlphaSimple_StrNut)), rep("Stress", times=length(pphResourceBreakPointForMuPositiveSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForLambdaSimple_StrNut)), rep("Nutrition", times=length(pphResourceBreakPointForMuNegativeSimple_StrNut))),
                       pointShape=c(rep(bShape, times=length(pphResourceBreakPointForB_StrNut)), rep(dShape, times=length(pphResourceBreakPointForDSimple_StrNut)), rep(KcarryCapShape, times=length(pphResourceBreakPointForKcarryCapSimple_StrNut)), rep(AlphaShape, times=length(pphResourceBreakPointForAlphaSimple_StrNut)), rep(MuPositiveShape, times=length(pphResourceBreakPointForMuPositiveSimple_StrNut)), rep(LambdaShape, times=length(pphResourceBreakPointForLambdaSimple_StrNut)), rep(MuNegativeShape, times=length(pphResourceBreakPointForMuNegativeSimple_StrNut)))
                       )

#Creating dataframes for Regression Predictions of hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #predictedLMPoints = predicted amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #pairedForagingResourcePoints = predicted amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)

#Alpha must be removed for hosts, it fails to overcome effects of Nutrition or Stress

hostRegressionData_StrNut <- data.frame(predictedLMPoints=c(hostBirthLMPoints_StrNut, hostDeathLMPoints_StrNut, hostCarryingCapacityLMPoints_StrNut, hostMuPositiveLMPoints_StrNut, hostLambdaLMPoints_StrNut, hostMuNegativeLMPoints_StrNut),
                                 pairedForagingResourcePoints=c(hostBirthLMPointsPair_StrNut, hostDeathLMPointsPair_StrNut, hostCarryingCapacityLMPointsPair_StrNut, hostMuPositiveLMPointsPair_StrNut, hostLambdaLMPointsPair_StrNut, hostMuNegativeLMPointsPair_StrNut),
                                 NNP=c(rep("Stress", times=length(hostBirthLMPoints_StrNut)), rep("Nutrition", times=length(hostDeathLMPoints_StrNut)), rep("Stress", times=length(hostCarryingCapacityLMPoints_StrNut)), rep("Stress", times=length(hostMuPositiveLMPoints_StrNut)), rep("Nutrition", times=length(hostLambdaLMPoints_StrNut)), rep("Nutrition", times=length(hostMuNegativeLMPoints_StrNut))),
                                 nonForagingParameter=c(rep("Host Birth Rate", times=length(hostBirthLMPoints_StrNut)), rep("Host Natural Mortality", times=length(hostDeathLMPoints_StrNut)), rep("Host Carrying Capacity", times=length(hostCarryingCapacityLMPoints_StrNut)), rep("Parasite Mortality+", times=length(hostMuPositiveLMPoints_StrNut)), rep("Parasite Egg Production", times=length(hostLambdaLMPoints_StrNut)), rep("Parasite Mortality-", times=length(hostMuNegativeLMPoints_StrNut))),
                                 pointShape=c(rep(bShape, times=length(hostBirthLMPoints_StrNut)), rep(dShape, times=length(hostDeathLMPoints_StrNut)), rep(KcarryCapShape, times=length(hostCarryingCapacityLMPoints_StrNut)), rep(MuPositiveShape, times=length(hostMuPositiveLMPoints_StrNut)), rep(LambdaShape, times=length(hostLambdaLMPoints_StrNut)), rep(MuNegativeShape, times=length(hostMuNegativeLMPoints_StrNut)))
                                 )

#Lambda is removed from both regressions, because it cannot overcome the effects of Nutrition or Stress (shared directionality)
#Hmax is removed from PpH regressions, because it cannot overcome the effects of Nutrition or Stress (shared directionality)

pphRegressionData_StrNut <- data.frame(predictedLMPoints=c(pphBirthLMPoints_StrNut, pphDeathLMPoints_StrNut, pphCarryingCapacityLMPoints_StrNut, pphParasiteVirulenceLMPoints_StrNut, pphMuPositiveLMPoints_StrNut, pphLambdaLMPoints_StrNut, pphMuNegativeLMPoints_StrNut),
                                 pairedForagingResourcePoints=c(pphBirthLMPointsPair_StrNut, pphDeathLMPointsPair_StrNut, pphCarryingCapacityLMPointsPair_StrNut, pphParasiteVirulenceLMPointsPair_StrNut, pphMuPositiveLMPointsPair_StrNut, pphLambdaLMPointsPair_StrNut, pphMuNegativeLMPointsPair_StrNut),
                                NNP=c(rep("Nutrition", times=length(pphBirthLMPoints_StrNut)), rep("Nutrition", times=length(pphDeathLMPoints_StrNut)), rep("Nutrition", times=length(pphCarryingCapacityLMPoints_StrNut)), rep("Nutrition", times=length(pphParasiteVirulenceLMPoints_StrNut)), rep("Stress", times=length(pphMuPositiveLMPoints_StrNut)), rep("Nutrition", times=length(pphLambdaLMPoints_StrNut)), rep("Nutrition", times=length(pphMuNegativeLMPoints_StrNut))),
                                nonForagingParameter=c(rep("Host Birth Rate", times=length(pphBirthLMPoints_StrNut)), rep("Host Natural Mortality", times=length(pphDeathLMPoints_StrNut)), rep("Host Carrying Capacity", times=length(pphCarryingCapacityLMPoints_StrNut)), rep("Parasite Virulence", times=length(pphParasiteVirulenceLMPoints_StrNut)), rep("Parasite Mortality+", times=length(pphMuPositiveLMPoints_StrNut)), rep("Parasite Egg Production", times=length(pphLambdaLMPoints_StrNut)), rep("Parasite Mortality-", times=length(pphMuNegativeLMPoints_StrNut))),
                                pointShape=c(rep(bShape, times=length(pphBirthLMPoints_StrNut)), rep(dShape, times=length(pphDeathLMPoints_StrNut)), rep(KcarryCapShape, times=length(pphCarryingCapacityLMPoints_StrNut)), rep(AlphaShape, times=length(pphParasiteVirulenceLMPoints_StrNut)), rep(MuPositiveShape, times=length(pphMuPositiveLMPoints_StrNut)), rep(LambdaShape, times=length(pphLambdaLMPoints_StrNut)), rep(MuNegativeShape, times=length(pphMuNegativeLMPoints_StrNut)))
                                 )

#Creating dataframes for Regression End Points of hosts and pph intensity
#Dataframe variables are resourceBreakPoints, foragingResourceLevel, nonForagingParameter, NNP, and pointShape
  #predictedNonForagingEndPoints = predicted amount of resource subsidy required for the nonforaging parameter to flip the effect of foraging parameters beta & k
  #pairedForagingEndPoints = predicted amount of resource subsidy that the foraging parameters experience when the flip occurs
  #nonForagingParameter = name of foraging parameter (used for graphing shapes and legend)
  #NNP = names of direction of resource effect on foraging parameters (used for graphing lines)
  #pointShape = assigned value from above (used for graphing shapes and legend)



#WORKING HERE. Need to figure out which values are excluded in the linear regression data. Last time it was host virulence. This time, it's several things.


#Hosts remove alpha (fails to overcome)
hostRegressionEndPoints_StrNut <- data.frame(predictedNonForagingEndPoints=c(hostBirthLMEndPoint_StrNut, hostCarryingCapacityLMEndPoint_StrNut, hostMuPositiveLMEndPoint_StrNut, hostLambdaLMEndPoint_StrNut, hostMuNegativeLMEndPoint_StrNut), #NONFORAGING RESOURCES (y-axis)
                                      pairedForagingEndPoints=c(hostBirthLMEndPointPair_StrNut, hostCarryingCapacityLMEndPointPair_StrNut, hostMuPositiveLMEndPointPair_StrNut, hostLambdaLMEndPointPair_StrNut, hostMuNegativeLMEndPointPair_StrNut), #FORAGING RESOURCES (x-axis)
                                      nonForagingParameter=c("Host Birth Rate", "Host Carrying Capacity", "Parasite Mortality+", "Parasite Egg Production", "Parasite Mortality-"),
                                      NNP=c("Stress", "Stress", "Stress", "Nutrition", "Nutrition"),
                                      pointShape=c(bShape, KcarryCapShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                                      )

pphRegressionEndPoints_StrNut <- data.frame(predictedNonForagingEndPoints=c(pphBirthLMEndPoint_StrNut, pphDeathLMEndPoint_StrNut, pphCarryingCapacityLMEndPoint_StrNut, pphParasiteVirulenceLMEndPoint_StrNut, pphMuPositiveLMEndPoint_StrNut, pphLambdaLMEndPoint_StrNut, pphMuNegativeLMEndPoint_StrNut), #NONFORAGING RESOURCES (y-axis)
                                      pairedForagingEndPoints=c(pphBirthLMEndPointPair_StrNut, pphDeathLMEndPointPair_StrNut, pphCarryingCapacityLMEndPointPair_StrNut, pphParasiteVirulenceLMEndPointPair_StrNut, pphMuPositiveLMEndPointPair_StrNut, pphLambdaLMEndPointPair_StrNut, pphMuNegativeLMEndPointPair_StrNut), #FORAGING RESOURCES (x-axis)
                                      nonForagingParameter=c("Host Birth Rate", "Host Natural Mortality", "Host Carrying Capacity", "Parasite Virulence", "Parasite Mortality+", "Parasite Egg Production", "Parasite Mortality-"),
                                     NNP=c("Nutrition", "Nutrition", "Nutrition", "Nutrition", "Stress", "Nutrition", "Nutrition"),
                                     pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                                     ) 

#Subsetting our data to graph 2x2 panels

#Data points produced by Mathematical Model (will be plotted as small symbols)
hostDataNutrition_StrNut <- subset.data.frame(hostDataAll_StrNut, NNP=="Nutrition", select=TRUE)
hostDataNutritionD_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostDataNutritionAlpha_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
hostDataNutritionLambda_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
hostDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

hostDataStress_StrNut <- subset.data.frame(hostDataAll_StrNut, NNP=="Stress", select=TRUE)
hostDataStressB_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostDataStressCarryingCapacity_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(hostDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphDataNutrition_StrNut <- subset.data.frame(pphDataAll_StrNut, NNP=="Nutrition", select=TRUE)
pphDataNutritionB_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphDataNutritionD_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphDataNutritionCarryingCapacity_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphDataNutritionParasiteVirulence_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphDataNutritionLambda_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)


pphDataStress_StrNut <- subset.data.frame(pphDataAll_StrNut, NNP=="Stress", select=TRUE)
pphDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(pphDataAll_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

#Data points produced by Linear Regression interpreting relationship between Model output (will be plotted as lines)
hostRegressionDataNutrition_StrNut <- subset.data.frame(hostRegressionData_StrNut, NNP=="Nutrition", select=TRUE)
hostRegressionDataNutritionD_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostRegressionDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)
hostRegressionDataNutritionLambda_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)

hostRegressionDataStress_StrNut <- subset.data.frame(hostRegressionData_StrNut, NNP=="Stress", select=TRUE)
hostRegressionDataStressB_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostRegressionDataStressCarryingCapacity_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostRegressionDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(hostRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphRegressionDataNutrition_StrNut <- subset.data.frame(pphRegressionData_StrNut, NNP=="Nutrition", select=TRUE)
pphRegressionDataNutritionB_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphRegressionDataNutritionD_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphRegressionDataNutritionCarryingCapacity_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphRegressionDataNutritionParasiteVirulence_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphRegressionDataNutritionLambda_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphRegressionDataNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphRegressionDataStress_StrNut <- subset.data.frame(pphRegressionData_StrNut, NNP=="Stress", select=TRUE)
pphRegressionDataStressParasiteMortalityPositive_StrNut <- subset.data.frame(pphRegressionData_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

hostRegressionEndPointsNutrition_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, NNP=="Nutrition", select=TRUE)
hostRegressionEndPointsNutritionD_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
hostRegressionEndPointsNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)
hostRegressionEndPointsNutritionLambda_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)

hostRegressionEndPointsStress_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, NNP=="Stress", select=TRUE)
hostRegressionEndPointsStressB_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
hostRegressionEndPointsStressCarryingCapacity_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
hostRegressionEndPointsStressParasiteMortalityPositive_StrNut <- subset.data.frame(hostRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

pphRegressionEndPointsNutrition_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, NNP=="Nutrition", select=TRUE)
pphRegressionEndPointsNutritionB_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Birth Rate"), select=TRUE)
pphRegressionEndPointsNutritionD_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Natural Mortality"), select=TRUE)
pphRegressionEndPointsNutritionCarryingCapacity_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Host Carrying Capacity"), select=TRUE)
pphRegressionEndPointsNutritionParasiteVirulence_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Virulence"), select=TRUE)
pphRegressionEndPointsNutritionLambda_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Egg Production"), select=TRUE)
pphRegressionEndPointsNutritionParasiteMortalityNegative_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Nutrition" & nonForagingParameter=="Parasite Mortality-"), select=TRUE)

pphRegressionEndPointsStress_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, NNP=="Stress", select=TRUE)
pphRegressionEndPointsStressParasiteMortalityPositive_StrNut <- subset.data.frame(pphRegressionEndPoints_StrNut, (NNP=="Stress" & nonForagingParameter=="Parasite Mortality+"), select=TRUE)

#Creating dataset for legend
legendDataframe_StrNut <- data.frame(xValue=c(1, 2, 3, 4, 5, 6, 7),
                              yValue=c(1, 2, 3, 4, 5, 6, 7),
                              nonForagingParameter=c("Host Birth Rate, b", "Host Natural Mortality, d", "Host Carrying Capacity, Hmax", "Parasite Virulence, \U1D6FC", "Parasite Mortality+, \U1D6CD+", "Parasite Egg Production, \U1D6CC", "Parasite Mortality-, \U1D6CD-"),
                              NNP=c("Stress", "Nutrition", "Stress", "Nutrition", "Stress", "Nutrition", "Stress"), #Order doesn't matter for these since they're just used for color
                              pointShape=c(bShape, dShape, KcarryCapShape, AlphaShape, MuPositiveShape, LambdaShape, MuNegativeShape)
                              )

```

```{r - Graphing FULL MODEL - Figure 4 - Model Outputs with linear and cubic regressions}
hostBreakpointsNegative <- ggplot() +
  #Regression lines
  stat_smooth(data=hostDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
geom_line(data=hostRegressionDataNegativeEggProduction, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightcoral", size=1.2) + 
  stat_smooth(data=hostDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  #Model outputs as points
  geom_point(data=hostDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNegativeD$pointShape, size=1.2) + 
  geom_point(data=hostDataNegativeEggProduction, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNegativeEggProduction$pointShape, size=1.2) + 
  geom_point(data=hostDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNegativeParasiteMortalityNegative$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsNegativeD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNegativeD$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsNegativeEggProduction, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNegativeEggProduction$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsNegativeParasiteMortalityNegative, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNegativeParasiteMortalityNegative$pointShape, size=3) + 
  annotate("text", x=1.10, y=4.85, label="d", size=5) +
  annotate("text", x=hostRegressionEndPointsNegativeEggProduction$pairedForagingEndPoints, y=hostRegressionEndPointsNegativeEggProduction$predictedNonForagingEndPoints+0.225, label=expression(lambda), size=5) + #lambda [NOTE: Need to -0.1 to y-axis to avoid overlapping with points]
  annotate("text", x=1.5, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "", 
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  ggtitle(expression(bold("Host Population (H)"))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=0.999, y=5, label="(a)", size=5)
  #annotate("text", x=3.4, y=0.95, label="A: Decreased Host Overlap", size=5)

hostBreakpointsPositive <- ggplot() +
  #Regression lines
  geom_line(data=hostRegressionDataPositiveB, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightblue", size=1.2) + 
  stat_smooth(data=hostDataPositiveCarryingCapacity, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightblue", se=FALSE, fullrange=TRUE) + 
  geom_line(data=hostRegressionDataPositiveParasiteMortalityPositive, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightblue", size=1.2) + 
  #Model outputs as points
  geom_point(data=hostDataPositiveB, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataPositiveB$pointShape, size=1.2) + 
  geom_point(data=hostDataPositiveCarryingCapacity, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataPositiveCarryingCapacity$pointShape, size=1.2) + 
  geom_point(data=hostDataPositiveParasiteMortalityPositive, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataPositiveParasiteMortalityPositive$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsPositiveB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsPositiveB$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsPositiveCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsPositiveCarryingCapacity$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsPositiveParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsPositiveParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=hostRegressionEndPointsPositiveB$pairedForagingEndPoints+0.05, y=hostRegressionEndPointsPositiveB$predictedNonForagingEndPoints, label="b", size=5) + #b [NOTE: Need to +0.1 to x-axis and -0.1 to y-axis to avoid overlapping with points]
  annotate("text", x=1.3, y=4.99, label="Hmax", size=5) + #Hmax
  annotate("text", x=hostRegressionEndPointsPositiveParasiteMortalityPositive$pairedForagingEndPoints+0.075,            
y=hostRegressionEndPointsPositiveParasiteMortalityPositive$predictedNonForagingEndPoints, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
    labs(x = "",
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  annotate("text", x=0.999, y=5, label="(e)", size=5)
  #annotate("text", x=3.45, y=0.95, label="B: Increased Host Overlap", size=5)
  
pphBreakpointsNegative <- ggplot() +
  #Regression lines
  stat_smooth(data=pphDataNegativeB, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=pphDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=FALSE) + 
  geom_line(data=pphRegressionDataNegativeCarryingCapacity, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightcoral", size=1.2) +
  stat_smooth(data=pphDataNegativeParasiteVirulence, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  geom_line(data=pphRegressionDataNegativeEggProduction, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightcoral", size=1.2) + 
  stat_smooth(data=pphDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="lightcoral", se=FALSE, fullrange=TRUE) + 
  #Model outputs as points
  geom_point(data=pphDataNegativeB, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeB$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeD, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeD$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeCarryingCapacity, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeCarryingCapacity$pointShape, size=1.2) +  
  geom_point(data=pphDataNegativeParasiteVirulence, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeParasiteVirulence$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeEggProduction, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeEggProduction$pointShape, size=1.2) + 
  geom_point(data=pphDataNegativeParasiteMortalityNegative, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNegativeParasiteMortalityNegative$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=pphRegressionEndPointsNegativeB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeB$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNegativeD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeD$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNegativeCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeCarryingCapacity$pointShape, size=3) +   
  #geom_point(data=pphRegressionEndPointsNegativeParasiteVirulence, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeParasiteVirulence$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNegativeEggProduction, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeEggProduction$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNegativeParasiteMortalityNegative, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNegativeParasiteMortalityNegative$pointShape, size=3) + 
  annotate("text", x=1.225, y=4.6, label="b", size=5) + #b
  annotate("text", x=1.33, y=4.625, label="d", size=5) + #d
  annotate("text", x=pphRegressionEndPointsNegativeCarryingCapacity$pairedForagingEndPoints-0.1, y=pphRegressionEndPointsNegativeCarryingCapacity$predictedNonForagingEndPoints+0.225, label="Hmax", size=5) + #Hmax [NOTE: Need the -0.1 to x-axis to keep on graph and +0.7 to y-axis since it overlaps with lambda]
  annotate("text", x=1.425, y=4.625, label=expression(alpha), size=5) + #alpha
  annotate("text", x=pphRegressionEndPointsNegativeEggProduction$pairedForagingEndPoints, y=pphRegressionEndPointsNegativeEggProduction$predictedNonForagingEndPoints-0.2, label=expression(lambda), size=5) + #lambda [NOTE: Need to +0.1 to y-axis to avoid overlapping with points]
    annotate("text", x=1.5, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "", 
       y = "") +
  ggtitle(expression(bold("Parasite Abundance (P/H)"))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=0.999, y=5, label="(b)", size=5)
  #annotate("text", x=3.4, y=0.95, label="C: Decreased Host Overlap", size=5)
  
pphBreakpointsPositive <- ggplot() +
  #Regression lines
  geom_line(data=pphRegressionDataPositiveParasiteMortalityPositive, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="lightblue", size=1.2) + 
  #Model outputs as points
  geom_point(data=pphDataPositiveParasiteMortalityPositive, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataPositiveParasiteMortalityPositive$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
    #geom_point(data=pphRegressionEndPointsPositiveParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsPositiveParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=pphRegressionEndPointsPositiveParasiteMortalityPositive$pairedForagingEndPoints+0.1, y=pphRegressionEndPointsPositiveParasiteMortalityPositive$predictedNonForagingEndPoints, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +                      #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                                      #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "",
       y = "") +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points  
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  annotate("text", x=0.999, y=5, label="(f)", size=5)
  #annotate("text", x=3.45, y=0.95, label="D: Increased Host Overlap", size=5)

hostBreakpointsNutrition <- ggplot() +
  #Regression lines
  stat_smooth(data=hostDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  geom_line(data=hostRegressionDataNutritionLambda_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="darkgreen", size=1.2) + 
  stat_smooth(data=hostDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  #Model outputs as points
  geom_point(data=hostDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionD_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataNutritionLambda_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionLambda_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionParasiteMortalityNegative_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataNutritionAlpha_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataNutritionAlpha_StrNut$pointShape, size=1.2) +
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsNutritionD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNutritionD$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsNutritionEggProduction, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNutritionEggProduction$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsNutritionParasiteMortalityNutrition, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsNutritionParasiteMortalityNutrition$pointShape, size=3) + 
  annotate("text", x=hostRegressionEndPointsNutritionLambda_StrNut$pairedForagingEndPoints, y=hostRegressionEndPointsNutritionLambda_StrNut$predictedNonForagingEndPoints-0.25, label=expression(lambda), size=5) + #lambda [NOTE: Need to -0.2 to y-axis to avoid overlapping with points]
  annotate("text", x=1.18, y=4.99, label="d", size=5) + #lambda [NOTE: Need to -0.2 to y-axis to avoid overlapping with points]
  annotate("text", x=1.8, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +             #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                             #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = "", 
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=0.999, y=5, label="(c)", size=5)
  #annotate("text", x=3.4, y=0.95, label="A: Decreased Host Overlap", size=5)

hostBreakpointsStress <- ggplot() +
  #Regression lines
  stat_smooth(data=hostDataStressB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="purple", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=hostDataStressCarryingCapacity_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="purple", se=FALSE, fullrange=TRUE) + 
  geom_line(data=hostRegressionDataStressParasiteMortalityPositive_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="purple", size=1.2) + 
  #Model outputs as points
  geom_point(data=hostDataStressB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataStressB_StrNut$pointShape, size=1.2) + 
  geom_point(data=hostDataStressCarryingCapacity_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataStressCarryingCapacity_StrNut$pointShape, size=1.2) +
  geom_point(data=hostDataStressParasiteMortalityPositive_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=hostDataStressParasiteMortalityPositive_StrNut$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=hostRegressionEndPointsStressB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsStressB$pointShape, size=3) +
  #geom_point(data=hostRegressionEndPointsStressCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsStressCarryingCapacity$pointShape, size=3) + 
  #geom_point(data=hostRegressionEndPointsStressParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=hostRegressionEndPointsStressParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=hostRegressionEndPointsStressB_StrNut$pairedForagingEndPoints, y=hostRegressionEndPointsStressB_StrNut$predictedNonForagingEndPoints+0.05, label="b", size=5) + #b
  annotate("text", x=1.925, y=4.99, label="Hmax", size=5) + #Hmax
  annotate("text", x=hostRegressionEndPointsStressParasiteMortalityPositive_StrNut$pairedForagingEndPoints,            
y=hostRegressionEndPointsStressParasiteMortalityPositive_StrNut$predictedNonForagingEndPoints+0.1, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = expression(atop(bold("Resource Effect on"), bold(paste("Foraging Parameters  ", "(", rho[f], ")")))),
       y = expression(atop(bold("Resource Effect on"), bold(paste("Non-foraging Parameters  ", "(", rho[nf], ")"))))) +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  annotate("text", x=0.999, y=5, label="(g)", size=5)
  #annotate("text", x=3.45, y=0.95, label="B: Increased Host Overlap", size=5)



pphBreakpointsNutrition <- ggplot() +
  #Regression lines
  stat_smooth(data=pphDataNutritionB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=FALSE) + 
  stat_smooth(data=pphDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=pphDataNutritionParasiteVirulence_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  stat_smooth(data=pphDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), method="lm", formula = y ~ poly(x, 3), color="darkgreen", se=FALSE, fullrange=TRUE) + 
  geom_line(data=pphRegressionDataNutritionCarryingCapacity_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="darkgreen", size=1.2) +
  geom_line(data=pphRegressionDataNutritionLambda_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="darkgreen", size=1.2) + 
  #Model outputs as points
  geom_point(data=pphDataNutritionB_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionB_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionD_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionD_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionCarryingCapacity_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionCarryingCapacity_StrNut$pointShape, size=1.2) +  
  geom_point(data=pphDataNutritionParasiteVirulence_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionParasiteVirulence_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionLambda_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionLambda_StrNut$pointShape, size=1.2) + 
  geom_point(data=pphDataNutritionParasiteMortalityNegative_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataNutritionParasiteMortalityNegative_StrNut$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
  #geom_point(data=pphRegressionEndPointsNutritionB, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionB$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNutritionD, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionD$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNutritionCarryingCapacity, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionCarryingCapacity$pointShape, size=3) +   
  #geom_point(data=pphRegressionEndPointsNutritionParasiteVirulence, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionParasiteVirulence$pointShape, size=3) +
  #geom_point(data=pphRegressionEndPointsNutritionLambda, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionLambda$pointShape, size=3) + 
  #geom_point(data=pphRegressionEndPointsNutritionParasiteMortalityNegative, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsNutritionParasiteMortalityNegative$pointShape, size=3) + 
  annotate("text", x=1.2, y=4.45, label="b", size=5) + #b
  annotate("text", x=1.375, y=4.65, label="d", size=5) + #d
  annotate("text", x=pphRegressionEndPointsNutritionCarryingCapacity_StrNut$pairedForagingEndPoints-0.1, y=pphRegressionEndPointsNutritionCarryingCapacity_StrNut$predictedNonForagingEndPoints-0.45, label="Hmax", size=5) + #Hmax [NOTE: Need the -0.1 to x-axis to keep on graph and +0.7 to y-axis since it overlaps with lambda]
  annotate("text", x=1.5, y=4.7, label=expression(alpha), size=5) + #alpha
  annotate("text", x=pphRegressionEndPointsNutritionLambda_StrNut$pairedForagingEndPoints+0.05, y=pphRegressionEndPointsNutritionLambda_StrNut$predictedNonForagingEndPoints-0.225, label=expression(lambda), size=5) + #lambda [NOTE: Need to +0.1 to y-axis to avoid overlapping with points]
    annotate("text", x=1.775, y=4.99, label=expression(paste(mu), "   -"), size=5) + #Mu-
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +            #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                            #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x="",
       y="") +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  theme(plot.title=element_text(hjust=0.5)) + #centers title
  theme(plot.title=element_text(size=20)) + #increases title size
  annotate("text", x=0.999, y=5, label="(d)", size=5)
  #annotate("text", x=3.4, y=0.95, label="C: Decreased Host Overlap", size=5)
  
pphBreakpointsStress <- ggplot() +
  #Regression lines
  geom_line(data=pphRegressionDataStressParasiteMortalityPositive_StrNut, aes(x=pairedForagingResourcePoints, y=predictedLMPoints), color="purple", size=1.2) + 
  #Model outputs as points
  geom_point(data=pphDataStressParasiteMortalityPositive_StrNut, aes(x=foragingResourceLevel, y=resourceBreakPoints), shape=pphDataStressParasiteMortalityPositive_StrNut$pointShape, size=1.2) + 
  #Regression line "end points" to match model output
    #geom_point(data=pphRegressionEndPointsStressParasiteMortalityPositive, aes(x=pairedForagingEndPoints, y=predictedNonForagingEndPoints), shape=pphRegressionEndPointsStressParasiteMortalityPositive$pointShape, size=3) + 
  annotate("text", x=pphRegressionEndPointsStressParasiteMortalityPositive_StrNut$pairedForagingEndPoints, y=pphRegressionEndPointsStressParasiteMortalityPositive_StrNut$predictedNonForagingEndPoints+0.1, label=expression(paste(mu), "   +"), size=5) + #Mu+ [NOTE: Need to +0.3 to y-axis to avoid overlapping with points]
  #Resource effect 1:1 line for interpretation
  geom_abline(slope=1, intercept=0, color="black", linetype="dashed", size=1.2) +
  #Legend Stuff
  xlim(min(foragingResource)-0.05, max(foragingResource)+0.05) +                      #xlim(min(foragingResource)-0.2, max(foragingResource)+0.2)
  ylim(min(resource)-0.05, max(resource)+0.05) +                                      #ylim(min(resource)-0.2, max(resource)+0.2)
  labs(x = expression(atop(bold("Resource Effect on"), bold(paste("Foraging Parameters  ", "(", rho[f], ")")))),
       y = "") +
  #guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  #guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
  #guides(shape = guide_legend(title="Non-Foraging Parameters")) + #Changes title of legend for shape of points  
  theme_classic() +
  #theme(legend.position = "none")
  theme(text=element_text(family='serif')) + #sets Font Text to Times New Roman
  theme(axis.text.x=element_text(size=12)) +
  theme(axis.title.x=element_text(size=16)) +
  theme(axis.text.x=element_text(color="black")) +
  theme(axis.text.y=element_text(size=12)) +
  theme(axis.title.y=element_text(size=16)) +
  theme(axis.text.y=element_text(color="black")) +
  annotate("text", x=0.999, y=5, label="(h)", size=5)
  #annotate("text", x=3.45, y=0.95, label="D: Increased Host Overlap", size=5)

#Old Legend Graph
#fakeGraphForLegend <- ggplot() +
#  geom_line(data=legendDataframe, aes(x=xValue, y=yValue, group=nonForagingParameter, color=NNP), size=1.2) +        
#  geom_point(data=legendDataframe, aes(x=xValue, y=yValue, shape=nonForagingParameter), size=3) +  #, position=position_dodge(width=0.05)
#  scale_shape_manual(values=c(bShape, KcarryCapShape, dShape, LambdaShape, MuNegativeShape, MuPositiveShape, AlphaShape)) + #THIS IS BAD PRACTICE! Breaks graph, but fixes #legend which is all we care about in this fake graph
#  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
#  guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
#  guides(color = guide_legend(override.aes = list(size = 2))) +
#  guides(color = guide_legend(title="Effect of Resources on Foraging Parameters")) + #Changes title of legend for line color
#  guides(shape = guide_legend(title="Non-Foraging Parameters")) #Changes title of legend for shape of points  


fakeGraphForLegendLines <- ggplot() +
  geom_line(data=legendDataframeFull, aes(x=xValue, y=yValue, group=nonForagingParameter, color=NNP), size=1.2) +    
  scale_color_manual(values=c("lightcoral", "lightblue", "darkgreen", "purple"),
                     labels=c("Decreased Parasite Encounter & Increased Heterogeneity (\U03B2-, k-)", "Increased Parasite Encounter & Decreased Heterogeneity (\U03B2+, k+)",
                     "Decreased Parasite Encounter & Heterogeneity (\U03B2-, k+)", "Increased Parasite Encounter & Heterogeneity (\U03B2+, k-)")) +
  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
  guides(color = guide_legend(override.aes=(list(type=0)))) + #removes the shape from NNP in legend
  guides(color = guide_legend(override.aes = list(size = 2))) +
  guides(color = guide_legend(title="Effect of Resources on Infection Parameters")) #Changes title of legend for line color

fakeGraphForLegendPoints <- ggplot() +
  geom_point(data=legendDataframeFull, aes(x=xValue, y=yValue, shape=nonForagingParameter), size=3) +  #, position=position_dodge(width=0.05)
  scale_shape_manual(values=c(bShape, KcarryCapShape, dShape, LambdaShape, MuNegativeShape, MuPositiveShape, AlphaShape),
                     labels=c("Host Birth Rate, b", "Host Carrying Capacity, Hmax", "Host Natural Mortality, d", "Parasite Egg Production, \U03BB", "Adult Parasite Mortality, \U03BC-", "Adult Parasite Mortality, \U03BC+", "Parasite Virulence, \U03B1")) + #THIS IS BAD PRACTICE! Breaks graph, but fixes legend which is all we care about in this fake graph
  labs(x = expression(bold("Fake Graph X Axis")), y = expression(bold("Fake Graph Y Axis"))) +
  guides(shape = guide_legend(title="Non-Foraging Parameters")) #Changes title of legend for shape of points  

legendGraphForLines <- cowplot::get_legend(fakeGraphForLegendLines)
legendGraphForPoints <- cowplot::get_legend(fakeGraphForLegendPoints)

#Visualization choices Export as 800x1400
fullModel <- plot_grid(hostBreakpointsNegative, pphBreakpointsNegative, hostBreakpointsNutrition, pphBreakpointsNutrition, hostBreakpointsPositive, pphBreakpointsPositive, hostBreakpointsStress, pphBreakpointsStress, ncol=2, nrow=4)

fullModelWithLegend <- plot_grid(hostBreakpointsNegative, pphBreakpointsNegative, hostBreakpointsNutrition, pphBreakpointsNutrition, hostBreakpointsPositive, pphBreakpointsPositive, hostBreakpointsStress, pphBreakpointsStress, legendGraphForPoints, legendGraphForLines, ncol=2, nrow=5)

fullModel
```

```{r - Saving Graph + Legends}
#ggsave(filename="fullModel.png", plot=fullModel, path="E:/00000 RESEARCH/Graphs/Macroparasite Graphs/Figure 4 (Resource Breakpoints of Host and PpH)", width=5, height=8, units="in", dpi=600)

ggsave(filename="legendGraphForLines.png", plot=legendGraphForLines, path="E:/00000 RESEARCH/Graphs/Macroparasite Graphs/Figure 4 (Resource Breakpoints of Host and PpH)", width=4.25, height=1.75, units="in", dpi=600)

#ggsave(filename="legendGraphForPoints.png", plot=legendGraphForPoints, path="E:/00000 RESEARCH/Graphs/Macroparasite Graphs/Figure 4 (Resource Breakpoints of Host and PpH)", width=2, height=2, units="in", dpi=600)
```
